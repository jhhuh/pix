{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"pix","text":"<p>Explore Nix internals through readable Python.</p> <p>Nix's core algorithms \u2014 store path hashing, NAR serialization, derivation parsing, the daemon wire protocol \u2014 are buried in C++ across dozens of source files. pix re-derives each one in straightforward Python so you can read, modify, and single-step through the logic.</p> <p>Every module produces output identical to the real <code>nix</code> CLI, verified by the test suite. The code is the documentation; these pages are the commentary.</p>"},{"location":"#whats-inside-nix","title":"What's inside Nix","text":"<p>When you run <code>nix build</code>, a lot happens under the hood. pix breaks it into pieces you can understand one at a time:</p> Concept What Nix does pix module Docs Base32 Custom encoding for store path hashes \u2014 not RFC 4648 <code>base32.py</code> How it differs Hash compression XOR-folds SHA-256 (32 B) down to 160 bits (20 B) <code>hash.py</code> In store path computation NAR Deterministic archive format \u2014 no timestamps, no uid, just content <code>nar.py</code> Wire format spec Store paths <code>/nix/store/&lt;hash&gt;-&lt;name&gt;</code> computed from a fingerprint string <code>store_path.py</code> Full algorithm Derivations <code>.drv</code> files in ATerm format; <code>hashDerivationModulo</code> breaks circular deps <code>derivation.py</code> Format + hashing Daemon protocol Unix socket with uint64-LE framing, stderr log stream, operation opcodes <code>daemon.py</code> Protocol spec"},{"location":"#pixpkgs-building-on-pix","title":"pixpkgs \u2014 building on pix","text":"<p>Once you understand the internals, pixpkgs shows how to build a nixpkgs-like package set on top of them, mapping Nix patterns to Python idioms:</p> Nix pattern Python idiom pixpkgs module <code>mkDerivation</code> <code>drv()</code> function \u2192 <code>Package</code> dataclass <code>drv.py</code> <code>callPackage</code> <code>inspect.signature</code> + <code>getattr</code> <code>package_set.py</code> String interpolation (<code>${pkg}</code>) <code>__str__</code> returning output path <code>drv.py</code> <code>pkg.override</code> Re-call <code>drv()</code> with merged kwargs <code>drv.py</code> <code>nix-store --realize</code> <code>realize()</code> \u2192 daemon <code>add_text_to_store</code> + <code>build_paths</code> <code>realize.py</code> <p>See the pixpkgs API reference for details.</p>"},{"location":"#reading-order","title":"Reading order","text":"<p>The modules build on each other. Start from the bottom:</p> <pre><code>pix (Nix internals):\n  1. base32.py        \u2190 simplest: just an encoding\n  2. hash.py          \u2190 one function: XOR-fold\n  3. nar.py           \u2190 serialization format, uses hash\n  4. store_path.py    \u2190 the core algorithm, uses base32 + hash\n  5. derivation.py    \u2190 parsing + the hashDerivationModulo trick\n  6. daemon.py        \u2190 standalone: wire protocol over Unix socket\n\npixpkgs (package set layer, uses pix):\n  7. drv.py           \u2190 drv() + Package: the mkDerivation equivalent\n  8. package_set.py   \u2190 PackageSet.call(): the callPackage equivalent\n  9. realize.py       \u2190 write .drv to store + build via daemon\n</code></pre> <p>Each pix file is self-contained and under 150 lines. You can read the entire codebase in one sitting.</p>"},{"location":"#try-it-yourself","title":"Try it yourself","text":"<pre><code>nix develop\n\n# See that pix computes the exact same hash as nix\npython -m pix hash-path ./pix/base32.py --base32\nnix hash path ./pix/base32.py --type sha256 --base32\n# same output\n\n# Compute a store path, then verify via the daemon\npython -m pix store-path ./pix --name pix-source\npython -m pix add-text hello.txt \"hello world\"\npython -m pix drv-show /nix/store/...-hello.drv\n</code></pre>"},{"location":"#verify","title":"Verify","text":"<pre><code>pytest tests/ pixpkgs/tests/ -v   # 41 tests, all comparing against real nix\n</code></pre>"},{"location":"#how-to-use-these-docs","title":"How to use these docs","text":"<ul> <li>Internals \u2014 Start here. Explains how Nix works with diagrams, hex dumps, and protocol traces.</li> <li>API Reference \u2014 Function signatures and usage examples for each module.</li> <li>CLI Reference \u2014 The <code>python -m pix</code> commands for quick experimentation.</li> </ul>"},{"location":"cli/","title":"CLI Reference","text":"<p>Run pix as a Python module:</p> <pre><code>python -m pix &lt;command&gt; [options]\n</code></pre>"},{"location":"cli/#commands","title":"Commands","text":""},{"location":"cli/#hash-path-nar-hash-of-a-path","title":"<code>hash-path</code> \u2014 NAR hash of a path","text":"<p>Compute the SHA-256 hash of the NAR serialization of a file or directory. Equivalent to <code>nix hash path</code>.</p> <pre><code>python -m pix hash-path &lt;path&gt; [--base32]\n</code></pre> Flag Description <code>--base32</code> Output in Nix base32 instead of hex <p>Examples:</p> <pre><code>$ python -m pix hash-path ./pix/base32.py\nsha256:0a43087...\n\n$ python -m pix hash-path ./pix/base32.py --base32\nsha256:1l1a9cfyhln3s40sb9b2w2h4z8p3566xkbs84vk819h3107ahkvl\n\n$ python -m pix hash-path ./my-directory --base32\nsha256:1vrbglcwc4gpln263rg69jq6vgq8p3ibspdg7lzyxcyc0ryg5wn2\n</code></pre> <p>Note</p> <p><code>hash-path</code> hashes the NAR serialization, not the raw file bytes. This includes file type metadata and, for directories, sorted entry names. Use <code>hash-file</code> for raw content hashing.</p>"},{"location":"cli/#hash-file-flat-sha-256-of-a-file","title":"<code>hash-file</code> \u2014 Flat SHA-256 of a file","text":"<p>Hash the raw bytes of a file (no NAR wrapping). Equivalent to <code>nix hash file</code>.</p> <pre><code>python -m pix hash-file &lt;path&gt; [--base32]\n</code></pre> <p>Examples:</p> <pre><code>$ echo -n \"hello\" &gt; /tmp/hello.txt\n$ python -m pix hash-file /tmp/hello.txt --base32\nsha256:094qif9n4cq4fdg459qzbhg1c6wywawwaaivx0k0x8xhbyx4vwic\n</code></pre>"},{"location":"cli/#store-path-compute-store-path","title":"<code>store-path</code> \u2014 Compute store path","text":"<p>Compute the Nix store path for a local file or directory, as if it were added via <code>builtins.path</code> or <code>filterSource</code>.</p> <pre><code>python -m pix store-path &lt;path&gt; [--name NAME]\n</code></pre> Flag Description <code>--name</code> Override the store object name (default: basename of path) <p>Examples:</p> <pre><code>$ python -m pix store-path ./my-source\n/nix/store/pagr3c3r57k8h9zqhb89cqihhc9sbz03-my-source\n\n$ python -m pix store-path ./my-source --name custom-name\n/nix/store/abc123...-custom-name\n</code></pre>"},{"location":"cli/#drv-show-parse-drv-as-json","title":"<code>drv-show</code> \u2014 Parse <code>.drv</code> as JSON","text":"<p>Parse a <code>.drv</code> file from the Nix store and display it as formatted JSON. Equivalent to <code>nix derivation show</code>.</p> <pre><code>python -m pix drv-show &lt;drv-path&gt;\n</code></pre> <p>Example:</p> <pre><code>$ python -m pix drv-show /nix/store/...-hello-2.12.2.drv\n{\n  \"outputs\": {\n    \"out\": {\n      \"path\": \"/nix/store/...-hello-2.12.2\",\n      \"hashAlgo\": \"\",\n      \"hash\": \"\"\n    }\n  },\n  \"inputDrvs\": {\n    \"/nix/store/...-bash.drv\": [\"out\"],\n    \"/nix/store/...-stdenv.drv\": [\"out\"]\n  },\n  \"inputSrcs\": [\"/nix/store/...-default-builder.sh\"],\n  \"platform\": \"x86_64-linux\",\n  \"builder\": \"/nix/store/...-bash/bin/bash\",\n  \"args\": [\"-e\", \"/nix/store/...-default-builder.sh\"],\n  \"env\": {\"name\": \"hello\", \"version\": \"2.12.2\", ...}\n}\n</code></pre>"},{"location":"cli/#path-info-query-store-path-info","title":"<code>path-info</code> \u2014 Query store path info","text":"<p>Query metadata for a store path from the Nix daemon. Requires a running daemon.</p> <pre><code>python -m pix path-info &lt;store-path&gt;\n</code></pre> <p>Example:</p> <pre><code>$ python -m pix path-info /nix/store/...-hello-2.12.2\nderiver: /nix/store/...-hello-2.12.2.drv\nnar-hash: sha256:1abc...\nnar-size: 53856\nreferences: /nix/store/...-glibc /nix/store/...-hello-2.12.2\nsigs: cache.nixos.org-1:abc123...\n</code></pre>"},{"location":"cli/#is-valid-check-store-path-validity","title":"<code>is-valid</code> \u2014 Check store path validity","text":"<p>Check whether a store path exists and is valid. Exits 0 if valid, 1 if not.</p> <pre><code>python -m pix is-valid &lt;store-path&gt;\n</code></pre> <p>Example:</p> <pre><code>$ python -m pix is-valid /nix/store/...-hello-2.12.2\nvalid\n\n$ python -m pix is-valid /nix/store/aaaa...-nonexistent\ninvalid\n</code></pre>"},{"location":"cli/#add-text-add-text-to-the-store","title":"<code>add-text</code> \u2014 Add text to the store","text":"<p>Add a text string to the Nix store, like <code>builtins.toFile</code>. Reads from stdin if content is <code>-</code> or omitted.</p> <pre><code>python -m pix add-text &lt;name&gt; [content]\n</code></pre> <p>Examples:</p> <pre><code>$ python -m pix add-text hello.txt \"hello world\"\n/nix/store/qbfcv31xi1wjisxwl4b2nk1a8jqxbcf5-hello.txt\n\n$ echo \"from stdin\" | python -m pix add-text piped.txt\n/nix/store/...-piped.txt\n</code></pre>"},{"location":"cli/#build-build-store-paths","title":"<code>build</code> \u2014 Build store paths","text":"<p>Build one or more derivation outputs via the Nix daemon.</p> <pre><code>python -m pix build &lt;path&gt;...\n</code></pre> <p>Example:</p> <pre><code>$ python -m pix build /nix/store/...-hello-2.12.2.drv^out\nbuild succeeded\n</code></pre>"},{"location":"api/","title":"API Reference","text":"<p>Each module is a self-contained, readable implementation of one Nix concept. No external dependencies \u2014 stdlib only.</p>"},{"location":"api/#pix-modules","title":"pix modules","text":"Module Lines What it implements <code>pix.base32</code> ~40 The Nix base32 encoding \u2014 custom alphabet, reversed bit extraction <code>pix.hash</code> ~20 SHA-256 wrapper + XOR-fold compression <code>pix.nar</code> ~80 NAR archive serialization (files, dirs, symlinks) <code>pix.store_path</code> ~70 Store path fingerprinting for text, source, fixed-output, and derivation outputs <code>pix.derivation</code> ~250 ATerm parser/serializer + <code>hashDerivationModulo</code> <code>pix.daemon</code> ~270 Unix socket client: handshake, stderr draining, store operations"},{"location":"api/#pixpkgs-modules","title":"pixpkgs modules","text":"Module Lines What it implements <code>pixpkgs.drv</code> ~140 <code>drv()</code> constructor + <code>Package</code> dataclass \u2014 the <code>mkDerivation</code> equivalent <code>pixpkgs.package_set</code> ~30 <code>PackageSet</code> with <code>call()</code> \u2014 the <code>callPackage</code> equivalent <code>pixpkgs.realize</code> ~30 Write <code>.drv</code> to store and build via daemon"},{"location":"api/#dependency-graph","title":"Dependency graph","text":"<pre><code>pixpkgs\n  drv \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 derivation + store_path\n  package_set     (standalone \u2014 inspect only)\n  realize \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 daemon\n\npix\n  daemon  (standalone \u2014 wire protocol only)\n\n  store_path \u2500\u2500\u2500 hash\n      \u2502            \u2502\n      \u2514\u2500\u2500 base32   \u2502\n                   \u2502\n  nar \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n  derivation \u2500\u2500\u2500 hash\n</code></pre> <p>No circular dependencies. <code>daemon</code> is fully independent \u2014 it speaks the binary protocol directly without needing local hash computation.</p>"},{"location":"api/#reading-the-code","title":"Reading the code","text":"<p>The modules are designed to be read top-to-bottom. Each file starts with a docstring explaining the format or protocol, then implements it in the most straightforward way possible.</p> <p>If you want to understand why the algorithms work the way they do, see the Internals section. If you want to see how they're implemented, read the source \u2014 it's all in <code>pix/</code> and <code>pixpkgs/</code>.</p>"},{"location":"api/base32/","title":"pix.base32","text":"<p>Nix-specific base32 encoding and decoding.</p> <p>Warning</p> <p>This is not RFC 4648 base32. Nix uses a different alphabet and a different bit-extraction order. See Internals: Base32 for the full comparison.</p>"},{"location":"api/base32/#constants","title":"Constants","text":""},{"location":"api/base32/#chars","title":"<code>CHARS</code>","text":"<pre><code>CHARS = \"0123456789abcdfghijklmnpqrsvwxyz\"\n</code></pre> <p>The 32-character Nix base32 alphabet. Notable omissions: <code>e</code>, <code>o</code>, <code>t</code>, <code>u</code>.</p>"},{"location":"api/base32/#functions","title":"Functions","text":""},{"location":"api/base32/#encodedata-bytes-str","title":"<code>encode(data: bytes) -&gt; str</code>","text":"<p>Encode bytes to a Nix base32 string.</p> <p>Output length: <code>ceil(n * 8 / 5)</code> characters for <code>n</code> input bytes.</p> Input size Output size Used for 20 bytes 32 chars Store path hashes 32 bytes 52 chars SHA-256 digests <pre><code>from pix.base32 import encode\n\nencode(b\"\\x00\" * 20)\n# '00000000000000000000000000000000'\n\nimport hashlib\ndigest = hashlib.sha256(b\"hello\").digest()\nencode(digest)\n# '094qif9n4cq4fdg459qzbhg1c6wywawwaaivx0k0x8xhbyx4vwic'\n</code></pre>"},{"location":"api/base32/#decodes-str-bytes","title":"<code>decode(s: str) -&gt; bytes</code>","text":"<p>Decode a Nix base32 string back to bytes.</p> <p>Raises: <code>ValueError</code> if the string contains characters not in the Nix base32 alphabet.</p> <pre><code>from pix.base32 import decode\n\ndecode(\"094qif9n4cq4fdg459qzbhg1c6wywawwaaivx0k0x8xhbyx4vwic\")\n# b',\\xf2M\\xba_\\xb0\\xa3\\x0e&amp;\\xe8;*\\xc5\\xb9\\xe2\\x9e\\x1b\\x16\\x1e\\\\\\x1f\\xa7B^s\\x043b\\x93\\x8b\\x98$'\n\ndecode(\"00000000000000000000000000000000\")\n# b'\\x00' * 20\n</code></pre>"},{"location":"api/base32/#roundtrip","title":"Roundtrip","text":"<p>Encode and decode are inverse operations:</p> <pre><code>from pix.base32 import encode, decode\n\ndata = b\"any bytes here\"\nassert decode(encode(data)) == data\n</code></pre>"},{"location":"api/daemon/","title":"pix.daemon","text":"<p>Nix daemon Unix socket client. Communicates using the Nix worker protocol over <code>/nix/var/nix/daemon-socket/socket</code>.</p> <p>See Internals: Daemon Protocol for protocol details.</p>"},{"location":"api/daemon/#classes","title":"Classes","text":""},{"location":"api/daemon/#daemonconnection","title":"<code>DaemonConnection</code>","text":"<p>Context manager for a connection to the Nix daemon.</p> <pre><code>from pix.daemon import DaemonConnection\n\nwith DaemonConnection() as conn:\n    # use conn...\n    pass\n\n# Or with a custom socket path:\nwith DaemonConnection(\"/custom/socket/path\") as conn:\n    pass\n</code></pre> <p>Constructor:</p> <pre><code>DaemonConnection(socket_path: str | None = None)\n</code></pre> Parameter Default Description <code>socket_path</code> <code>/nix/var/nix/daemon-socket/socket</code> Unix socket path <p>Attributes:</p> Attribute Type Description <code>daemon_version</code> <code>int</code> Protocol version after handshake (e.g. <code>293</code> = 1.37)"},{"location":"api/daemon/#operations","title":"Operations","text":""},{"location":"api/daemon/#is_valid_pathpath-str-bool","title":"<code>is_valid_path(path: str) -&gt; bool</code>","text":"<p>Check if a store path exists and is valid in the Nix store.</p> <pre><code>with DaemonConnection() as conn:\n    conn.is_valid_path(\"/nix/store/...-hello-2.12.2\")  # True\n    conn.is_valid_path(\"/nix/store/aaaa...-nope\")       # False\n</code></pre>"},{"location":"api/daemon/#query_valid_pathspaths-liststr-substitute-bool-false-setstr","title":"<code>query_valid_paths(paths: list[str], substitute: bool = False) -&gt; set[str]</code>","text":"<p>Batch validity check. Returns the subset of paths that are valid.</p> <pre><code>with DaemonConnection() as conn:\n    valid = conn.query_valid_paths([\n        \"/nix/store/...-hello\",\n        \"/nix/store/...-nonexistent\",\n    ])\n    # {'/nix/store/...-hello'}\n</code></pre> Parameter Description <code>substitute</code> If <code>True</code>, attempt to substitute missing paths"},{"location":"api/daemon/#query_path_infopath-str-pathinfo","title":"<code>query_path_info(path: str) -&gt; PathInfo</code>","text":"<p>Query metadata for a valid store path.</p> <p>Raises: <code>NixDaemonError</code> if the path is not valid.</p> <pre><code>with DaemonConnection() as conn:\n    info = conn.query_path_info(\"/nix/store/...-hello-2.12.2\")\n    info.deriver       # '/nix/store/...-hello-2.12.2.drv'\n    info.nar_hash       # 'sha256:1abc...'\n    info.nar_size       # 53856\n    info.references     # ['/nix/store/...-glibc', ...]\n    info.sigs           # ['cache.nixos.org-1:abc...']\n</code></pre>"},{"location":"api/daemon/#add_text_to_storename-str-content-str-references-liststr-none-none-str","title":"<code>add_text_to_store(name: str, content: str, references: list[str] | None = None) -&gt; str</code>","text":"<p>Add a text string to the Nix store. Returns the store path.</p> <p>Like <code>builtins.toFile</code> \u2014 creates a regular file with the given content.</p> <pre><code>with DaemonConnection() as conn:\n    path = conn.add_text_to_store(\"hello.txt\", \"hello world\")\n    # '/nix/store/qbfcv31xi1wjisxwl4b2nk1a8jqxbcf5-hello.txt'\n\n    # With references (the text depends on another store path):\n    path = conn.add_text_to_store(\n        \"wrapper.sh\",\n        \"#!/bin/sh\\nexec /nix/store/...-program/bin/prog\",\n        references=[\"/nix/store/...-program\"]\n    )\n</code></pre>"},{"location":"api/daemon/#build_pathspaths-liststr-build_mode-int-0-none","title":"<code>build_paths(paths: list[str], build_mode: int = 0) -&gt; None</code>","text":"<p>Build one or more store paths. For derivations, use the <code>&lt;drv-path&gt;^&lt;output&gt;</code> syntax.</p> <p>Raises: <code>NixDaemonError</code> on build failure.</p> <pre><code>with DaemonConnection() as conn:\n    # Build a derivation output\n    conn.build_paths([\"/nix/store/...-hello.drv^out\"])\n\n    # Substitute/build multiple paths\n    conn.build_paths([\n        \"/nix/store/...-hello.drv^out\",\n        \"/nix/store/...-world.drv^out\",\n    ])\n</code></pre> <code>build_mode</code> Meaning <code>0</code> Normal (build or substitute) <code>1</code> Repair <code>2</code> Check"},{"location":"api/daemon/#data-classes","title":"Data classes","text":""},{"location":"api/daemon/#pathinfo","title":"<code>PathInfo</code>","text":"<p>Returned by <code>query_path_info</code>.</p> <pre><code>@dataclass\nclass PathInfo:\n    deriver: str            # .drv path that produced this, or \"\"\n    nar_hash: str           # NAR hash as string\n    references: list[str]   # store paths this depends on\n    registration_time: int  # unix timestamp\n    nar_size: int           # size of NAR serialization in bytes\n    sigs: list[str]         # signatures\n</code></pre>"},{"location":"api/daemon/#exceptions","title":"Exceptions","text":""},{"location":"api/daemon/#nixdaemonerror","title":"<code>NixDaemonError</code>","text":"<p>Raised on protocol errors, invalid paths, build failures, etc.</p> <pre><code>from pix.daemon import DaemonConnection, NixDaemonError\n\nwith DaemonConnection() as conn:\n    try:\n        conn.query_path_info(\"/nix/store/invalid-path\")\n    except NixDaemonError as e:\n        print(f\"Daemon error: {e}\")\n</code></pre>"},{"location":"api/derivation/","title":"pix.derivation","text":"<p>Parse and serialize Nix <code>.drv</code> files (ATerm format), and compute derivation hashes for output path calculation.</p> <p>See Internals: Derivations for the ATerm format specification.</p>"},{"location":"api/derivation/#data-classes","title":"Data classes","text":""},{"location":"api/derivation/#derivationoutput","title":"<code>DerivationOutput</code>","text":"<pre><code>@dataclass\nclass DerivationOutput:\n    path: str        # output store path (empty for content-addressed)\n    hash_algo: str   # \"\" for normal outputs, \"sha256\" etc. for fixed-output\n    hash_value: str  # \"\" for normal outputs, hex hash for fixed-output\n</code></pre>"},{"location":"api/derivation/#derivation","title":"<code>Derivation</code>","text":"<pre><code>@dataclass\nclass Derivation:\n    outputs: dict[str, DerivationOutput]     # \"out\" -&gt; DerivationOutput(...)\n    input_drvs: dict[str, list[str]]         # drv_path -&gt; [\"out\", ...]\n    input_srcs: list[str]                    # source store paths\n    platform: str                            # \"x86_64-linux\"\n    builder: str                             # \"/nix/store/...-bash/bin/bash\"\n    args: list[str]                          # builder arguments\n    env: dict[str, str]                      # environment variables\n</code></pre>"},{"location":"api/derivation/#functions","title":"Functions","text":""},{"location":"api/derivation/#parsedrv_text-str-derivation","title":"<code>parse(drv_text: str) -&gt; Derivation</code>","text":"<p>Parse an ATerm <code>.drv</code> file into a <code>Derivation</code>.</p> <pre><code>from pix.derivation import parse\n\ndrv = parse(open(\"/nix/store/...-hello-2.12.2.drv\").read())\n\ndrv.platform       # 'x86_64-linux'\ndrv.builder         # '/nix/store/...-bash/bin/bash'\ndrv.outputs.keys()  # dict_keys(['out'])\ndrv.env['name']     # 'hello'\n</code></pre> <p>Handles escape sequences in strings: <code>\\\\</code>, <code>\\\"</code>, <code>\\n</code>, <code>\\r</code>, <code>\\t</code>.</p>"},{"location":"api/derivation/#serializedrv-derivation-str","title":"<code>serialize(drv: Derivation) -&gt; str</code>","text":"<p>Serialize a <code>Derivation</code> back to ATerm <code>.drv</code> format.</p> <p>Output is deterministic:</p> <ul> <li>Outputs sorted by name</li> <li>Input derivations sorted by path</li> <li>Input sources sorted</li> <li>Environment variables sorted by key</li> <li>Strings properly escaped</li> </ul> <pre><code>from pix.derivation import parse, serialize\n\ntext = open(\"/nix/store/...-hello.drv\").read()\ndrv = parse(text)\nassert parse(serialize(drv)) == drv  # roundtrip\n</code></pre>"},{"location":"api/derivation/#hash_derivation_modulodrv-derivation-drv_hashes-dictstr-bytes-none-none-bytes","title":"<code>hash_derivation_modulo(drv: Derivation, drv_hashes: dict[str, bytes] | None = None) -&gt; bytes</code>","text":"<p>Compute the modular hash of a derivation, used for output path computation.</p> <p>Fixed-output derivations (single output <code>\"out\"</code> with <code>hash_algo</code> set):</p> <pre><code>sha256(\"fixed:out:&lt;hash_algo&gt;:&lt;hash_value&gt;:\")\n</code></pre> <p>Regular derivations: Creates a masked copy where output paths are blanked and input derivation paths are replaced by their modular hashes, then hashes the resulting ATerm.</p> <pre><code>from pix.derivation import parse, hash_derivation_modulo\n\ndrv = parse(open(\"some.drv\").read())\n\n# For fixed-output:\nh = hash_derivation_modulo(drv)\n\n# For regular derivations, provide input drv hashes:\nh = hash_derivation_modulo(drv, drv_hashes={\n    \"/nix/store/...-dep.drv\": dep_hash,\n})\n</code></pre> <p>Warning</p> <p>For regular (non-fixed-output) derivations, you must provide the modular hashes of all input derivations via the <code>drv_hashes</code> parameter. Missing hashes raise <code>ValueError</code>.</p>"},{"location":"api/derivation/#example-full-derivation-inspection","title":"Example: Full derivation inspection","text":"<pre><code>from pix.derivation import parse\nimport json\n\ndrv = parse(open(\"/nix/store/...-hello-2.12.2.drv\").read())\n\nprint(f\"Package: {drv.env.get('pname', drv.env.get('name', '?'))}\")\nprint(f\"Version: {drv.env.get('version', '?')}\")\nprint(f\"System:  {drv.platform}\")\nprint(f\"Builder: {drv.builder}\")\nprint(f\"Outputs: {list(drv.outputs.keys())}\")\nprint(f\"Dependencies: {len(drv.input_drvs)} derivations, {len(drv.input_srcs)} sources\")\n</code></pre>"},{"location":"api/hash/","title":"pix.hash","text":"<p>Hash utilities for Nix store path computation.</p>"},{"location":"api/hash/#functions","title":"Functions","text":""},{"location":"api/hash/#sha256data-bytes-bytes","title":"<code>sha256(data: bytes) -&gt; bytes</code>","text":"<p>Compute SHA-256 digest. Thin wrapper around <code>hashlib.sha256</code>.</p> <pre><code>from pix.hash import sha256\n\nsha256(b\"hello\")\n# b',\\xf2M\\xba_\\xb0\\xa3\\x0e...' (32 bytes)\n</code></pre>"},{"location":"api/hash/#sha256_hexdata-bytes-str","title":"<code>sha256_hex(data: bytes) -&gt; str</code>","text":"<p>Compute SHA-256 digest as a hex string.</p> <pre><code>from pix.hash import sha256_hex\n\nsha256_hex(b\"hello\")\n# '2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824'\n</code></pre>"},{"location":"api/hash/#compress_hashhash_bytes-bytes-size-int-bytes","title":"<code>compress_hash(hash_bytes: bytes, size: int) -&gt; bytes</code>","text":"<p>XOR-fold a hash to a shorter length.</p> <p>This is how Nix truncates SHA-256 (32 bytes) to 160 bits (20 bytes) for store path hashes. It is not simple truncation \u2014 every byte of the input contributes to the output via XOR.</p> <p>Algorithm:</p> <pre><code>result = bytearray(size)       # zero-initialized\nfor i, b in enumerate(hash_bytes):\n    result[i % size] ^= b      # XOR each byte into position\n</code></pre> <p>Example:</p> <pre><code>from pix.hash import compress_hash, sha256\n\ndigest = sha256(b\"hello\")           # 32 bytes\ncompressed = compress_hash(digest, 20)  # 20 bytes\n\n# Bytes 0..19 of the digest are XOR'd with bytes 20..31\n# compressed[0] = digest[0] ^ digest[20]\n# compressed[1] = digest[1] ^ digest[21]\n# ...\n# compressed[11] = digest[11] ^ digest[31]\n# compressed[12..19] = digest[12..19]  (no folding needed)\n</code></pre> <p>Info</p> <p>XOR-fold preserves more entropy than truncation. Every bit of the original hash affects the compressed output.</p>"},{"location":"api/nar/","title":"pix.nar","text":"<p>NAR (Nix Archive) serialization and hashing.</p> <p>NAR is a deterministic archive format. Unlike tar, it produces identical output for identical filesystem content regardless of timestamps, ownership, or permissions (only the executable bit is preserved).</p> <p>See Internals: NAR Format for the wire format specification.</p>"},{"location":"api/nar/#functions","title":"Functions","text":""},{"location":"api/nar/#nar_serializepath-str-path-bytes","title":"<code>nar_serialize(path: str | Path) -&gt; bytes</code>","text":"<p>Serialize a filesystem path (file, directory, or symlink) to NAR bytes.</p> <pre><code>from pix.nar import nar_serialize\n\n# Serialize a single file\nnar = nar_serialize(\"/tmp/hello.txt\")\n\n# Serialize a directory (entries sorted by name)\nnar = nar_serialize(\"/path/to/my-source\")\n</code></pre> <p>Behavior:</p> <ul> <li>Regular files: Serialized with contents and executable flag</li> <li>Symlinks: Serialized with symlink target (not resolved)</li> <li>Directories: Entries sorted lexicographically by name, recursed</li> <li>Other types: Raises <code>ValueError</code></li> </ul>"},{"location":"api/nar/#nar_hashpath-str-path-bytes","title":"<code>nar_hash(path: str | Path) -&gt; bytes</code>","text":"<p>Compute the SHA-256 hash of the NAR serialization. Returns 32 raw bytes.</p> <p>This is what <code>nix hash path</code> computes.</p> <pre><code>from pix.nar import nar_hash\n\ndigest = nar_hash(\"./my-file.txt\")  # 32 bytes\ndigest.hex()\n# 'a1b2c3d4...'\n</code></pre>"},{"location":"api/nar/#nar_hash_hexpath-str-path-str","title":"<code>nar_hash_hex(path: str | Path) -&gt; str</code>","text":"<p>Same as <code>nar_hash</code> but returns hex string directly.</p> <pre><code>from pix.nar import nar_hash_hex\n\nnar_hash_hex(\"./my-file.txt\")\n# 'a1b2c3d4...'\n</code></pre>"},{"location":"api/nar/#combining-with-other-modules","title":"Combining with other modules","text":"<p>NAR hashing is the first step in computing store paths for source imports:</p> <pre><code>from pix.nar import nar_hash\nfrom pix.store_path import make_source_store_path\n\nh = nar_hash(\"./my-project\")\npath = make_source_store_path(\"my-project\", h)\n# '/nix/store/abc123...-my-project'\n</code></pre>"},{"location":"api/pixpkgs/","title":"pixpkgs","text":"<p>A nixpkgs-like package set built on pix's low-level primitives. Maps Nix patterns to Python idioms.</p>"},{"location":"api/pixpkgs/#drv","title":"<code>drv()</code>","text":"<pre><code>from pixpkgs import drv\n\npkg = drv(\n    name=\"hello\",\n    builder=\"/bin/sh\",\n    args=[\"-c\", \"echo hello &gt; $out\"],\n)\n</code></pre>"},{"location":"api/pixpkgs/#signature","title":"Signature","text":"<pre><code>def drv(\n    name: str,\n    builder: str,\n    system: str = \"x86_64-linux\",\n    args: list[str] | None = None,\n    env: dict[str, str] | None = None,\n    output_names: list[str] | None = None,\n    deps: list[Package] | None = None,\n    srcs: list[str] | None = None,\n) -&gt; Package\n</code></pre>"},{"location":"api/pixpkgs/#parameters","title":"Parameters","text":"Parameter Default Description <code>name</code> \u2014 Package name (becomes the store path suffix) <code>builder</code> \u2014 Path to the builder executable <code>system</code> <code>\"x86_64-linux\"</code> Build platform <code>args</code> <code>[]</code> Arguments to the builder <code>env</code> <code>{}</code> Extra environment variables <code>output_names</code> <code>[\"out\"]</code> Output names <code>deps</code> <code>[]</code> Package dependencies (added as <code>inputDrvs</code>) <code>srcs</code> <code>[]</code> Input source store paths"},{"location":"api/pixpkgs/#pipeline","title":"Pipeline","text":"<p><code>drv()</code> runs the full 6-step derivation pipeline internally:</p> <pre><code>1. Create Derivation with blank output paths\n2. Collect input derivation hashes (mask_outputs=False)\n3. hashDerivationModulo (mask_outputs=True for self)\n4. make_output_path \u2192 fill output paths into .outputs and .env\n5. serialize to ATerm\n6. make_text_store_path \u2192 compute .drv store path\n</code></pre> <p>Standard env vars (<code>name</code>, <code>builder</code>, <code>system</code>, output names) are added automatically, matching what Nix's <code>derivation</code> builtin does.</p>"},{"location":"api/pixpkgs/#package","title":"<code>Package</code>","text":"<p>A frozen dataclass returned by <code>drv()</code>.</p>"},{"location":"api/pixpkgs/#attributes","title":"Attributes","text":"Attribute Type Description <code>name</code> <code>str</code> Package name <code>drv</code> <code>Derivation</code> The underlying pix Derivation object <code>drv_path</code> <code>str</code> Store path of the <code>.drv</code> file <code>outputs</code> <code>dict[str, str]</code> Output name \u2192 store path mapping"},{"location":"api/pixpkgs/#packageout","title":"<code>Package.out</code>","text":"<pre><code>pkg.out  # \"/nix/store/&lt;hash&gt;-hello\"\n</code></pre> <p>Shortcut to <code>pkg.outputs[\"out\"]</code> \u2014 the default output path.</p>"},{"location":"api/pixpkgs/#package__str__","title":"<code>Package.__str__</code>","text":"<pre><code>f\"echo {pkg} &gt; $out\"  # embeds the output path\n</code></pre> <p>Returns <code>pkg.out</code>. This mirrors Nix's string interpolation context \u2014 using <code>${pkg}</code> in Nix gives the package's default output path.</p>"},{"location":"api/pixpkgs/#packageoverride","title":"<code>Package.override()</code>","text":"<pre><code>pkg2 = pkg.override(name=\"hello-custom\", env={\"CFLAGS\": \"-O2\"})\n</code></pre> <p>Re-derives the package with changed arguments. Like <code>pkg.override</code> in Nix \u2014 creates a new Package with a fresh derivation hash.</p>"},{"location":"api/pixpkgs/#packageset","title":"<code>PackageSet</code>","text":"<p>Base class for defining a set of interdependent packages with automatic dependency injection.</p> <pre><code>from pixpkgs import drv, PackageSet, realize\nfrom functools import cached_property\n\nclass MyPkgs(PackageSet):\n    @cached_property\n    def greeting(self):\n        return drv(\n            name=\"greeting\",\n            builder=\"/bin/sh\",\n            args=[\"-c\", \"echo hello &gt; $out\"],\n        )\n\n    @cached_property\n    def shouter(self):\n        return self.call(lambda greeting: drv(\n            name=\"shouter\",\n            builder=\"/bin/sh\",\n            args=[\"-c\", f\"read line &lt; {greeting}; echo $line! &gt; $out\"],\n            deps=[greeting],\n        ))\n\npkgs = MyPkgs()\nrealize(pkgs.shouter)  # builds greeting first, then shouter\n</code></pre>"},{"location":"api/pixpkgs/#packagesetcallfn","title":"<code>PackageSet.call(fn)</code>","text":"<p>Inspects <code>fn</code>'s parameter names and looks them up as attributes on <code>self</code>. This is the Python equivalent of Nix's <code>callPackage</code> pattern \u2014 dependencies are injected by name rather than passed explicitly.</p> <pre><code># These are equivalent:\npkgs.call(lambda greeting: use(greeting))\nuse(pkgs.greeting)\n</code></pre> <p>Combined with <code>@cached_property</code>, this gives lazy evaluation \u2014 packages are only constructed when first accessed, and memoized thereafter.</p>"},{"location":"api/pixpkgs/#realize","title":"<code>realize()</code>","text":"<pre><code>from pixpkgs import realize\n\noutput_path = realize(pkg)\n# \"/nix/store/&lt;hash&gt;-hello\"\n</code></pre>"},{"location":"api/pixpkgs/#signature_1","title":"Signature","text":"<pre><code>def realize(pkg: Package, conn: DaemonConnection | None = None) -&gt; str\n</code></pre> <p>Builds a package via the Nix daemon:</p> <ol> <li>Recursively registers all dependency <code>.drv</code> files in the store via <code>add_text_to_store</code></li> <li>Calls <code>build_paths</code> to build the package</li> <li>Returns the default output path</li> </ol> <p>If <code>conn</code> is not provided, opens and closes a <code>DaemonConnection</code> automatically.</p>"},{"location":"api/store_path/","title":"pix.store_path","text":"<p>Compute Nix store paths. A store path is <code>/nix/store/&lt;hash&gt;-&lt;name&gt;</code> where <code>&lt;hash&gt;</code> is 32 characters of Nix base32 encoding a 160-bit hash.</p> <p>See Internals: Store Paths for the full algorithm.</p>"},{"location":"api/store_path/#constants","title":"Constants","text":""},{"location":"api/store_path/#store_dir","title":"<code>STORE_DIR</code>","text":"<pre><code>STORE_DIR = \"/nix/store\"\n</code></pre>"},{"location":"api/store_path/#hash_bytes","title":"<code>HASH_BYTES</code>","text":"<pre><code>HASH_BYTES = 20  # 160 bits\n</code></pre>"},{"location":"api/store_path/#functions","title":"Functions","text":""},{"location":"api/store_path/#make_store_pathtype_prefix-str-inner_hash-bytes-name-str-str","title":"<code>make_store_path(type_prefix: str, inner_hash: bytes, name: str) -&gt; str</code>","text":"<p>Low-level store path computation. Most callers should use the typed helpers below.</p> <p>Computes the fingerprint <code>&lt;type&gt;:sha256:&lt;hex&gt;:/nix/store:&lt;name&gt;</code>, hashes it with SHA-256, XOR-folds to 20 bytes, and encodes in Nix base32.</p> <pre><code>from pix.store_path import make_store_path\nfrom pix.hash import sha256\n\nh = sha256(b\"some content\")\npath = make_store_path(\"text\", h, \"example.txt\")\n</code></pre>"},{"location":"api/store_path/#make_text_store_pathname-str-content-bytes-references-liststr-none-none-str","title":"<code>make_text_store_path(name: str, content: bytes, references: list[str] | None = None) -&gt; str</code>","text":"<p>Store path for a text file. Equivalent to <code>builtins.toFile</code> or <code>pkgs.writeText</code>.</p> <p>The inner hash is <code>sha256(content)</code>. The type prefix is <code>text</code> with references appended.</p> <pre><code>from pix.store_path import make_text_store_path\n\n# Simple text file\npath = make_text_store_path(\"hello.txt\", b\"hello world\")\n# '/nix/store/qbfcv31xi1wjisxwl4b2nk1a8jqxbcf5-hello.txt'\n\n# Text file that references another store path\npath = make_text_store_path(\n    \"script.sh\",\n    b\"#!/bin/sh\\nexec /nix/store/...-bash/bin/bash\",\n    references=[\"/nix/store/...-bash\"]\n)\n</code></pre>"},{"location":"api/store_path/#make_source_store_pathname-str-nar_hash-bytes-references-liststr-none-none-str","title":"<code>make_source_store_path(name: str, nar_hash: bytes, references: list[str] | None = None) -&gt; str</code>","text":"<p>Store path for a source directory or file. This is what happens when you use <code>builtins.path</code>, <code>filterSource</code>, or a bare path import in Nix.</p> <p>The inner hash is the SHA-256 of the NAR serialization.</p> <pre><code>from pix.store_path import make_source_store_path\nfrom pix.nar import nar_hash\n\nh = nar_hash(\"./my-project\")\npath = make_source_store_path(\"my-project\", h)\n</code></pre>"},{"location":"api/store_path/#make_fixed_output_pathname-str-hash_algo-str-content_hash-bytes-recursive-bool-false-str","title":"<code>make_fixed_output_path(name: str, hash_algo: str, content_hash: bytes, recursive: bool = False) -&gt; str</code>","text":"<p>Store path for a fixed-output derivation result (like <code>fetchurl</code>, <code>fetchgit</code>).</p> <pre><code>from pix.store_path import make_fixed_output_path\n\n# Flat file (fetchurl with sha256)\npath = make_fixed_output_path(\"source.tar.gz\", \"sha256\", hash_bytes)\n\n# Recursive (fetchgit, fetchFromGitHub)\npath = make_fixed_output_path(\"source\", \"sha256\", nar_hash_bytes, recursive=True)\n</code></pre> <p>Note</p> <p>For <code>recursive=True</code> with <code>sha256</code>, the path is computed as a source path directly (same as <code>make_source_store_path</code>). For other combinations, an intermediate hash is computed first.</p>"},{"location":"api/store_path/#make_output_pathdrv_hash-bytes-output_name-str-name-str-str","title":"<code>make_output_path(drv_hash: bytes, output_name: str, name: str) -&gt; str</code>","text":"<p>Store path for a derivation output, given the derivation's modular hash (from <code>hash_derivation_modulo</code>).</p> <pre><code>from pix.store_path import make_output_path\n\npath = make_output_path(drv_hash, \"out\", \"hello-2.12.2\")\n</code></pre>"},{"location":"internals/","title":"Internals","text":"<p>How Nix actually works \u2014 the formats, protocols, and algorithms, explained through the Python code that reimplements them.</p> <p>Each page pairs an explanation of the concept with pointers to the pix source that implements it. Read the page, then read the code \u2014 it should click.</p>"},{"location":"internals/#start-here","title":"Start here","text":"Page The question it answers Store Paths How does Nix compute <code>/nix/store/&lt;hash&gt;-&lt;name&gt;</code>? Why 32 characters? NAR Format What's inside a NAR archive? Why not tar? Daemon Protocol How do <code>nix build</code> and <code>nix-store</code> talk to the daemon? Derivations What's in a <code>.drv</code> file? How does <code>hashDerivationModulo</code> break the circular dependency? Base32 Encoding Why doesn't Nix use standard base32? What's different?"},{"location":"internals/#the-big-picture","title":"The big picture","text":"<p>When you write <code>nix build nixpkgs#hello</code>, here's what happens at the level pix operates:</p> <pre><code>1. Nix evaluates the expression \u2192 produces a Derivation\n\n2. The derivation is serialized to ATerm and written as a .drv file\n   (derivation.py can parse this back)\n\n3. Output paths in the .drv are computed via hashDerivationModulo:\n   - Hash the .drv with output paths blanked out\n   - Use that hash as the fingerprint for make_store_path\n   (derivation.py + store_path.py)\n\n4. The .drv is sent to the daemon via the Unix socket protocol\n   (daemon.py speaks this protocol)\n\n5. The daemon builds it:\n   - Realizes input sources (their store paths were computed\n     the same way, using NAR hashes \u2014 nar.py + store_path.py)\n   - Runs the builder\n   - Registers the output in the store database\n\n6. You can query the result via the daemon:\n   - is_valid_path, query_path_info\n   - The NAR hash and references are recorded\n</code></pre> <p>Each step has a corresponding pix module. The code is short enough that you can trace the entire flow.</p>"},{"location":"internals/base32/","title":"Nix Base32 Encoding","text":"<p>Nix uses a custom base32 encoding that differs from both RFC 4648 and other common base32 variants.</p>"},{"location":"internals/base32/#alphabet","title":"Alphabet","text":"<pre><code>Standard (RFC 4648):  A B C D E F G H I J K L M N O P Q R S T U V W X Y Z 2 3 4 5 6 7\nNix:                  0 1 2 3 4 5 6 7 8 9 a b c d f g h i j k l m n p q r s v w x y z\n</code></pre> <p>The Nix alphabet has 32 characters: digits <code>0-9</code> and lowercase letters, but with <code>e</code>, <code>o</code>, <code>t</code>, <code>u</code> removed.</p> <p>Why these four? They could be confused with other characters (<code>e</code>/<code>3</code>, <code>o</code>/<code>0</code>, <code>t</code>/<code>+</code>), though the exact rationale is historical.</p>"},{"location":"internals/base32/#bit-extraction","title":"Bit extraction","text":"<p>This is where Nix base32 differs most significantly from RFC 4648. The bit extraction order is reversed.</p>"},{"location":"internals/base32/#rfc-4648-approach","title":"RFC 4648 approach","text":"<p>Standard base32 processes input left-to-right, taking 5-bit groups from the most significant bits first:</p> <pre><code>Input bytes:   [b0] [b1] [b2] ...\nBits:          76543210 76543210 76543210 ...\nGroups:        |4444433333|22222|11111|00000|...\n</code></pre>"},{"location":"internals/base32/#nix-approach","title":"Nix approach","text":"<p>Nix processes from the last 5-bit position down to the first, extracting bits across byte boundaries:</p> <pre><code>for i in range(out_len - 1, -1, -1):   # high positions first\n    b = i * 5\n    j = b // 8                          # byte index\n    k = b % 8                           # bit offset within byte\n    c = (data[j] &gt;&gt; k)                  # bits from byte j\n    if j + 1 &lt; len(data):\n        c |= data[j + 1] &lt;&lt; (8 - k)    # bits from byte j+1\n    output.append(CHARS[c &amp; 0x1f])\n</code></pre> <p>This means:</p> <ul> <li>The first output character encodes the highest 5-bit group</li> <li>Bits are extracted from the input in little-endian byte order</li> <li>Cross-byte extraction: a 5-bit group can span two adjacent input bytes</li> </ul>"},{"location":"internals/base32/#consequence","title":"Consequence","text":"<p>The same input bytes produce completely different outputs between RFC 4648 and Nix base32, even if you swap the alphabets. The encoding is structurally different, not just an alphabet substitution.</p>"},{"location":"internals/base32/#output-length","title":"Output length","text":"<p>For <code>n</code> input bytes, the output is <code>ceil(n * 8 / 5)</code> characters:</p> Input bytes Output chars Usage 0 0 \u2014 16 26 MD5 (not used by Nix) 20 32 Store path hashes 32 52 SHA-256 hashes 64 103 SHA-512 hashes"},{"location":"internals/base32/#decoding","title":"Decoding","text":"<p>Decoding reverses the process: iterate over the input string in reverse, placing 5-bit groups into the output byte array at the appropriate positions.</p> <pre><code>for i, ch in enumerate(reversed(s)):\n    digit = ALPHABET.index(ch)\n    b = i * 5\n    j = b // 8\n    k = b % 8\n    result[j] |= (digit &lt;&lt; k) &amp; 0xFF\n    carry = digit &gt;&gt; (8 - k)\n    if carry and j + 1 &lt; out_len:\n        result[j + 1] |= carry\n</code></pre>"},{"location":"internals/base32/#comparison-table","title":"Comparison table","text":"Property RFC 4648 Nix Alphabet <code>A-Z2-7</code> <code>0-9a-z</code> minus <code>eotu</code> Padding <code>=</code> pad to multiple of 8 chars No padding Bit order MSB-first, left-to-right LSB-first, right-to-left Case Case-insensitive Lowercase only Byte order Big-endian grouping Little-endian grouping"},{"location":"internals/base32/#example","title":"Example","text":"<p>SHA-256 of <code>\"hello\"</code>:</p> <pre><code>Hex:        2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824\nNix base32: 094qif9n4cq4fdg459qzbhg1c6wywawwaaivx0k0x8xhbyx4vwic\n</code></pre> <p>The same bytes in RFC 4648 base32 would produce a completely different (and longer, with padding) string.</p>"},{"location":"internals/daemon-protocol/","title":"Nix Daemon Protocol","text":"<p>The Nix daemon (<code>nix-daemon</code>) listens on a Unix domain socket and serves store operations to clients. pix implements a client for this protocol in pure Python.</p>"},{"location":"internals/daemon-protocol/#connection","title":"Connection","text":"<p>Socket path: <code>/nix/var/nix/daemon-socket/socket</code></p> <p>The socket is a <code>SOCK_STREAM</code> Unix domain socket. Each client gets a dedicated connection with sequential request/response exchanges.</p>"},{"location":"internals/daemon-protocol/#wire-format","title":"Wire format","text":"<p>All values on the wire use little-endian encoding, padded to 8-byte boundaries:</p> Type Encoding <code>uint64</code> 8 bytes, little-endian <code>bool</code> uint64 (0 = false, nonzero = true) <code>string</code> uint64(length) + bytes + zero-pad to 8 <code>string list</code> uint64(count) + count \u00d7 string <p>This is the same string encoding used in the NAR format.</p>"},{"location":"internals/daemon-protocol/#handshake","title":"Handshake","text":"<pre><code>Client                                          Daemon\n  \u2502                                               \u2502\n  \u251c\u2500\u2500\u2500 uint64(WORKER_MAGIC_1 = 0x6e697863) \u2500\u2500\u2500\u2500\u2500&gt;\u2502\n  \u2502                                               \u2502\n  \u2502&lt;\u2500\u2500 uint64(WORKER_MAGIC_2 = 0x6478696f) \u2500\u2500\u2500\u2500\u2500\u2500\u2524\n  \u2502&lt;\u2500\u2500 uint64(daemon_protocol_version) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n  \u2502                                               \u2502\n  \u251c\u2500\u2500\u2500 uint64(client_protocol_version) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt;\u2502\n  \u251c\u2500\u2500\u2500 uint64(0)  [cpu affinity, obsolete] \u2500\u2500\u2500\u2500\u2500\u2500&gt;\u2502\n  \u251c\u2500\u2500\u2500 uint64(0)  [reserve space, obsolete] \u2500\u2500\u2500\u2500\u2500&gt;\u2502\n  \u2502                                               \u2502\n  \u2502&lt;\u2500\u2500 string(nix_version)  [if proto &gt;= 1.33] \u2500\u2500\u2524\n  \u2502&lt;\u2500\u2500 uint64(trusted)      [if proto &gt;= 1.35] \u2500\u2500\u2524\n  \u2502                                               \u2502\n  \u2502&lt;\u2500\u2500 STDERR_LAST \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n  \u2502                                               \u2502\n</code></pre> <p>Magic numbers:</p> Constant Value ASCII <code>WORKER_MAGIC_1</code> <code>0x6e697863</code> <code>nixc</code> <code>WORKER_MAGIC_2</code> <code>0x6478696f</code> <code>dxio</code> <p>Protocol version is encoded as <code>(major &lt;&lt; 8) | minor</code>. pix uses version <code>1.37</code> = <code>0x0125</code> = <code>293</code>.</p> <p>Trusted status (protocol &gt;= 1.35):</p> Value Meaning 0 Unknown 1 Trusted 2 Not trusted"},{"location":"internals/daemon-protocol/#requestresponse-pattern","title":"Request/response pattern","text":"<p>After the handshake, each operation follows this pattern:</p> <pre><code>Client                                          Daemon\n  \u2502                                               \u2502\n  \u251c\u2500\u2500\u2500 uint64(opcode) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt;\u2502\n  \u251c\u2500\u2500\u2500 &lt;operation-specific data&gt; \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt;\u2502\n  \u2502                                               \u2502\n  \u2502&lt;\u2500\u2500 stderr messages \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n  \u2502&lt;\u2500\u2500 STDERR_LAST \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n  \u2502&lt;\u2500\u2500 &lt;operation-specific response&gt; \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n  \u2502                                               \u2502\n</code></pre>"},{"location":"internals/daemon-protocol/#stderr-message-stream","title":"Stderr message stream","text":"<p>Between request and response, the daemon sends a stream of log messages. The client must drain these before reading the response.</p> <p>Each message starts with a uint64 message type:</p> Type Value Content <code>STDERR_LAST</code> <code>0x616c7473</code> End of stream \u2014 read the response next <code>STDERR_NEXT</code> <code>0x6f6c6d67</code> Log line: <code>string(message)</code> <code>STDERR_ERROR</code> <code>0x63787470</code> Error: <code>string(type) uint64(level) string(name) string(msg) uint64(n_traces) {uint64(pos) string(trace)}*</code> <code>STDERR_START_ACTIVITY</code> <code>0x53545254</code> Activity started: <code>uint64(id) uint64(level) uint64(type) string(text) fields uint64(parent)</code> <code>STDERR_STOP_ACTIVITY</code> <code>0x53544f50</code> Activity stopped: <code>uint64(id)</code> <code>STDERR_RESULT</code> <code>0x52534c54</code> Activity result: <code>uint64(id) uint64(type) fields</code> <p>Fields (used by activity messages):</p> <pre><code>uint64(count)\n{\n  uint64(type)     0 = uint64 value, 1 = string value\n  &lt;value&gt;\n}*\n</code></pre> <p>Always drain stderr</p> <p>You must read all stderr messages until <code>STDERR_LAST</code> before reading the operation response. Failing to do so will desynchronize the protocol.</p>"},{"location":"internals/daemon-protocol/#operations","title":"Operations","text":""},{"location":"internals/daemon-protocol/#isvalidpath-opcode-1","title":"<code>IsValidPath</code> (opcode 1)","text":"<p>Check if a store path is valid.</p> <pre><code>Request:  string(path)\nResponse: bool(valid)\n</code></pre>"},{"location":"internals/daemon-protocol/#addtexttostore-opcode-8","title":"<code>AddTextToStore</code> (opcode 8)","text":"<p>Add a text file to the store.</p> <pre><code>Request:  string(name) string(content) string_list(references)\nResponse: string(store_path)\n</code></pre>"},{"location":"internals/daemon-protocol/#buildpaths-opcode-9","title":"<code>BuildPaths</code> (opcode 9)","text":"<p>Build one or more paths.</p> <pre><code>Request:  string_list(paths) uint64(build_mode)\nResponse: uint64(result)\n</code></pre> <p>Build modes: 0 = normal, 1 = repair, 2 = check.</p> <p>Paths can be opaque store paths or <code>&lt;drv-path&gt;^&lt;output&gt;</code> for derivation outputs.</p>"},{"location":"internals/daemon-protocol/#querypathinfo-opcode-26","title":"<code>QueryPathInfo</code> (opcode 26)","text":"<p>Query metadata for a store path.</p> <pre><code>Request:  string(path)\nResponse: bool(valid)\n          [if valid:]\n          string(deriver)\n          string(nar_hash)\n          string_list(references)\n          uint64(registration_time)\n          uint64(nar_size)\n          bool(ultimate)\n          string_list(sigs)\n          string(content_address)\n</code></pre>"},{"location":"internals/daemon-protocol/#queryvalidpaths-opcode-31","title":"<code>QueryValidPaths</code> (opcode 31)","text":"<p>Batch validity check.</p> <pre><code>Request:  string_list(paths) bool(substitute)\nResponse: string_list(valid_paths)\n</code></pre>"},{"location":"internals/daemon-protocol/#protocol-version-history","title":"Protocol version history","text":"Version Changes 1.11 Reserve space flag in handshake 1.14 CPU affinity in handshake 1.16 <code>ultimate</code> flag in path info 1.17 <code>QueryPathInfo</code> returns validity bool instead of throwing 1.25 Content address field in path info 1.30 DerivedPath serialization for <code>BuildPaths</code> 1.33 Daemon sends nix version string after handshake 1.35 Daemon sends trusted status after handshake 1.37 Current version used by pix"},{"location":"internals/derivations/","title":"Derivations","text":"<p>A derivation is Nix's unit of build. It describes how to produce one or more store paths from inputs, a builder, and environment variables. Derivations are stored in the Nix store as <code>.drv</code> files in ATerm format.</p>"},{"location":"internals/derivations/#aterm-format","title":"ATerm format","text":"<p>A <code>.drv</code> file is a single ATerm expression:</p> <pre><code>Derive(\n  [(\"out\",\"/nix/store/...-hello\",\"\",\"\"), ...],       # outputs\n  [(\"/nix/store/...-dep.drv\",[\"out\"]), ...],         # input derivations\n  [\"/nix/store/...-source\", ...],                    # input sources\n  \"x86_64-linux\",                                    # platform\n  \"/nix/store/...-bash/bin/bash\",                    # builder\n  [\"--\", \"-e\", \"...\"],                               # arguments\n  [(\"key\",\"value\"), ...]                             # environment\n)\n</code></pre>"},{"location":"internals/derivations/#fields","title":"Fields","text":"# Field Type Description 1 outputs <code>[(name, path, hashAlgo, hash)]</code> Output name-to-path mapping 2 inputDrvs <code>[(drvPath, [outputNames])]</code> Derivation dependencies 3 inputSrcs <code>[path]</code> Source file dependencies 4 platform <code>string</code> Build platform (e.g. <code>x86_64-linux</code>) 5 builder <code>string</code> Path to the builder executable 6 args <code>[string]</code> Builder command-line arguments 7 env <code>[(key, value)]</code> Environment variables for the builder"},{"location":"internals/derivations/#outputs","title":"Outputs","text":"<p>Each output is a 4-tuple:</p> <pre><code>(\"name\", \"path\", \"hashAlgo\", \"hash\")\n</code></pre> Field Normal output Fixed-output <code>name</code> <code>\"out\"</code>, <code>\"lib\"</code>, <code>\"dev\"</code>, etc. <code>\"out\"</code> <code>path</code> <code>/nix/store/...-name</code> <code>/nix/store/...-name</code> <code>hashAlgo</code> <code>\"\"</code> <code>\"sha256\"</code>, <code>\"r:sha256\"</code>, etc. <code>hash</code> <code>\"\"</code> hex hash of expected content <p>The <code>r:</code> prefix in <code>hashAlgo</code> means recursive (NAR hash). Without it, the hash is of the flat file content.</p>"},{"location":"internals/derivations/#string-escaping","title":"String escaping","text":"<p>Strings in ATerm use these escape sequences:</p> Escape Character <code>\\\\</code> Backslash <code>\\\"</code> Double quote <code>\\n</code> Newline <code>\\r</code> Carriage return <code>\\t</code> Tab"},{"location":"internals/derivations/#ordering","title":"Ordering","text":"<p>In the canonical serialization:</p> <ul> <li>Outputs are sorted by output name</li> <li>Input derivations are sorted by <code>.drv</code> path</li> <li>Input sources are sorted</li> <li>Environment variables are sorted by key</li> <li>Arguments preserve their original order</li> </ul>"},{"location":"internals/derivations/#hashderivationmodulo","title":"<code>hashDerivationModulo</code>","text":"<p>This is the algorithm Nix uses to compute the hash that determines output paths. It exists to break circular dependencies \u2014 an output path depends on the derivation hash, but the derivation contains its own output paths.</p>"},{"location":"internals/derivations/#fixed-output-derivations","title":"Fixed-output derivations","text":"<p>For derivations with a single output <code>\"out\"</code> that has a <code>hashAlgo</code> set:</p> <pre><code>hash = sha256(\"fixed:out:&lt;hashAlgo&gt;:&lt;hashValue&gt;:\")\n</code></pre> <p>This means fixed-output derivations have stable hashes that don't change when their build dependencies change \u2014 only the expected output hash matters.</p>"},{"location":"internals/derivations/#regular-derivations","title":"Regular derivations","text":"<p>For all other derivations:</p> <ol> <li>Optionally blank output paths: Replace output paths with <code>\"\"</code> in both <code>.outputs</code> and <code>.env</code> (see two modes below)</li> <li>Replace input drv paths: For each input derivation, replace the <code>.drv</code> path with the hex-encoded <code>hashDerivationModulo</code> of that input</li> <li>Serialize: Convert the masked derivation back to ATerm</li> <li>Hash: <code>sha256(serialized_masked_drv)</code></li> </ol> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Original .drv                           \u2502\n\u2502                                         \u2502\n\u2502 outputs: (\"out\", \"/nix/store/abc-x\")    \u2502\n\u2502 inputDrvs: (\"/nix/store/def.drv\",[\"out\"])\u2502\n\u2502 ...                                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                   \u2502\n            mask &amp; replace\n                   \u2502\n                   v\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Masked .drv                             \u2502\n\u2502                                         \u2502\n\u2502 outputs: (\"out\", \"\")        \u2190 blanked   \u2502\n\u2502 inputDrvs: (\"a1b2c3...\",[\"out\"]) \u2190 hash \u2502\n\u2502 ...                                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                   \u2502\n            serialize to ATerm string\n                   \u2502\n                   v\n            sha256(aterm_string)\n                   \u2502\n                   v\n           derivation hash (32 bytes)\n</code></pre>"},{"location":"internals/derivations/#two-modes-maskoutputs","title":"Two modes: <code>maskOutputs</code>","text":"<p><code>hashDerivationModulo</code> takes a <code>maskOutputs</code> parameter that controls whether output paths are blanked. Nix uses two different call sites:</p> Call site <code>maskOutputs</code> Output paths Used for <code>staticOutputHashes</code> <code>true</code> blanked (<code>\"\"</code>) Computing a derivation's own output paths <code>pathDerivationModulo</code> <code>false</code> kept Computing the hash of an input derivation <p>This distinction matters: when derivation A depends on derivation B, Nix computes B's hash with <code>maskOutputs=false</code> \u2014 B's filled output paths are part of the hash used as A's <code>inputDrvs</code> key. Only A's own outputs are blanked (to break A's circularity).</p> <pre><code>Computing output path for consumer.drv:\n\n  dep.drv (input)                consumer.drv (self)\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  maskOutputs = false            maskOutputs = true\n  output paths KEPT              output paths BLANKED\n         \u2502                              \u2502\n         v                              v\n    dep_hash (includes             consumer_hash\n    dep's output path)                  \u2502\n         \u2502                              v\n         \u2514\u2500\u2500\u2500\u2500 used as \u2500\u2500\u2500\u2500\u2500\u2500&gt; inputDrvs key\n                               in consumer's masked ATerm\n</code></pre> <p>Common pitfall</p> <p>Using <code>maskOutputs=true</code> for input derivations produces the wrong hash \u2014 the input's output path is lost, changing the consumer's <code>inputDrvs</code> key and ultimately its output path. This is the difference between <code>staticOutputHashes</code> (for self) and <code>pathDerivationModulo</code> (for inputs).</p>"},{"location":"internals/derivations/#computing-output-paths","title":"Computing output paths","text":"<p>Once you have the derivation hash from <code>hashDerivationModulo</code>:</p> <pre><code>from pix.store_path import make_output_path\n\noutput_path = make_output_path(drv_hash, \"out\", \"hello-2.12.2\")\n# /nix/store/&lt;hash&gt;-hello-2.12.2\n</code></pre> <p>The type prefix is <code>output:&lt;output-name&gt;</code>, so the fingerprint becomes:</p> <pre><code>output:out:sha256:&lt;hex(drv_hash)&gt;:/nix/store:hello-2.12.2\n</code></pre>"},{"location":"internals/derivations/#real-world-example","title":"Real-world example","text":"<p>A minimal derivation (<code>builtins.derivation { name = \"hello\"; builder = \"/bin/sh\"; args = [\"-c\" \"echo hello &gt; $out\"]; system = \"x86_64-linux\"; }</code>):</p> <pre><code>Derive(\n  [(\"out\",\"/nix/store/...-hello\",\"\",\"\")],\n  [],\n  [],\n  \"x86_64-linux\",\n  \"/bin/sh\",\n  [\"-c\",\"echo hello &gt; $out\"],\n  [(\"builder\",\"/bin/sh\"),\n   (\"name\",\"hello\"),\n   (\"out\",\"/nix/store/...-hello\"),\n   (\"system\",\"x86_64-linux\")]\n)\n</code></pre> <p>Note that the environment contains both explicit env vars and automatic ones (<code>builder</code>, <code>out</code>, <code>system</code>, <code>name</code>).</p>"},{"location":"internals/nar-format/","title":"NAR Wire Format","text":"<p>NAR (Nix Archive) is a deterministic archive format used by Nix to serialize filesystem trees. Its key property is reproducibility \u2014 the same filesystem content always produces the same byte sequence, regardless of timestamps, ownership, inode numbers, or other metadata.</p>"},{"location":"internals/nar-format/#wire-primitives","title":"Wire primitives","text":"<p>All data is framed using a single primitive:</p>"},{"location":"internals/nar-format/#stringblob-encoding","title":"String/blob encoding","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 uint64_le(len)   \u2502 raw bytes (len)    \u2502 zero padding\u2502\n\u2502 (8 bytes)        \u2502                    \u2502 to 8-byte   \u2502\n\u2502                  \u2502                    \u2502 boundary    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <ul> <li>Length is always a little-endian uint64 (8 bytes)</li> <li>Content follows immediately after the length</li> <li>Padding: <code>(8 - len % 8) % 8</code> zero bytes to reach 8-byte alignment</li> <li>Empty strings: length = 0, no content bytes, no padding</li> </ul> <p>Examples:</p> String Length (hex LE) Content Padding Total <code>\"\"</code> <code>00 00 00 00 00 00 00 00</code> (none) (none) 8 bytes <code>\"(\"</code> <code>01 00 00 00 00 00 00 00</code> <code>28</code> 7 zeros 16 bytes <code>\"type\"</code> <code>04 00 00 00 00 00 00 00</code> <code>74 79 70 65</code> 4 zeros 16 bytes <code>\"regular\"</code> <code>07 00 00 00 00 00 00 00</code> <code>72 65 67 75 6c 61 72</code> 1 zero 16 bytes <code>\"hello\"</code> <code>05 00 00 00 00 00 00 00</code> <code>68 65 6c 6c 6f</code> 3 zeros 16 bytes <p>Every token in NAR \u2014 keywords, names, content blobs \u2014 uses this same encoding.</p>"},{"location":"internals/nar-format/#grammar","title":"Grammar","text":"<pre><code>nar         = str(\"nix-archive-1\") node\n\nnode        = str(\"(\") entry str(\")\")\n\nentry       = str(\"type\") (regular | symlink | directory)\n\nregular     = str(\"regular\") [str(\"executable\") str(\"\")]\n              str(\"contents\") str(&lt;file-data&gt;)\n\nsymlink     = str(\"symlink\") str(\"target\") str(&lt;target-path&gt;)\n\ndirectory   = str(\"directory\") { dir_entry }\n\ndir_entry   = str(\"entry\") str(\"(\")\n              str(\"name\") str(&lt;entry-name&gt;)\n              str(\"node\") node\n              str(\")\")\n</code></pre> <p>Where <code>str(x)</code> is the wire encoding described above.</p>"},{"location":"internals/nar-format/#file-types","title":"File types","text":""},{"location":"internals/nar-format/#regular-file","title":"Regular file","text":"<pre><code>str(\"(\")\n  str(\"type\") str(\"regular\")\n  [str(\"executable\") str(\"\")]     \u2190 only if executable bit is set\n  str(\"contents\") str(&lt;data&gt;)\nstr(\")\")\n</code></pre> <p>The executable flag is the only permission information preserved. Mode bits like <code>0644</code> vs <code>0755</code> are reduced to just executable-or-not.</p>"},{"location":"internals/nar-format/#symlink","title":"Symlink","text":"<pre><code>str(\"(\")\n  str(\"type\") str(\"symlink\")\n  str(\"target\") str(&lt;target&gt;)\nstr(\")\")\n</code></pre> <p>The target is stored as-is (not resolved). Relative and absolute symlinks are both supported.</p>"},{"location":"internals/nar-format/#directory","title":"Directory","text":"<pre><code>str(\"(\")\n  str(\"type\") str(\"directory\")\n  str(\"entry\") str(\"(\")\n    str(\"name\") str(\"a.txt\")\n    str(\"node\") &lt;recursive node for a.txt&gt;\n  str(\")\")\n  str(\"entry\") str(\"(\")\n    str(\"name\") str(\"b.txt\")\n    str(\"node\") &lt;recursive node for b.txt&gt;\n  str(\")\")\nstr(\")\")\n</code></pre> <p>Entries must be sorted</p> <p>Directory entries must be sorted lexicographically by name. This is critical for determinism.</p>"},{"location":"internals/nar-format/#what-nar-preserves","title":"What NAR preserves","text":"Preserved Not preserved File contents Timestamps (mtime, ctime, atime) File type (regular, symlink, directory) Ownership (uid, gid) Executable bit Permission mode (beyond +x) Symlink targets Inode numbers Directory structure Extended attributes Entry names Hard links (serialized as separate files)"},{"location":"internals/nar-format/#worked-example","title":"Worked example","text":"<p>NAR serialization of a file containing <code>\"hello\"</code> (5 bytes, not executable):</p> <pre><code>Offset  Bytes                           Meaning\n------  -----                           -------\n0x00    0e 00 00 00 00 00 00 00         length of \"nix-archive-1\" = 14\n0x08    6e 69 78 2d 61 72 63 68         \"nix-arch\"\n0x10    69 76 65 2d 31 00 00 00         \"ive-1\" + 2 bytes padding\n0x18    01 00 00 00 00 00 00 00         length of \"(\" = 1\n0x20    28 00 00 00 00 00 00 00         \"(\" + 7 bytes padding\n0x28    04 00 00 00 00 00 00 00         length of \"type\" = 4\n0x30    74 79 70 65 00 00 00 00         \"type\" + 4 bytes padding\n0x38    07 00 00 00 00 00 00 00         length of \"regular\" = 7\n0x40    72 65 67 75 6c 61 72 00         \"regular\" + 1 byte padding\n0x48    08 00 00 00 00 00 00 00         length of \"contents\" = 8\n0x50    63 6f 6e 74 65 6e 74 73         \"contents\" (no padding needed)\n0x58    05 00 00 00 00 00 00 00         length of content = 5\n0x60    68 65 6c 6c 6f 00 00 00         \"hello\" + 3 bytes padding\n0x68    01 00 00 00 00 00 00 00         length of \")\" = 1\n0x70    29 00 00 00 00 00 00 00         \")\" + 7 bytes padding\n\nTotal: 120 bytes\nSHA-256: 0a430879c266f8b57f4092a0f935cf3facd48bbccde5760d4748ca4051716969\n</code></pre> <p>This matches the output of <code>nix hash path</code> for a file containing <code>\"hello\"</code>.</p>"},{"location":"internals/store-paths/","title":"Store Path Computation","text":"<p>A Nix store path is a string of the form:</p> <pre><code>/nix/store/&lt;hash&gt;-&lt;name&gt;\n</code></pre> <p>where <code>&lt;hash&gt;</code> is exactly 32 characters of Nix base32, encoding a 160-bit (20-byte) hash.</p>"},{"location":"internals/store-paths/#algorithm","title":"Algorithm","text":"<pre><code>                              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n  content \u2500\u2500\u2500\u2500 sha256 \u2500\u2500\u2500\u2500\u2500\u2500&gt; \u2502  inner   \u2502\n  (or NAR hash for source)    \u2502  hash    \u2502\n                              \u2502 (32 B)   \u2502\n                              \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n                                   \u2502\n                                   v\n  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n  \u2502 fingerprint string:                                \u2502\n  \u2502 \"&lt;type&gt;:sha256:&lt;hex(inner_hash)&gt;:/nix/store:&lt;name&gt;\"\u2502\n  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          \u2502\n                      sha256\n                          \u2502\n                          v\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502 32 bytes \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2502\n                  XOR-fold to 20 bytes\n                         \u2502\n                         v\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502 20 bytes \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2502\n                  Nix base32 encode\n                         \u2502\n                         v\n      /nix/store/&lt;32 chars&gt;-&lt;name&gt;\n</code></pre>"},{"location":"internals/store-paths/#type-prefixes","title":"Type prefixes","text":"<p>The <code>&lt;type&gt;</code> in the fingerprint determines what kind of store object this path refers to.</p>"},{"location":"internals/store-paths/#text-text-files","title":"<code>text</code> \u2014 Text files","text":"<p>Used by <code>builtins.toFile</code> and <code>pkgs.writeText</code>. The inner hash is <code>sha256(content)</code>.</p> <pre><code>text:sha256:&lt;hex&gt;:/nix/store:&lt;name&gt;\n</code></pre> <p>With references (the text file depends on other store paths):</p> <pre><code>text:/nix/store/...-dep1:/nix/store/...-dep2:sha256:&lt;hex&gt;:/nix/store:&lt;name&gt;\n</code></pre> <p>References are sorted and appended with <code>:</code> separators. When there are no references, the type is just <code>text</code> \u2014 no trailing colon.</p>"},{"location":"internals/store-paths/#source-source-paths","title":"<code>source</code> \u2014 Source paths","text":"<p>Used by <code>builtins.path</code>, <code>builtins.filterSource</code>, and bare path imports (<code>./foo</code>). The inner hash is the SHA-256 of the NAR serialization.</p> <pre><code>source:sha256:&lt;hex&gt;:/nix/store:&lt;name&gt;\n</code></pre> <p>Can also have references (self-references for paths that contain their own store path):</p> <pre><code>source:/nix/store/...-self:sha256:&lt;hex&gt;:/nix/store:&lt;name&gt;\n</code></pre>"},{"location":"internals/store-paths/#outputname-derivation-outputs","title":"<code>output:&lt;name&gt;</code> \u2014 Derivation outputs","text":"<p>Used for the outputs of non-fixed-output derivations. The inner hash comes from <code>hashDerivationModulo</code>.</p> <pre><code>output:out:sha256:&lt;hex&gt;:/nix/store:&lt;name&gt;\n</code></pre> <p>For multi-output derivations:</p> <pre><code>output:lib:sha256:&lt;hex&gt;:/nix/store:&lt;name&gt;\noutput:dev:sha256:&lt;hex&gt;:/nix/store:&lt;name&gt;\n</code></pre>"},{"location":"internals/store-paths/#fixed-output-derivations","title":"Fixed-output derivations","text":"<p>Fixed-output derivations (like <code>fetchurl</code>) use a two-step process:</p> <ol> <li>Compute an intermediate descriptor: <code>fixed:out:&lt;method&gt;&lt;algo&gt;:&lt;hex&gt;:</code></li> <li>Hash that descriptor: <code>inner_hash = sha256(descriptor)</code></li> <li>Use <code>output:out</code> as the type</li> </ol> <p>Exception: <code>recursive</code> + <code>sha256</code> is treated as a source path directly (same as <code>make_source_store_path</code>).</p>"},{"location":"internals/store-paths/#name-constraints","title":"Name constraints","text":"<p>Store object names must:</p> <ul> <li>Not be empty</li> <li>Not start with <code>.</code></li> <li>Contain only: <code>a-z A-Z 0-9 + - . _ ? =</code></li> <li>Not exceed 211 characters</li> </ul>"},{"location":"internals/store-paths/#worked-example","title":"Worked example","text":"<p>Computing the store path for <code>builtins.toFile \"hello.txt\" \"hello\"</code>:</p> <pre><code>from pix.hash import sha256, compress_hash\nfrom pix.base32 import encode\n\ncontent = b\"hello\"\n\n# Step 1: inner hash\ninner = sha256(content)\n# 2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824\n\n# Step 2: fingerprint\nfp = f\"text:sha256:{inner.hex()}:/nix/store:hello.txt\"\n# text:sha256:2cf24dba...938b9824:/nix/store:hello.txt\n\n# Step 3: hash the fingerprint\nfp_hash = sha256(fp.encode())\n\n# Step 4: compress\ncompressed = compress_hash(fp_hash, 20)\n\n# Step 5: encode\nencoded = encode(compressed)  # 32 chars\n\n# Step 6: assemble\npath = f\"/nix/store/{encoded}-hello.txt\"\n</code></pre>"},{"location":"ko/","title":"pix","text":"<p>\uc77d\uae30 \uc26c\uc6b4 Python\uc73c\ub85c Nix \ub0b4\ubd80 \uad6c\uc870\ub97c \ud0d0\uad6c\ud569\ub2c8\ub2e4.</p> <p>Nix\uc758 \ud575\uc2ec \uc54c\uace0\ub9ac\uc998 \u2014 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c \ud574\uc2f1, NAR \uc9c1\ub82c\ud654, derivation \ud30c\uc2f1, \ub370\ubaac \uc640\uc774\uc5b4 \ud504\ub85c\ud1a0\ucf5c \u2014 \uc740 \uc218\uc2ed \uac1c\uc758 C++ \uc18c\uc2a4 \ud30c\uc77c\uc5d0 \uac78\uccd0 \ubb3b\ud600 \uc788\uc2b5\ub2c8\ub2e4. pix\ub294 \uac01\uac01\uc744 \uac04\uacb0\ud55c Python\uc73c\ub85c \uc7ac\uad6c\ud604\ud558\uc5ec \ub85c\uc9c1\uc744 \uc9c1\uc811 \uc77d\uace0, \uc218\uc815\ud558\uace0, \ud55c \uc904\uc529 \ub530\ub77c\uac08 \uc218 \uc788\uac8c \ud569\ub2c8\ub2e4.</p> <p>\ubaa8\ub4e0 \ubaa8\ub4c8\uc740 \uc2e4\uc81c <code>nix</code> CLI\uc640 \ub3d9\uc77c\ud55c \ucd9c\ub825\uc744 \uc0dd\uc131\ud558\uba70, \ud14c\uc2a4\ud2b8 \uc2a4\uc704\ud2b8\ub85c \uac80\uc99d\ub429\ub2c8\ub2e4. \ucf54\ub4dc \uc790\uccb4\uac00 \ubb38\uc11c\uc774\uace0, \uc774 \ud398\uc774\uc9c0\ub4e4\uc740 \uadf8\uc5d0 \ub300\ud55c \ud574\uc124\uc785\ub2c8\ub2e4.</p>"},{"location":"ko/#nix","title":"Nix \ub0b4\ubd80\uc5d0\ub294 \ubb34\uc5c7\uc774 \uc788\ub294\uac00","text":"<p><code>nix build</code>\ub97c \uc2e4\ud589\ud558\uba74 \ub0b4\ubd80\uc801\uc73c\ub85c \ub9ce\uc740 \uc77c\uc774 \uc77c\uc5b4\ub0a9\ub2c8\ub2e4. pix\ub294 \uc774\ub97c \ud55c \ubc88\uc5d0 \ud558\ub098\uc529 \uc774\ud574\ud560 \uc218 \uc788\ub294 \uc870\uac01\uc73c\ub85c \ub098\ub215\ub2c8\ub2e4:</p> \uac1c\ub150 Nix\uac00 \ud558\ub294 \uc77c pix \ubaa8\ub4c8 \ubb38\uc11c Base32 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c \ud574\uc2dc\ub97c \uc704\ud55c \ucee4\uc2a4\ud140 \uc778\ucf54\ub529 \u2014 RFC 4648\uc774 \uc544\ub2d8 <code>base32.py</code> \ucc28\uc774\uc810 \ud574\uc2dc \uc555\ucd95 SHA-256 (32 B)\uc744 160\ube44\ud2b8 (20 B)\ub85c XOR-\ud3f4\ub4dc <code>hash.py</code> \uc2a4\ud1a0\uc5b4 \uacbd\ub85c \uacc4\uc0b0\uc5d0\uc11c NAR \uacb0\uc815\ub860\uc801 \uc544\uce74\uc774\ube0c \ud615\uc2dd \u2014 \ud0c0\uc784\uc2a4\ud0ec\ud504 \uc5c6\uc74c, uid \uc5c6\uc74c, \uc624\uc9c1 \ucf58\ud150\uce20\ub9cc <code>nar.py</code> \uc640\uc774\uc5b4 \ud615\uc2dd \uba85\uc138 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c \ud551\uac70\ud504\ub9b0\ud2b8 \ubb38\uc790\uc5f4\ub85c\ubd80\ud130 <code>/nix/store/&lt;hash&gt;-&lt;name&gt;</code> \uacc4\uc0b0 <code>store_path.py</code> \uc804\uccb4 \uc54c\uace0\ub9ac\uc998 Derivation ATerm \ud615\uc2dd\uc758 <code>.drv</code> \ud30c\uc77c; <code>hashDerivationModulo</code>\ub85c \uc21c\ud658 \uc758\uc874\uc131 \ud574\uacb0 <code>derivation.py</code> \ud615\uc2dd + \ud574\uc2f1 \ub370\ubaac \ud504\ub85c\ud1a0\ucf5c uint64-LE \ud504\ub808\uc774\ubc0d, stderr \ub85c\uadf8 \uc2a4\ud2b8\ub9bc, \uc624\ud37c\ub808\uc774\uc158 \uc635\ucf54\ub4dc\ub97c \uc0ac\uc6a9\ud558\ub294 Unix \uc18c\ucf13 <code>daemon.py</code> \ud504\ub85c\ud1a0\ucf5c \uba85\uc138"},{"location":"ko/#pixpkgs-pix","title":"pixpkgs \u2014 pix \uc704\uc5d0 \uc313\uae30","text":"<p>\ub0b4\ubd80 \uad6c\uc870\ub97c \uc774\ud574\ud588\ub2e4\uba74, pixpkgs\ub294 \uadf8 \uc704\uc5d0 nixpkgs \uc2a4\ud0c0\uc77c\uc758 \ud328\ud0a4\uc9c0 \uc138\ud2b8\ub97c \uad6c\ucd95\ud558\ub294 \ubc29\ubc95\uc744 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. Nix \ud328\ud134\uc744 Python \uad00\uc6a9\uad6c\ub85c \ub9e4\ud551\ud569\ub2c8\ub2e4:</p> Nix \ud328\ud134 Python \uad00\uc6a9\uad6c pixpkgs \ubaa8\ub4c8 <code>mkDerivation</code> <code>drv()</code> \ud568\uc218 \u2192 <code>Package</code> \ub370\uc774\ud130\ud074\ub798\uc2a4 <code>drv.py</code> <code>callPackage</code> <code>inspect.signature</code> + <code>getattr</code> <code>package_set.py</code> \ubb38\uc790\uc5f4 \ubcf4\uac04 (<code>${pkg}</code>) \ucd9c\ub825 \uacbd\ub85c\ub97c \ubc18\ud658\ud558\ub294 <code>__str__</code> <code>drv.py</code> <code>pkg.override</code> \ubcd1\ud569\ub41c kwargs\ub85c <code>drv()</code> \uc7ac\ud638\ucd9c <code>drv.py</code> <code>nix-store --realize</code> <code>realize()</code> \u2192 \ub370\ubaac <code>add_text_to_store</code> + <code>build_paths</code> <code>realize.py</code> <p>\uc790\uc138\ud55c \ub0b4\uc6a9\uc740 pixpkgs API \ub808\ud37c\ub7f0\uc2a4\ub97c \ucc38\uace0\ud558\uc138\uc694.</p>"},{"location":"ko/#_1","title":"\uc77d\ub294 \uc21c\uc11c","text":"<p>\ubaa8\ub4c8\ub4e4\uc740 \uc11c\ub85c \uc758\uc874\ud569\ub2c8\ub2e4. \uc544\ub798\uc5d0\uc11c\ubd80\ud130 \uc2dc\uc791\ud558\uc138\uc694:</p> <pre><code>pix (Nix \ub0b4\ubd80 \uad6c\uc870):\n  1. base32.py        \u2190 \uac00\uc7a5 \ub2e8\uc21c: \uc778\ucf54\ub529\ub9cc\n  2. hash.py          \u2190 \ud568\uc218 \ud558\ub098: XOR-\ud3f4\ub4dc\n  3. nar.py           \u2190 \uc9c1\ub82c\ud654 \ud615\uc2dd, hash \uc0ac\uc6a9\n  4. store_path.py    \u2190 \ud575\uc2ec \uc54c\uace0\ub9ac\uc998, base32 + hash \uc0ac\uc6a9\n  5. derivation.py    \u2190 \ud30c\uc2f1 + hashDerivationModulo \ud2b8\ub9ad\n  6. daemon.py        \u2190 \ub3c5\ub9bd\uc801: Unix \uc18c\ucf13 \uc640\uc774\uc5b4 \ud504\ub85c\ud1a0\ucf5c\n\npixpkgs (\ud328\ud0a4\uc9c0 \uc138\ud2b8 \ub808\uc774\uc5b4, pix \uc0ac\uc6a9):\n  7. drv.py           \u2190 drv() + Package: mkDerivation \ub4f1\uac00\ubb3c\n  8. package_set.py   \u2190 PackageSet.call(): callPackage \ub4f1\uac00\ubb3c\n  9. realize.py       \u2190 .drv\ub97c \uc2a4\ud1a0\uc5b4\uc5d0 \uc4f0\uace0 \ub370\ubaac\uc73c\ub85c \ube4c\ub4dc\n</code></pre> <p>\uac01 pix \ud30c\uc77c\uc740 \uc790\uccb4\uc801\uc73c\ub85c \uc644\uacb0\ub418\uba70 150\uc904 \ubbf8\ub9cc\uc785\ub2c8\ub2e4. \uc804\uccb4 \ucf54\ub4dc\ubca0\uc774\uc2a4\ub97c \ud55c \ubc88\uc5d0 \uc77d\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p>"},{"location":"ko/#_2","title":"\uc9c1\uc811 \ud574\ubcf4\uae30","text":"<pre><code>nix develop\n\n# pix\uac00 nix\uc640 \uc815\ud655\ud788 \uac19\uc740 \ud574\uc2dc\ub97c \uacc4\uc0b0\ud558\ub294\uc9c0 \ud655\uc778\npython -m pix hash-path ./pix/base32.py --base32\nnix hash path ./pix/base32.py --type sha256 --base32\n# \uac19\uc740 \ucd9c\ub825\n\n# \uc2a4\ud1a0\uc5b4 \uacbd\ub85c \uacc4\uc0b0 \ud6c4 \ub370\ubaac\uc744 \ud1b5\ud574 \uac80\uc99d\npython -m pix store-path ./pix --name pix-source\npython -m pix add-text hello.txt \"hello world\"\npython -m pix drv-show /nix/store/...-hello.drv\n</code></pre>"},{"location":"ko/#_3","title":"\uac80\uc99d","text":"<pre><code>pytest tests/ pixpkgs/tests/ -v   # 41\uac1c \ud14c\uc2a4\ud2b8, \ubaa8\ub450 \uc2e4\uc81c nix\uc640 \ube44\uad50\n</code></pre>"},{"location":"ko/#_4","title":"\uc774 \ubb38\uc11c \uc0ac\uc6a9\ubc95","text":"<ul> <li>\ub0b4\ubd80 \uad6c\uc870 \u2014 \uc5ec\uae30\uc11c \uc2dc\uc791\ud558\uc138\uc694. \ub2e4\uc774\uc5b4\uadf8\ub7a8, \ud5e5\uc2a4 \ub364\ud504, \ud504\ub85c\ud1a0\ucf5c \ud2b8\ub808\uc774\uc2a4\uc640 \ud568\uaed8 Nix\uac00 \uc5b4\ub5bb\uac8c \ub3d9\uc791\ud558\ub294\uc9c0 \uc124\uba85\ud569\ub2c8\ub2e4.</li> <li>API \ub808\ud37c\ub7f0\uc2a4 \u2014 \uac01 \ubaa8\ub4c8\uc758 \ud568\uc218 \uc2dc\uadf8\ub2c8\ucc98\uc640 \uc0ac\uc6a9 \uc608\uc81c.</li> <li>CLI \ub808\ud37c\ub7f0\uc2a4 \u2014 \ube60\ub978 \uc2e4\ud5d8\uc744 \uc704\ud55c <code>python -m pix</code> \uba85\ub839\uc5b4.</li> </ul>"},{"location":"ko/cli/","title":"CLI \ub808\ud37c\ub7f0\uc2a4","text":"<p>pix\ub97c Python \ubaa8\ub4c8\ub85c \uc2e4\ud589\ud569\ub2c8\ub2e4:</p> <pre><code>python -m pix &lt;command&gt; [options]\n</code></pre>"},{"location":"ko/cli/#_1","title":"\uba85\ub839\uc5b4","text":""},{"location":"ko/cli/#hash-path-nar","title":"<code>hash-path</code> \u2014 \uacbd\ub85c\uc758 NAR \ud574\uc2dc","text":"<p>\ud30c\uc77c \ub610\ub294 \ub514\ub809\ud130\ub9ac\uc758 NAR \uc9c1\ub82c\ud654\uc5d0 \ub300\ud55c SHA-256 \ud574\uc2dc\ub97c \uacc4\uc0b0\ud569\ub2c8\ub2e4. <code>nix hash path</code>\uc640 \ub3d9\uc77c\ud569\ub2c8\ub2e4.</p> <pre><code>python -m pix hash-path &lt;path&gt; [--base32]\n</code></pre> \ud50c\ub798\uadf8 \uc124\uba85 <code>--base32</code> 16\uc9c4\uc218 \ub300\uc2e0 Nix base32\ub85c \ucd9c\ub825 <p>\uc608\uc81c:</p> <pre><code>$ python -m pix hash-path ./pix/base32.py\nsha256:0a43087...\n\n$ python -m pix hash-path ./pix/base32.py --base32\nsha256:1l1a9cfyhln3s40sb9b2w2h4z8p3566xkbs84vk819h3107ahkvl\n\n$ python -m pix hash-path ./my-directory --base32\nsha256:1vrbglcwc4gpln263rg69jq6vgq8p3ibspdg7lzyxcyc0ryg5wn2\n</code></pre> <p>\ucc38\uace0</p> <p><code>hash-path</code>\ub294 \uc6d0\uc2dc \ud30c\uc77c \ubc14\uc774\ud2b8\uac00 \uc544\ub2c8\ub77c NAR \uc9c1\ub82c\ud654\ub97c \ud574\uc2f1\ud569\ub2c8\ub2e4. \ud30c\uc77c \ud0c0\uc785 \uba54\ud0c0\ub370\uc774\ud130\uc640 \ub514\ub809\ud130\ub9ac\uc758 \uacbd\uc6b0 \uc815\ub82c\ub41c \uc5d4\ud2b8\ub9ac \uc774\ub984\uc774 \ud3ec\ud568\ub429\ub2c8\ub2e4. \uc6d0\uc2dc \ucf58\ud150\uce20 \ud574\uc2f1\uc5d0\ub294 <code>hash-file</code>\uc744 \uc0ac\uc6a9\ud558\uc138\uc694.</p>"},{"location":"ko/cli/#hash-file-sha-256","title":"<code>hash-file</code> \u2014 \ud30c\uc77c\uc758 \ud50c\ub7ab SHA-256","text":"<p>\ud30c\uc77c\uc758 \uc6d0\uc2dc \ubc14\uc774\ud2b8\ub97c \ud574\uc2f1\ud569\ub2c8\ub2e4 (NAR \ub798\ud551 \uc5c6\uc74c). <code>nix hash file</code>\uacfc \ub3d9\uc77c\ud569\ub2c8\ub2e4.</p> <pre><code>python -m pix hash-file &lt;path&gt; [--base32]\n</code></pre> <p>\uc608\uc81c:</p> <pre><code>$ echo -n \"hello\" &gt; /tmp/hello.txt\n$ python -m pix hash-file /tmp/hello.txt --base32\nsha256:094qif9n4cq4fdg459qzbhg1c6wywawwaaivx0k0x8xhbyx4vwic\n</code></pre>"},{"location":"ko/cli/#store-path","title":"<code>store-path</code> \u2014 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c \uacc4\uc0b0","text":"<p>\ub85c\uceec \ud30c\uc77c \ub610\ub294 \ub514\ub809\ud130\ub9ac\uc758 Nix \uc2a4\ud1a0\uc5b4 \uacbd\ub85c\ub97c \uacc4\uc0b0\ud569\ub2c8\ub2e4. <code>builtins.path</code>\ub098 <code>filterSource</code>\ub97c \ud1b5\ud574 \ucd94\uac00\ub41c \uac83\ucc98\ub7fc \uacc4\uc0b0\ud569\ub2c8\ub2e4.</p> <pre><code>python -m pix store-path &lt;path&gt; [--name NAME]\n</code></pre> \ud50c\ub798\uadf8 \uc124\uba85 <code>--name</code> \uc2a4\ud1a0\uc5b4 \uac1d\uccb4 \uc774\ub984 \uc9c0\uc815 (\uae30\ubcf8\uac12: \uacbd\ub85c\uc758 basename) <p>\uc608\uc81c:</p> <pre><code>$ python -m pix store-path ./my-source\n/nix/store/pagr3c3r57k8h9zqhb89cqihhc9sbz03-my-source\n\n$ python -m pix store-path ./my-source --name custom-name\n/nix/store/abc123...-custom-name\n</code></pre>"},{"location":"ko/cli/#drv-show-drv-json","title":"<code>drv-show</code> \u2014 <code>.drv</code>\ub97c JSON\uc73c\ub85c \ud30c\uc2f1","text":"<p>Nix \uc2a4\ud1a0\uc5b4\uc758 <code>.drv</code> \ud30c\uc77c\uc744 \ud30c\uc2f1\ud558\uc5ec \ud3ec\ub9f7\ub41c JSON\uc73c\ub85c \ud45c\uc2dc\ud569\ub2c8\ub2e4. <code>nix derivation show</code>\uc640 \ub3d9\uc77c\ud569\ub2c8\ub2e4.</p> <pre><code>python -m pix drv-show &lt;drv-path&gt;\n</code></pre> <p>\uc608\uc81c:</p> <pre><code>$ python -m pix drv-show /nix/store/...-hello-2.12.2.drv\n{\n  \"outputs\": {\n    \"out\": {\n      \"path\": \"/nix/store/...-hello-2.12.2\",\n      \"hashAlgo\": \"\",\n      \"hash\": \"\"\n    }\n  },\n  \"inputDrvs\": {\n    \"/nix/store/...-bash.drv\": [\"out\"],\n    \"/nix/store/...-stdenv.drv\": [\"out\"]\n  },\n  \"inputSrcs\": [\"/nix/store/...-default-builder.sh\"],\n  \"platform\": \"x86_64-linux\",\n  \"builder\": \"/nix/store/...-bash/bin/bash\",\n  \"args\": [\"-e\", \"/nix/store/...-default-builder.sh\"],\n  \"env\": {\"name\": \"hello\", \"version\": \"2.12.2\", ...}\n}\n</code></pre>"},{"location":"ko/cli/#path-info","title":"<code>path-info</code> \u2014 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c \uc815\ubcf4 \uc870\ud68c","text":"<p>Nix \ub370\ubaac\uc5d0\uc11c \uc2a4\ud1a0\uc5b4 \uacbd\ub85c\uc758 \uba54\ud0c0\ub370\uc774\ud130\ub97c \uc870\ud68c\ud569\ub2c8\ub2e4. \uc2e4\ud589 \uc911\uc778 \ub370\ubaac\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.</p> <pre><code>python -m pix path-info &lt;store-path&gt;\n</code></pre> <p>\uc608\uc81c:</p> <pre><code>$ python -m pix path-info /nix/store/...-hello-2.12.2\nderiver: /nix/store/...-hello-2.12.2.drv\nnar-hash: sha256:1abc...\nnar-size: 53856\nreferences: /nix/store/...-glibc /nix/store/...-hello-2.12.2\nsigs: cache.nixos.org-1:abc123...\n</code></pre>"},{"location":"ko/cli/#is-valid","title":"<code>is-valid</code> \u2014 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c \uc720\ud6a8\uc131 \ud655\uc778","text":"<p>\uc2a4\ud1a0\uc5b4 \uacbd\ub85c\uac00 \uc874\uc7ac\ud558\uace0 \uc720\ud6a8\ud55c\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4. \uc720\ud6a8\ud558\uba74 \uc885\ub8cc \ucf54\ub4dc 0, \uc544\ub2c8\uba74 1\uc744 \ubc18\ud658\ud569\ub2c8\ub2e4.</p> <pre><code>python -m pix is-valid &lt;store-path&gt;\n</code></pre> <p>\uc608\uc81c:</p> <pre><code>$ python -m pix is-valid /nix/store/...-hello-2.12.2\nvalid\n\n$ python -m pix is-valid /nix/store/aaaa...-nonexistent\ninvalid\n</code></pre>"},{"location":"ko/cli/#add-text","title":"<code>add-text</code> \u2014 \uc2a4\ud1a0\uc5b4\uc5d0 \ud14d\uc2a4\ud2b8 \ucd94\uac00","text":"<p>\ud14d\uc2a4\ud2b8 \ubb38\uc790\uc5f4\uc744 Nix \uc2a4\ud1a0\uc5b4\uc5d0 \ucd94\uac00\ud569\ub2c8\ub2e4. <code>builtins.toFile</code>\uacfc \uac19\uc2b5\ub2c8\ub2e4. content\uac00 <code>-</code>\uc774\uac70\ub098 \uc0dd\ub7b5\ub418\uba74 stdin\uc5d0\uc11c \uc77d\uc2b5\ub2c8\ub2e4.</p> <pre><code>python -m pix add-text &lt;name&gt; [content]\n</code></pre> <p>\uc608\uc81c:</p> <pre><code>$ python -m pix add-text hello.txt \"hello world\"\n/nix/store/qbfcv31xi1wjisxwl4b2nk1a8jqxbcf5-hello.txt\n\n$ echo \"from stdin\" | python -m pix add-text piped.txt\n/nix/store/...-piped.txt\n</code></pre>"},{"location":"ko/cli/#build","title":"<code>build</code> \u2014 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c \ube4c\ub4dc","text":"<p>Nix \ub370\ubaac\uc744 \ud1b5\ud574 \ud558\ub098 \uc774\uc0c1\uc758 derivation \ucd9c\ub825\uc744 \ube4c\ub4dc\ud569\ub2c8\ub2e4.</p> <pre><code>python -m pix build &lt;path&gt;...\n</code></pre> <p>\uc608\uc81c:</p> <pre><code>$ python -m pix build /nix/store/...-hello-2.12.2.drv^out\nbuild succeeded\n</code></pre>"},{"location":"ko/api/","title":"API \ub808\ud37c\ub7f0\uc2a4","text":"<p>\uac01 \ubaa8\ub4c8\uc740 \ud558\ub098\uc758 Nix \uac1c\ub150\uc744 \uc790\uccb4\uc801\uc73c\ub85c \uc644\uacb0\ub41c \ud615\ud0dc\ub85c \uad6c\ud604\ud569\ub2c8\ub2e4. \uc678\ubd80 \uc758\uc874\uc131 \uc5c6\uc774 \ud45c\uc900 \ub77c\uc774\ube0c\ub7ec\ub9ac\ub9cc \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p>"},{"location":"ko/api/#_1","title":"\ubaa8\ub4c8","text":"\ubaa8\ub4c8 \uc904 \uc218 \uad6c\ud604 \ub0b4\uc6a9 <code>pix.base32</code> ~40 Nix base32 \uc778\ucf54\ub529 \u2014 \ucee4\uc2a4\ud140 \uc54c\ud30c\ubcb3, \uc5ed\uc21c \ube44\ud2b8 \ucd94\ucd9c <code>pix.hash</code> ~20 SHA-256 \ub798\ud37c + XOR-\ud3f4\ub4dc \uc555\ucd95 <code>pix.nar</code> ~80 NAR \uc544\uce74\uc774\ube0c \uc9c1\ub82c\ud654 (\ud30c\uc77c, \ub514\ub809\ud130\ub9ac, \uc2ec\ub9c1\ud06c) <code>pix.store_path</code> ~70 text, source, fixed-output, derivation \ucd9c\ub825\uc758 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c \ud551\uac70\ud504\ub9b0\ud305 <code>pix.derivation</code> ~250 ATerm \ud30c\uc11c/\uc2dc\ub9ac\uc5bc\ub77c\uc774\uc800 + <code>hashDerivationModulo</code> <code>pix.daemon</code> ~270 Unix \uc18c\ucf13 \ud074\ub77c\uc774\uc5b8\ud2b8: \ud578\ub4dc\uc170\uc774\ud06c, stderr \ub4dc\ub808\uc774\ub2dd, \uc2a4\ud1a0\uc5b4 \uc624\ud37c\ub808\uc774\uc158"},{"location":"ko/api/#pixpkgs","title":"pixpkgs \ubaa8\ub4c8","text":"\ubaa8\ub4c8 \uc904 \uc218 \uad6c\ud604 \ub0b4\uc6a9 <code>pixpkgs.drv</code> ~140 <code>drv()</code> \uc0dd\uc131\uc790 + <code>Package</code> \ub370\uc774\ud130\ud074\ub798\uc2a4 \u2014 <code>mkDerivation</code> \ub4f1\uac00\ubb3c <code>pixpkgs.package_set</code> ~30 <code>call()</code>\uc744 \uac00\uc9c4 <code>PackageSet</code> \u2014 <code>callPackage</code> \ub4f1\uac00\ubb3c <code>pixpkgs.realize</code> ~30 <code>.drv</code>\ub97c \uc2a4\ud1a0\uc5b4\uc5d0 \uc4f0\uace0 \ub370\ubaac\uc73c\ub85c \ube4c\ub4dc"},{"location":"ko/api/#_2","title":"\uc758\uc874\uc131 \uadf8\ub798\ud504","text":"<pre><code>pixpkgs\n  drv \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 derivation + store_path\n  package_set     (\ub3c5\ub9bd\uc801 \u2014 inspect\ub9cc \uc0ac\uc6a9)\n  realize \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 daemon\n\npix\n  daemon  (\ub3c5\ub9bd\uc801 \u2014 \uc640\uc774\uc5b4 \ud504\ub85c\ud1a0\ucf5c\ub9cc)\n\n  store_path \u2500\u2500\u2500 hash\n      \u2502            \u2502\n      \u2514\u2500\u2500 base32   \u2502\n                   \u2502\n  nar \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n  derivation \u2500\u2500\u2500 hash\n</code></pre> <p>\uc21c\ud658 \uc758\uc874\uc131 \uc5c6\uc74c. <code>daemon</code>\uc740 \uc644\uc804\ud788 \ub3c5\ub9bd\uc801\uc785\ub2c8\ub2e4 \u2014 \ub85c\uceec \ud574\uc2dc \uacc4\uc0b0 \uc5c6\uc774 \ubc14\uc774\ub108\ub9ac \ud504\ub85c\ud1a0\ucf5c\uc744 \uc9c1\uc811 \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p>"},{"location":"ko/api/#_3","title":"\ucf54\ub4dc \uc77d\uae30","text":"<p>\ubaa8\ub4c8\ub4e4\uc740 \uc704\uc5d0\uc11c \uc544\ub798\ub85c \uc77d\ub3c4\ub85d \uc124\uacc4\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4. \uac01 \ud30c\uc77c\uc740 \ud615\uc2dd\uc774\ub098 \ud504\ub85c\ud1a0\ucf5c\uc744 \uc124\uba85\ud558\ub294 docstring\uc73c\ub85c \uc2dc\uc791\ud55c \ub2e4\uc74c, \uac00\uc7a5 \uc9c1\uad00\uc801\uc778 \ubc29\uc2dd\uc73c\ub85c \uad6c\ud604\ud569\ub2c8\ub2e4.</p> <p>\uc54c\uace0\ub9ac\uc998\uc774 \uc65c \uadf8\ub7f0 \ubc29\uc2dd\uc73c\ub85c \ub3d9\uc791\ud558\ub294\uc9c0 \uc774\ud574\ud558\ub824\uba74 \ub0b4\ubd80 \uad6c\uc870 \uc139\uc158\uc744 \ucc38\uace0\ud558\uc138\uc694. \uc5b4\ub5bb\uac8c \uad6c\ud604\ub418\uc5b4 \uc788\ub294\uc9c0 \ubcf4\ub824\uba74 \uc18c\uc2a4\ub97c \uc9c1\uc811 \uc77d\uc73c\uc138\uc694 \u2014 \uc804\ubd80 <code>pix/</code>\uc640 <code>pixpkgs/</code>\uc5d0 \uc788\uc2b5\ub2c8\ub2e4.</p>"},{"location":"ko/api/base32/","title":"pix.base32","text":"<p>Nix \uc804\uc6a9 base32 \uc778\ucf54\ub529 \ubc0f \ub514\ucf54\ub529.</p> <p>\uc8fc\uc758</p> <p>\uc774\uac83\uc740 RFC 4648 base32\uac00 \uc544\ub2d9\ub2c8\ub2e4. Nix\ub294 \ub2e4\ub978 \uc54c\ud30c\ubcb3\uacfc \ub2e4\ub978 \ube44\ud2b8 \ucd94\ucd9c \uc21c\uc11c\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4. \uc804\uccb4 \ube44\uad50\ub294 \ub0b4\ubd80 \uad6c\uc870: Base32\ub97c \ucc38\uace0\ud558\uc138\uc694.</p>"},{"location":"ko/api/base32/#_1","title":"\uc0c1\uc218","text":""},{"location":"ko/api/base32/#chars","title":"<code>CHARS</code>","text":"<pre><code>CHARS = \"0123456789abcdfghijklmnpqrsvwxyz\"\n</code></pre> <p>32\uc790\uc758 Nix base32 \uc54c\ud30c\ubcb3. \ube60\uc9c4 \ubb38\uc790: <code>e</code>, <code>o</code>, <code>t</code>, <code>u</code>.</p>"},{"location":"ko/api/base32/#_2","title":"\ud568\uc218","text":""},{"location":"ko/api/base32/#encodedata-bytes-str","title":"<code>encode(data: bytes) -&gt; str</code>","text":"<p>\ubc14\uc774\ud2b8\ub97c Nix base32 \ubb38\uc790\uc5f4\ub85c \uc778\ucf54\ub529\ud569\ub2c8\ub2e4.</p> <p>\ucd9c\ub825 \uae38\uc774: <code>n</code> \uc785\ub825 \ubc14\uc774\ud2b8\uc5d0 \ub300\ud574 <code>ceil(n * 8 / 5)</code> \ubb38\uc790.</p> \uc785\ub825 \ud06c\uae30 \ucd9c\ub825 \ud06c\uae30 \uc6a9\ub3c4 20 \ubc14\uc774\ud2b8 32 \ubb38\uc790 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c \ud574\uc2dc 32 \ubc14\uc774\ud2b8 52 \ubb38\uc790 SHA-256 \ub2e4\uc774\uc81c\uc2a4\ud2b8 <pre><code>from pix.base32 import encode\n\nencode(b\"\\x00\" * 20)\n# '00000000000000000000000000000000'\n\nimport hashlib\ndigest = hashlib.sha256(b\"hello\").digest()\nencode(digest)\n# '094qif9n4cq4fdg459qzbhg1c6wywawwaaivx0k0x8xhbyx4vwic'\n</code></pre>"},{"location":"ko/api/base32/#decodes-str-bytes","title":"<code>decode(s: str) -&gt; bytes</code>","text":"<p>Nix base32 \ubb38\uc790\uc5f4\uc744 \ubc14\uc774\ud2b8\ub85c \ub514\ucf54\ub529\ud569\ub2c8\ub2e4.</p> <p>\uc608\uc678: \ubb38\uc790\uc5f4\uc5d0 Nix base32 \uc54c\ud30c\ubcb3\uc5d0 \uc5c6\ub294 \ubb38\uc790\uac00 \ud3ec\ud568\ub418\uba74 <code>ValueError</code> \ubc1c\uc0dd.</p> <pre><code>from pix.base32 import decode\n\ndecode(\"094qif9n4cq4fdg459qzbhg1c6wywawwaaivx0k0x8xhbyx4vwic\")\n# b',\\xf2M\\xba_\\xb0\\xa3\\x0e&amp;\\xe8;*\\xc5\\xb9\\xe2\\x9e\\x1b\\x16\\x1e\\\\\\x1f\\xa7B^s\\x043b\\x93\\x8b\\x98$'\n\ndecode(\"00000000000000000000000000000000\")\n# b'\\x00' * 20\n</code></pre>"},{"location":"ko/api/base32/#_3","title":"\uc655\ubcf5 \ubcc0\ud658","text":"<p>encode\uc640 decode\ub294 \uc5ed\uc5f0\uc0b0\uc785\ub2c8\ub2e4:</p> <pre><code>from pix.base32 import encode, decode\n\ndata = b\"any bytes here\"\nassert decode(encode(data)) == data\n</code></pre>"},{"location":"ko/api/daemon/","title":"pix.daemon","text":"<p>Nix \ub370\ubaac Unix \uc18c\ucf13 \ud074\ub77c\uc774\uc5b8\ud2b8. <code>/nix/var/nix/daemon-socket/socket</code>\uc744 \ud1b5\ud574 Nix \uc6cc\ucee4 \ud504\ub85c\ud1a0\ucf5c\ub85c \ud1b5\uc2e0\ud569\ub2c8\ub2e4.</p> <p>\ud504\ub85c\ud1a0\ucf5c \uc0c1\uc138\ub294 \ub0b4\ubd80 \uad6c\uc870: \ub370\ubaac \ud504\ub85c\ud1a0\ucf5c\uc744 \ucc38\uace0\ud558\uc138\uc694.</p>"},{"location":"ko/api/daemon/#_1","title":"\ud074\ub798\uc2a4","text":""},{"location":"ko/api/daemon/#daemonconnection","title":"<code>DaemonConnection</code>","text":"<p>Nix \ub370\ubaac \uc5f0\uacb0\uc744 \uc704\ud55c \ucee8\ud14d\uc2a4\ud2b8 \ub9e4\ub2c8\uc800.</p> <pre><code>from pix.daemon import DaemonConnection\n\nwith DaemonConnection() as conn:\n    # conn \uc0ac\uc6a9...\n    pass\n\n# \ub610\ub294 \ucee4\uc2a4\ud140 \uc18c\ucf13 \uacbd\ub85c:\nwith DaemonConnection(\"/custom/socket/path\") as conn:\n    pass\n</code></pre> <p>\uc0dd\uc131\uc790:</p> <pre><code>DaemonConnection(socket_path: str | None = None)\n</code></pre> \ub9e4\uac1c\ubcc0\uc218 \uae30\ubcf8\uac12 \uc124\uba85 <code>socket_path</code> <code>/nix/var/nix/daemon-socket/socket</code> Unix \uc18c\ucf13 \uacbd\ub85c <p>\uc18d\uc131:</p> \uc18d\uc131 \ud0c0\uc785 \uc124\uba85 <code>daemon_version</code> <code>int</code> \ud578\ub4dc\uc170\uc774\ud06c \ud6c4 \ud504\ub85c\ud1a0\ucf5c \ubc84\uc804 (\uc608: <code>293</code> = 1.37)"},{"location":"ko/api/daemon/#_2","title":"\uc624\ud37c\ub808\uc774\uc158","text":""},{"location":"ko/api/daemon/#is_valid_pathpath-str-bool","title":"<code>is_valid_path(path: str) -&gt; bool</code>","text":"<p>\uc2a4\ud1a0\uc5b4 \uacbd\ub85c\uac00 Nix \uc2a4\ud1a0\uc5b4\uc5d0 \uc874\uc7ac\ud558\uace0 \uc720\ud6a8\ud55c\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p> <pre><code>with DaemonConnection() as conn:\n    conn.is_valid_path(\"/nix/store/...-hello-2.12.2\")  # True\n    conn.is_valid_path(\"/nix/store/aaaa...-nope\")       # False\n</code></pre>"},{"location":"ko/api/daemon/#query_valid_pathspaths-liststr-substitute-bool-false-setstr","title":"<code>query_valid_paths(paths: list[str], substitute: bool = False) -&gt; set[str]</code>","text":"<p>\ubc30\uce58 \uc720\ud6a8\uc131 \ud655\uc778. \uc720\ud6a8\ud55c \uacbd\ub85c\uc758 \ubd80\ubd84 \uc9d1\ud569\uc744 \ubc18\ud658\ud569\ub2c8\ub2e4.</p> <pre><code>with DaemonConnection() as conn:\n    valid = conn.query_valid_paths([\n        \"/nix/store/...-hello\",\n        \"/nix/store/...-nonexistent\",\n    ])\n    # {'/nix/store/...-hello'}\n</code></pre> \ub9e4\uac1c\ubcc0\uc218 \uc124\uba85 <code>substitute</code> <code>True</code>\uc774\uba74 \ub204\ub77d\ub41c \uacbd\ub85c\uc758 \ub300\uccb4\ub97c \uc2dc\ub3c4"},{"location":"ko/api/daemon/#query_path_infopath-str-pathinfo","title":"<code>query_path_info(path: str) -&gt; PathInfo</code>","text":"<p>\uc720\ud6a8\ud55c \uc2a4\ud1a0\uc5b4 \uacbd\ub85c\uc758 \uba54\ud0c0\ub370\uc774\ud130\ub97c \uc870\ud68c\ud569\ub2c8\ub2e4.</p> <p>\uc608\uc678: \uacbd\ub85c\uac00 \uc720\ud6a8\ud558\uc9c0 \uc54a\uc73c\uba74 <code>NixDaemonError</code> \ubc1c\uc0dd.</p> <pre><code>with DaemonConnection() as conn:\n    info = conn.query_path_info(\"/nix/store/...-hello-2.12.2\")\n    info.deriver       # '/nix/store/...-hello-2.12.2.drv'\n    info.nar_hash       # 'sha256:1abc...'\n    info.nar_size       # 53856\n    info.references     # ['/nix/store/...-glibc', ...]\n    info.sigs           # ['cache.nixos.org-1:abc...']\n</code></pre>"},{"location":"ko/api/daemon/#add_text_to_storename-str-content-str-references-liststr-none-none-str","title":"<code>add_text_to_store(name: str, content: str, references: list[str] | None = None) -&gt; str</code>","text":"<p>\ud14d\uc2a4\ud2b8 \ubb38\uc790\uc5f4\uc744 Nix \uc2a4\ud1a0\uc5b4\uc5d0 \ucd94\uac00\ud569\ub2c8\ub2e4. \uc2a4\ud1a0\uc5b4 \uacbd\ub85c\ub97c \ubc18\ud658\ud569\ub2c8\ub2e4.</p> <p><code>builtins.toFile</code>\uacfc \uac19\uc2b5\ub2c8\ub2e4 \u2014 \uc8fc\uc5b4\uc9c4 \ub0b4\uc6a9\uc73c\ub85c \uc77c\ubc18 \ud30c\uc77c\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4.</p> <pre><code>with DaemonConnection() as conn:\n    path = conn.add_text_to_store(\"hello.txt\", \"hello world\")\n    # '/nix/store/qbfcv31xi1wjisxwl4b2nk1a8jqxbcf5-hello.txt'\n\n    # \ucc38\uc870 \ud3ec\ud568 (\ud14d\uc2a4\ud2b8\uac00 \ub2e4\ub978 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c\uc5d0 \uc758\uc874):\n    path = conn.add_text_to_store(\n        \"wrapper.sh\",\n        \"#!/bin/sh\\nexec /nix/store/...-program/bin/prog\",\n        references=[\"/nix/store/...-program\"]\n    )\n</code></pre>"},{"location":"ko/api/daemon/#build_pathspaths-liststr-build_mode-int-0-none","title":"<code>build_paths(paths: list[str], build_mode: int = 0) -&gt; None</code>","text":"<p>\ud558\ub098 \uc774\uc0c1\uc758 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c\ub97c \ube4c\ub4dc\ud569\ub2c8\ub2e4. Derivation\uc758 \uacbd\uc6b0 <code>&lt;drv-path&gt;^&lt;output&gt;</code> \uad6c\ubb38\uc744 \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p> <p>\uc608\uc678: \ube4c\ub4dc \uc2e4\ud328 \uc2dc <code>NixDaemonError</code> \ubc1c\uc0dd.</p> <pre><code>with DaemonConnection() as conn:\n    # derivation \ucd9c\ub825 \ube4c\ub4dc\n    conn.build_paths([\"/nix/store/...-hello.drv^out\"])\n\n    # \uc5ec\ub7ec \uacbd\ub85c \ub300\uccb4/\ube4c\ub4dc\n    conn.build_paths([\n        \"/nix/store/...-hello.drv^out\",\n        \"/nix/store/...-world.drv^out\",\n    ])\n</code></pre> <code>build_mode</code> \uc758\ubbf8 <code>0</code> \uc77c\ubc18 (\ube4c\ub4dc \ub610\ub294 \ub300\uccb4) <code>1</code> \uc218\ub9ac <code>2</code> \uac80\uc0ac"},{"location":"ko/api/daemon/#_3","title":"\ub370\uc774\ud130 \ud074\ub798\uc2a4","text":""},{"location":"ko/api/daemon/#pathinfo","title":"<code>PathInfo</code>","text":"<p><code>query_path_info</code>\uac00 \ubc18\ud658\ud558\ub294 \ub370\uc774\ud130.</p> <pre><code>@dataclass\nclass PathInfo:\n    deriver: str            # \uc774\uac83\uc744 \uc0dd\uc131\ud55c .drv \uacbd\ub85c, \ub610\ub294 \"\"\n    nar_hash: str           # \ubb38\uc790\uc5f4\ub85c \ub41c NAR \ud574\uc2dc\n    references: list[str]   # \uc774\uac83\uc774 \uc758\uc874\ud558\ub294 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c\n    registration_time: int  # Unix \ud0c0\uc784\uc2a4\ud0ec\ud504\n    nar_size: int           # NAR \uc9c1\ub82c\ud654\uc758 \ubc14\uc774\ud2b8 \ud06c\uae30\n    sigs: list[str]         # \uc11c\uba85\n</code></pre>"},{"location":"ko/api/daemon/#_4","title":"\uc608\uc678","text":""},{"location":"ko/api/daemon/#nixdaemonerror","title":"<code>NixDaemonError</code>","text":"<p>\ud504\ub85c\ud1a0\ucf5c \uc624\ub958, \uc798\ubabb\ub41c \uacbd\ub85c, \ube4c\ub4dc \uc2e4\ud328 \ub4f1\uc5d0\uc11c \ubc1c\uc0dd\ud569\ub2c8\ub2e4.</p> <pre><code>from pix.daemon import DaemonConnection, NixDaemonError\n\nwith DaemonConnection() as conn:\n    try:\n        conn.query_path_info(\"/nix/store/invalid-path\")\n    except NixDaemonError as e:\n        print(f\"\ub370\ubaac \uc624\ub958: {e}\")\n</code></pre>"},{"location":"ko/api/derivation/","title":"pix.derivation","text":"<p>Nix <code>.drv</code> \ud30c\uc77c (ATerm \ud615\uc2dd) \ud30c\uc2f1 \ubc0f \uc9c1\ub82c\ud654, \ucd9c\ub825 \uacbd\ub85c \uacc4\uc0b0\uc744 \uc704\ud55c derivation \ud574\uc2dc \uacc4\uc0b0.</p> <p>ATerm \ud615\uc2dd \uba85\uc138\ub294 \ub0b4\ubd80 \uad6c\uc870: Derivation\uc744 \ucc38\uace0\ud558\uc138\uc694.</p>"},{"location":"ko/api/derivation/#_1","title":"\ub370\uc774\ud130 \ud074\ub798\uc2a4","text":""},{"location":"ko/api/derivation/#derivationoutput","title":"<code>DerivationOutput</code>","text":"<pre><code>@dataclass\nclass DerivationOutput:\n    path: str        # \ucd9c\ub825 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c (content-addressed\uc758 \uacbd\uc6b0 \ube44\uc5b4\uc788\uc74c)\n    hash_algo: str   # \uc77c\ubc18 \ucd9c\ub825\uc740 \"\", fixed-output\uc740 \"sha256\" \ub4f1\n    hash_value: str  # \uc77c\ubc18 \ucd9c\ub825\uc740 \"\", fixed-output\uc740 16\uc9c4\uc218 \ud574\uc2dc\n</code></pre>"},{"location":"ko/api/derivation/#derivation","title":"<code>Derivation</code>","text":"<pre><code>@dataclass\nclass Derivation:\n    outputs: dict[str, DerivationOutput]     # \"out\" -&gt; DerivationOutput(...)\n    input_drvs: dict[str, list[str]]         # drv_path -&gt; [\"out\", ...]\n    input_srcs: list[str]                    # \uc18c\uc2a4 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c\n    platform: str                            # \"x86_64-linux\"\n    builder: str                             # \"/nix/store/...-bash/bin/bash\"\n    args: list[str]                          # \ube4c\ub354 \uc778\uc790\n    env: dict[str, str]                      # \ud658\uacbd \ubcc0\uc218\n</code></pre>"},{"location":"ko/api/derivation/#_2","title":"\ud568\uc218","text":""},{"location":"ko/api/derivation/#parsedrv_text-str-derivation","title":"<code>parse(drv_text: str) -&gt; Derivation</code>","text":"<p>ATerm <code>.drv</code> \ud30c\uc77c\uc744 <code>Derivation</code>\uc73c\ub85c \ud30c\uc2f1\ud569\ub2c8\ub2e4.</p> <pre><code>from pix.derivation import parse\n\ndrv = parse(open(\"/nix/store/...-hello-2.12.2.drv\").read())\n\ndrv.platform       # 'x86_64-linux'\ndrv.builder         # '/nix/store/...-bash/bin/bash'\ndrv.outputs.keys()  # dict_keys(['out'])\ndrv.env['name']     # 'hello'\n</code></pre> <p>\ubb38\uc790\uc5f4\uc758 \uc774\uc2a4\ucf00\uc774\ud504 \uc2dc\ud000\uc2a4\ub97c \ucc98\ub9ac\ud569\ub2c8\ub2e4: <code>\\\\</code>, <code>\\\"</code>, <code>\\n</code>, <code>\\r</code>, <code>\\t</code>.</p>"},{"location":"ko/api/derivation/#serializedrv-derivation-str","title":"<code>serialize(drv: Derivation) -&gt; str</code>","text":"<p><code>Derivation</code>\uc744 ATerm <code>.drv</code> \ud615\uc2dd\uc73c\ub85c \uc9c1\ub82c\ud654\ud569\ub2c8\ub2e4.</p> <p>\ucd9c\ub825\uc740 \uacb0\uc815\ub860\uc801\uc785\ub2c8\ub2e4:</p> <ul> <li>\ucd9c\ub825\uc740 \uc774\ub984\uc21c \uc815\ub82c</li> <li>\uc785\ub825 derivation\uc740 \uacbd\ub85c\uc21c \uc815\ub82c</li> <li>\uc785\ub825 \uc18c\uc2a4\ub294 \uc815\ub82c\ub428</li> <li>\ud658\uacbd \ubcc0\uc218\ub294 \ud0a4\uc21c \uc815\ub82c</li> <li>\ubb38\uc790\uc5f4\uc740 \uc801\uc808\ud788 \uc774\uc2a4\ucf00\uc774\ud504</li> </ul> <pre><code>from pix.derivation import parse, serialize\n\ntext = open(\"/nix/store/...-hello.drv\").read()\ndrv = parse(text)\nassert parse(serialize(drv)) == drv  # \uc655\ubcf5 \ubcc0\ud658\n</code></pre>"},{"location":"ko/api/derivation/#hash_derivation_modulodrv-derivation-drv_hashes-dictstr-bytes-none-none-bytes","title":"<code>hash_derivation_modulo(drv: Derivation, drv_hashes: dict[str, bytes] | None = None) -&gt; bytes</code>","text":"<p>\ucd9c\ub825 \uacbd\ub85c \uacc4\uc0b0\uc5d0 \uc0ac\uc6a9\ub418\ub294 derivation\uc758 \ubaa8\ub4c8\ub7ec \ud574\uc2dc\ub97c \uacc4\uc0b0\ud569\ub2c8\ub2e4.</p> <p>\uace0\uc815 \ucd9c\ub825 derivation (\ub2e8\uc77c \ucd9c\ub825 <code>\"out\"</code>\uc5d0 <code>hash_algo</code>\uac00 \uc124\uc815\ub41c \uacbd\uc6b0):</p> <pre><code>sha256(\"fixed:out:&lt;hash_algo&gt;:&lt;hash_value&gt;:\")\n</code></pre> <p>\uc77c\ubc18 derivation: \ucd9c\ub825 \uacbd\ub85c\ub97c \ube44\uc6b0\uace0 \uc785\ub825 derivation \uacbd\ub85c\ub97c \ubaa8\ub4c8\ub7ec \ud574\uc2dc\ub85c \ub300\uccb4\ud55c \ub9c8\uc2a4\ud06c \ubcf5\uc0ac\ubcf8\uc744 \ub9cc\ub4e0 \ub2e4\uc74c, \uacb0\uacfc ATerm\uc744 \ud574\uc2f1\ud569\ub2c8\ub2e4.</p> <pre><code>from pix.derivation import parse, hash_derivation_modulo\n\ndrv = parse(open(\"some.drv\").read())\n\n# \uace0\uc815 \ucd9c\ub825\uc758 \uacbd\uc6b0:\nh = hash_derivation_modulo(drv)\n\n# \uc77c\ubc18 derivation\uc758 \uacbd\uc6b0, \uc785\ub825 drv \ud574\uc2dc\ub97c \uc81c\uacf5:\nh = hash_derivation_modulo(drv, drv_hashes={\n    \"/nix/store/...-dep.drv\": dep_hash,\n})\n</code></pre> <p>\uc8fc\uc758</p> <p>\uc77c\ubc18 (\ube44\uace0\uc815 \ucd9c\ub825) derivation\uc758 \uacbd\uc6b0, <code>drv_hashes</code> \ub9e4\uac1c\ubcc0\uc218\ub97c \ud1b5\ud574 \ubaa8\ub4e0 \uc785\ub825 derivation\uc758 \ubaa8\ub4c8\ub7ec \ud574\uc2dc\ub97c \uc81c\uacf5\ud574\uc57c \ud569\ub2c8\ub2e4. \ub204\ub77d\ub41c \ud574\uc2dc\ub294 <code>ValueError</code>\ub97c \ubc1c\uc0dd\uc2dc\ud0b5\ub2c8\ub2e4.</p>"},{"location":"ko/api/derivation/#derivation_1","title":"\uc608\uc81c: \uc804\uccb4 derivation \uac80\uc0ac","text":"<pre><code>from pix.derivation import parse\nimport json\n\ndrv = parse(open(\"/nix/store/...-hello-2.12.2.drv\").read())\n\nprint(f\"\ud328\ud0a4\uc9c0: {drv.env.get('pname', drv.env.get('name', '?'))}\")\nprint(f\"\ubc84\uc804: {drv.env.get('version', '?')}\")\nprint(f\"\uc2dc\uc2a4\ud15c: {drv.platform}\")\nprint(f\"\ube4c\ub354: {drv.builder}\")\nprint(f\"\ucd9c\ub825: {list(drv.outputs.keys())}\")\nprint(f\"\uc758\uc874\uc131: {len(drv.input_drvs)}\uac1c derivation, {len(drv.input_srcs)}\uac1c \uc18c\uc2a4\")\n</code></pre>"},{"location":"ko/api/hash/","title":"pix.hash","text":"<p>Nix \uc2a4\ud1a0\uc5b4 \uacbd\ub85c \uacc4\uc0b0\uc744 \uc704\ud55c \ud574\uc2dc \uc720\ud2f8\ub9ac\ud2f0.</p>"},{"location":"ko/api/hash/#_1","title":"\ud568\uc218","text":""},{"location":"ko/api/hash/#sha256data-bytes-bytes","title":"<code>sha256(data: bytes) -&gt; bytes</code>","text":"<p>SHA-256 \ub2e4\uc774\uc81c\uc2a4\ud2b8\ub97c \uacc4\uc0b0\ud569\ub2c8\ub2e4. <code>hashlib.sha256</code>\uc758 \uc587\uc740 \ub798\ud37c\uc785\ub2c8\ub2e4.</p> <pre><code>from pix.hash import sha256\n\nsha256(b\"hello\")\n# b',\\xf2M\\xba_\\xb0\\xa3\\x0e...' (32 \ubc14\uc774\ud2b8)\n</code></pre>"},{"location":"ko/api/hash/#sha256_hexdata-bytes-str","title":"<code>sha256_hex(data: bytes) -&gt; str</code>","text":"<p>SHA-256 \ub2e4\uc774\uc81c\uc2a4\ud2b8\ub97c 16\uc9c4\uc218 \ubb38\uc790\uc5f4\ub85c \uacc4\uc0b0\ud569\ub2c8\ub2e4.</p> <pre><code>from pix.hash import sha256_hex\n\nsha256_hex(b\"hello\")\n# '2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824'\n</code></pre>"},{"location":"ko/api/hash/#compress_hashhash_bytes-bytes-size-int-bytes","title":"<code>compress_hash(hash_bytes: bytes, size: int) -&gt; bytes</code>","text":"<p>\ud574\uc2dc\ub97c \ub354 \uc9e7\uc740 \uae38\uc774\ub85c XOR-\ud3f4\ub4dc\ud569\ub2c8\ub2e4.</p> <p>Nix\uac00 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c \ud574\uc2dc\ub97c \uc704\ud574 SHA-256 (32 \ubc14\uc774\ud2b8)\uc744 160\ube44\ud2b8 (20 \ubc14\uc774\ud2b8)\ub85c \uc904\uc774\ub294 \ubc29\ubc95\uc785\ub2c8\ub2e4. \uc774\uac83\uc740 \ub2e8\uc21c \uc798\ub77c\ub0b4\uae30(truncation)\uac00 \uc544\ub2d9\ub2c8\ub2e4 \u2014 \uc785\ub825\uc758 \ubaa8\ub4e0 \ubc14\uc774\ud2b8\uac00 XOR\uc744 \ud1b5\ud574 \ucd9c\ub825\uc5d0 \uae30\uc5ec\ud569\ub2c8\ub2e4.</p> <p>\uc54c\uace0\ub9ac\uc998:</p> <pre><code>result = bytearray(size)       # 0\uc73c\ub85c \ucd08\uae30\ud654\nfor i, b in enumerate(hash_bytes):\n    result[i % size] ^= b      # \uac01 \ubc14\uc774\ud2b8\ub97c \ud574\ub2f9 \uc704\uce58\uc5d0 XOR\n</code></pre> <p>\uc608\uc81c:</p> <pre><code>from pix.hash import compress_hash, sha256\n\ndigest = sha256(b\"hello\")           # 32 \ubc14\uc774\ud2b8\ncompressed = compress_hash(digest, 20)  # 20 \ubc14\uc774\ud2b8\n\n# \ub2e4\uc774\uc81c\uc2a4\ud2b8\uc758 \ubc14\uc774\ud2b8 0..19\uac00 \ubc14\uc774\ud2b8 20..31\uacfc XOR\ub428\n# compressed[0] = digest[0] ^ digest[20]\n# compressed[1] = digest[1] ^ digest[21]\n# ...\n# compressed[11] = digest[11] ^ digest[31]\n# compressed[12..19] = digest[12..19]  (\ud3f4\ub529 \ubd88\ud544\uc694)\n</code></pre> <p>\ucc38\uace0</p> <p>XOR-\ud3f4\ub4dc\ub294 \uc798\ub77c\ub0b4\uae30\ubcf4\ub2e4 \ub354 \ub9ce\uc740 \uc5d4\ud2b8\ub85c\ud53c\ub97c \ubcf4\uc874\ud569\ub2c8\ub2e4. \uc6d0\ubcf8 \ud574\uc2dc\uc758 \ubaa8\ub4e0 \ube44\ud2b8\uac00 \uc555\ucd95\ub41c \ucd9c\ub825\uc5d0 \uc601\ud5a5\uc744 \uc90d\ub2c8\ub2e4.</p>"},{"location":"ko/api/nar/","title":"pix.nar","text":"<p>NAR (Nix Archive) \uc9c1\ub82c\ud654 \ubc0f \ud574\uc2f1.</p> <p>NAR\uc740 \uacb0\uc815\ub860\uc801 \uc544\uce74\uc774\ube0c \ud615\uc2dd\uc785\ub2c8\ub2e4. tar\uc640 \ub2ec\ub9ac, \ud0c0\uc784\uc2a4\ud0ec\ud504, \uc18c\uc720\uad8c, \ud37c\ubbf8\uc158(\uc2e4\ud589 \ube44\ud2b8\ub9cc \ubcf4\uc874)\uc5d0 \uad00\uacc4\uc5c6\uc774 \ub3d9\uc77c\ud55c \ud30c\uc77c\uc2dc\uc2a4\ud15c \ub0b4\uc6a9\uc5d0 \ub300\ud574 \ud56d\uc0c1 \ub3d9\uc77c\ud55c \ubc14\uc774\ud2b8 \uc2dc\ud000\uc2a4\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4.</p> <p>\uc640\uc774\uc5b4 \ud615\uc2dd \uba85\uc138\ub294 \ub0b4\ubd80 \uad6c\uc870: NAR \ud615\uc2dd\uc744 \ucc38\uace0\ud558\uc138\uc694.</p>"},{"location":"ko/api/nar/#_1","title":"\ud568\uc218","text":""},{"location":"ko/api/nar/#nar_serializepath-str-path-bytes","title":"<code>nar_serialize(path: str | Path) -&gt; bytes</code>","text":"<p>\ud30c\uc77c\uc2dc\uc2a4\ud15c \uacbd\ub85c (\ud30c\uc77c, \ub514\ub809\ud130\ub9ac, \uc2ec\ub9c1\ud06c)\ub97c NAR \ubc14\uc774\ud2b8\ub85c \uc9c1\ub82c\ud654\ud569\ub2c8\ub2e4.</p> <pre><code>from pix.nar import nar_serialize\n\n# \ub2e8\uc77c \ud30c\uc77c \uc9c1\ub82c\ud654\nnar = nar_serialize(\"/tmp/hello.txt\")\n\n# \ub514\ub809\ud130\ub9ac \uc9c1\ub82c\ud654 (\uc5d4\ud2b8\ub9ac\ub294 \uc774\ub984\uc21c \uc815\ub82c)\nnar = nar_serialize(\"/path/to/my-source\")\n</code></pre> <p>\ub3d9\uc791:</p> <ul> <li>\uc77c\ubc18 \ud30c\uc77c: \ub0b4\uc6a9\uacfc \uc2e4\ud589 \ud50c\ub798\uadf8\uc640 \ud568\uaed8 \uc9c1\ub82c\ud654</li> <li>\uc2ec\ub9c1\ud06c: \uc2ec\ub9c1\ud06c \ub300\uc0c1\uc73c\ub85c \uc9c1\ub82c\ud654 (\ud574\uc11d\ud558\uc9c0 \uc54a\uc74c)</li> <li>\ub514\ub809\ud130\ub9ac: \uc774\ub984\uc21c \uc0ac\uc804\uc2dd \uc815\ub82c, \uc7ac\uadc0 \ucc98\ub9ac</li> <li>\uae30\ud0c0 \ud0c0\uc785: <code>ValueError</code> \ubc1c\uc0dd</li> </ul>"},{"location":"ko/api/nar/#nar_hashpath-str-path-bytes","title":"<code>nar_hash(path: str | Path) -&gt; bytes</code>","text":"<p>NAR \uc9c1\ub82c\ud654\uc758 SHA-256 \ud574\uc2dc\ub97c \uacc4\uc0b0\ud569\ub2c8\ub2e4. 32\ubc14\uc774\ud2b8 \uc6d0\uc2dc \ubc14\uc774\ud2b8\ub97c \ubc18\ud658\ud569\ub2c8\ub2e4.</p> <p><code>nix hash path</code>\uac00 \uacc4\uc0b0\ud558\ub294 \uac83\uacfc \uac19\uc2b5\ub2c8\ub2e4.</p> <pre><code>from pix.nar import nar_hash\n\ndigest = nar_hash(\"./my-file.txt\")  # 32 \ubc14\uc774\ud2b8\ndigest.hex()\n# 'a1b2c3d4...'\n</code></pre>"},{"location":"ko/api/nar/#nar_hash_hexpath-str-path-str","title":"<code>nar_hash_hex(path: str | Path) -&gt; str</code>","text":"<p><code>nar_hash</code>\uc640 \ub3d9\uc77c\ud558\uc9c0\ub9cc 16\uc9c4\uc218 \ubb38\uc790\uc5f4\uc744 \uc9c1\uc811 \ubc18\ud658\ud569\ub2c8\ub2e4.</p> <pre><code>from pix.nar import nar_hash_hex\n\nnar_hash_hex(\"./my-file.txt\")\n# 'a1b2c3d4...'\n</code></pre>"},{"location":"ko/api/nar/#_2","title":"\ub2e4\ub978 \ubaa8\ub4c8\uacfc\uc758 \uc870\ud569","text":"<p>NAR \ud574\uc2f1\uc740 \uc18c\uc2a4 \uc784\ud3ec\ud2b8\uc758 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c\ub97c \uacc4\uc0b0\ud558\ub294 \uccab \ubc88\uc9f8 \ub2e8\uacc4\uc785\ub2c8\ub2e4:</p> <pre><code>from pix.nar import nar_hash\nfrom pix.store_path import make_source_store_path\n\nh = nar_hash(\"./my-project\")\npath = make_source_store_path(\"my-project\", h)\n# '/nix/store/abc123...-my-project'\n</code></pre>"},{"location":"ko/api/pixpkgs/","title":"pixpkgs","text":"<p>pix\uc758 \uc800\uc218\uc900 \ud504\ub9ac\ubbf8\ud2f0\ube0c \uc704\uc5d0 \uad6c\ucd95\ub41c nixpkgs \uc2a4\ud0c0\uc77c \ud328\ud0a4\uc9c0 \uc138\ud2b8. Nix \ud328\ud134\uc744 Python \uad00\uc6a9\uad6c\ub85c \ub9e4\ud551\ud569\ub2c8\ub2e4.</p>"},{"location":"ko/api/pixpkgs/#drv","title":"<code>drv()</code>","text":"<pre><code>from pixpkgs import drv\n\npkg = drv(\n    name=\"hello\",\n    builder=\"/bin/sh\",\n    args=[\"-c\", \"echo hello &gt; $out\"],\n)\n</code></pre>"},{"location":"ko/api/pixpkgs/#_1","title":"\uc2dc\uadf8\ub2c8\ucc98","text":"<pre><code>def drv(\n    name: str,\n    builder: str,\n    system: str = \"x86_64-linux\",\n    args: list[str] | None = None,\n    env: dict[str, str] | None = None,\n    output_names: list[str] | None = None,\n    deps: list[Package] | None = None,\n    srcs: list[str] | None = None,\n) -&gt; Package\n</code></pre>"},{"location":"ko/api/pixpkgs/#_2","title":"\ub9e4\uac1c\ubcc0\uc218","text":"\ub9e4\uac1c\ubcc0\uc218 \uae30\ubcf8\uac12 \uc124\uba85 <code>name</code> \u2014 \ud328\ud0a4\uc9c0 \uc774\ub984 (\uc2a4\ud1a0\uc5b4 \uacbd\ub85c \uc811\ubbf8\uc0ac\uac00 \ub428) <code>builder</code> \u2014 \ube4c\ub354 \uc2e4\ud589 \ud30c\uc77c \uacbd\ub85c <code>system</code> <code>\"x86_64-linux\"</code> \ube4c\ub4dc \ud50c\ub7ab\ud3fc <code>args</code> <code>[]</code> \ube4c\ub354 \uc778\uc790 <code>env</code> <code>{}</code> \ucd94\uac00 \ud658\uacbd \ubcc0\uc218 <code>output_names</code> <code>[\"out\"]</code> \ucd9c\ub825 \uc774\ub984 <code>deps</code> <code>[]</code> \ud328\ud0a4\uc9c0 \uc758\uc874\uc131 (<code>inputDrvs</code>\ub85c \ucd94\uac00\ub428) <code>srcs</code> <code>[]</code> \uc785\ub825 \uc18c\uc2a4 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c"},{"location":"ko/api/pixpkgs/#_3","title":"\ud30c\uc774\ud504\ub77c\uc778","text":"<p><code>drv()</code>\ub294 \ub0b4\ubd80\uc801\uc73c\ub85c \uc804\uccb4 6\ub2e8\uacc4 derivation \ud30c\uc774\ud504\ub77c\uc778\uc744 \uc2e4\ud589\ud569\ub2c8\ub2e4:</p> <pre><code>1. \ube48 \ucd9c\ub825 \uacbd\ub85c\ub85c Derivation \uc0dd\uc131\n2. \uc785\ub825 derivation \ud574\uc2dc \uc218\uc9d1 (mask_outputs=False)\n3. hashDerivationModulo (\uc790\uc2e0\uc5d0 \ub300\ud574 mask_outputs=True)\n4. make_output_path \u2192 \ucd9c\ub825 \uacbd\ub85c\ub97c .outputs\uc640 .env\uc5d0 \ucc44\uc6c0\n5. ATerm\uc73c\ub85c \uc9c1\ub82c\ud654\n6. make_text_store_path \u2192 .drv \uc2a4\ud1a0\uc5b4 \uacbd\ub85c \uacc4\uc0b0\n</code></pre> <p>Nix\uc758 <code>derivation</code> \ub0b4\uc7a5 \ud568\uc218\uac00 \ud558\ub294 \uac83\uacfc \ub3d9\uc77c\ud558\uac8c \ud45c\uc900 \ud658\uacbd \ubcc0\uc218(<code>name</code>, <code>builder</code>, <code>system</code>, \ucd9c\ub825 \uc774\ub984)\uac00 \uc790\ub3d9\uc73c\ub85c \ucd94\uac00\ub429\ub2c8\ub2e4.</p>"},{"location":"ko/api/pixpkgs/#package","title":"<code>Package</code>","text":"<p><code>drv()</code>\uac00 \ubc18\ud658\ud558\ub294 \ubd88\ubcc0(frozen) \ub370\uc774\ud130\ud074\ub798\uc2a4\uc785\ub2c8\ub2e4.</p>"},{"location":"ko/api/pixpkgs/#_4","title":"\uc18d\uc131","text":"\uc18d\uc131 \ud0c0\uc785 \uc124\uba85 <code>name</code> <code>str</code> \ud328\ud0a4\uc9c0 \uc774\ub984 <code>drv</code> <code>Derivation</code> \uae30\ubc18 pix Derivation \uac1d\uccb4 <code>drv_path</code> <code>str</code> <code>.drv</code> \ud30c\uc77c\uc758 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c <code>outputs</code> <code>dict[str, str]</code> \ucd9c\ub825 \uc774\ub984 \u2192 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c \ub9e4\ud551"},{"location":"ko/api/pixpkgs/#packageout","title":"<code>Package.out</code>","text":"<pre><code>pkg.out  # \"/nix/store/&lt;hash&gt;-hello\"\n</code></pre> <p><code>pkg.outputs[\"out\"]</code>\uc758 \ub2e8\ucd95 \u2014 \uae30\ubcf8 \ucd9c\ub825 \uacbd\ub85c\uc785\ub2c8\ub2e4.</p>"},{"location":"ko/api/pixpkgs/#package__str__","title":"<code>Package.__str__</code>","text":"<pre><code>f\"echo {pkg} &gt; $out\"  # \ucd9c\ub825 \uacbd\ub85c\uac00 \uc0bd\uc785\ub428\n</code></pre> <p><code>pkg.out</code>\uc744 \ubc18\ud658\ud569\ub2c8\ub2e4. Nix\uc758 \ubb38\uc790\uc5f4 \ubcf4\uac04 \ucee8\ud14d\uc2a4\ud2b8\ub97c \ubc18\uc601\ud569\ub2c8\ub2e4 \u2014 Nix\uc5d0\uc11c <code>${pkg}</code>\ub97c \uc0ac\uc6a9\ud558\uba74 \ud328\ud0a4\uc9c0\uc758 \uae30\ubcf8 \ucd9c\ub825 \uacbd\ub85c\ub97c \uc5bb\uc2b5\ub2c8\ub2e4.</p>"},{"location":"ko/api/pixpkgs/#packageoverride","title":"<code>Package.override()</code>","text":"<pre><code>pkg2 = pkg.override(name=\"hello-custom\", env={\"CFLAGS\": \"-O2\"})\n</code></pre> <p>\ubcc0\uacbd\ub41c \uc778\uc790\ub85c \ud328\ud0a4\uc9c0\ub97c \uc7ac\uc0dd\uc131\ud569\ub2c8\ub2e4. Nix\uc758 <code>pkg.override</code>\uc640 \uac19\uc2b5\ub2c8\ub2e4 \u2014 \uc0c8\ub85c\uc6b4 derivation \ud574\uc2dc\ub97c \uac00\uc9c4 \uc0c8 Package\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4.</p>"},{"location":"ko/api/pixpkgs/#packageset","title":"<code>PackageSet</code>","text":"<p>\uc790\ub3d9 \uc758\uc874\uc131 \uc8fc\uc785\uc744 \uc0ac\uc6a9\ud558\uc5ec \uc0c1\ud638 \uc758\uc874\uc801\uc778 \ud328\ud0a4\uc9c0 \uc138\ud2b8\ub97c \uc815\uc758\ud558\ub294 \uae30\ubcf8 \ud074\ub798\uc2a4\uc785\ub2c8\ub2e4.</p> <pre><code>from pixpkgs import drv, PackageSet, realize\nfrom functools import cached_property\n\nclass MyPkgs(PackageSet):\n    @cached_property\n    def greeting(self):\n        return drv(\n            name=\"greeting\",\n            builder=\"/bin/sh\",\n            args=[\"-c\", \"echo hello &gt; $out\"],\n        )\n\n    @cached_property\n    def shouter(self):\n        return self.call(lambda greeting: drv(\n            name=\"shouter\",\n            builder=\"/bin/sh\",\n            args=[\"-c\", f\"read line &lt; {greeting}; echo $line! &gt; $out\"],\n            deps=[greeting],\n        ))\n\npkgs = MyPkgs()\nrealize(pkgs.shouter)  # greeting\uc744 \uba3c\uc800 \ube4c\ub4dc\ud55c \ub2e4\uc74c shouter \ube4c\ub4dc\n</code></pre>"},{"location":"ko/api/pixpkgs/#packagesetcallfn","title":"<code>PackageSet.call(fn)</code>","text":"<p><code>fn</code>\uc758 \ub9e4\uac1c\ubcc0\uc218 \uc774\ub984\uc744 \uac80\uc0ac\ud558\uc5ec <code>self</code>\uc758 \uc18d\uc131\uc73c\ub85c \uc870\ud68c\ud569\ub2c8\ub2e4. Nix\uc758 <code>callPackage</code> \ud328\ud134\uc758 Python \ub4f1\uac00\ubb3c\uc785\ub2c8\ub2e4 \u2014 \uc758\uc874\uc131\uc774 \uba85\uc2dc\uc801\uc73c\ub85c \uc804\ub2ec\ub418\ub294 \ub300\uc2e0 \uc774\ub984\uc73c\ub85c \uc8fc\uc785\ub429\ub2c8\ub2e4.</p> <pre><code># \ub2e4\uc74c \ub450 \ud45c\ud604\uc740 \ub3d9\uc77c\ud569\ub2c8\ub2e4:\npkgs.call(lambda greeting: use(greeting))\nuse(pkgs.greeting)\n</code></pre> <p><code>@cached_property</code>\uc640 \uacb0\ud569\ud558\uba74 \uc9c0\uc5f0 \ud3c9\uac00\ub97c \uc81c\uacf5\ud569\ub2c8\ub2e4 \u2014 \ud328\ud0a4\uc9c0\ub294 \ucc98\uc74c \uc811\uadfc\ud560 \ub54c\ub9cc \uc0dd\uc131\ub418\uace0 \uc774\ud6c4 \uba54\ubaa8\uc774\uc81c\uc774\uc158\ub429\ub2c8\ub2e4.</p>"},{"location":"ko/api/pixpkgs/#realize","title":"<code>realize()</code>","text":"<pre><code>from pixpkgs import realize\n\noutput_path = realize(pkg)\n# \"/nix/store/&lt;hash&gt;-hello\"\n</code></pre>"},{"location":"ko/api/pixpkgs/#_5","title":"\uc2dc\uadf8\ub2c8\ucc98","text":"<pre><code>def realize(pkg: Package, conn: DaemonConnection | None = None) -&gt; str\n</code></pre> <p>Nix \ub370\ubaac\uc744 \ud1b5\ud574 \ud328\ud0a4\uc9c0\ub97c \ube4c\ub4dc\ud569\ub2c8\ub2e4:</p> <ol> <li>\ubaa8\ub4e0 \uc758\uc874\uc131 <code>.drv</code> \ud30c\uc77c\uc744 <code>add_text_to_store</code>\ub97c \ud1b5\ud574 \uc2a4\ud1a0\uc5b4\uc5d0 \uc7ac\uadc0\uc801\uc73c\ub85c \ub4f1\ub85d</li> <li><code>build_paths</code>\ub97c \ud638\ucd9c\ud558\uc5ec \ud328\ud0a4\uc9c0 \ube4c\ub4dc</li> <li>\uae30\ubcf8 \ucd9c\ub825 \uacbd\ub85c\ub97c \ubc18\ud658</li> </ol> <p><code>conn</code>\uc774 \uc81c\uacf5\ub418\uc9c0 \uc54a\uc73c\uba74 <code>DaemonConnection</code>\uc744 \uc790\ub3d9\uc73c\ub85c \uc5f4\uace0 \ub2eb\uc2b5\ub2c8\ub2e4.</p>"},{"location":"ko/api/store_path/","title":"pix.store_path","text":"<p>Nix \uc2a4\ud1a0\uc5b4 \uacbd\ub85c\ub97c \uacc4\uc0b0\ud569\ub2c8\ub2e4. \uc2a4\ud1a0\uc5b4 \uacbd\ub85c\ub294 <code>/nix/store/&lt;hash&gt;-&lt;name&gt;</code> \ud615\ud0dc\uc774\uba70, <code>&lt;hash&gt;</code>\ub294 160\ube44\ud2b8 \ud574\uc2dc\ub97c Nix base32\ub85c \uc778\ucf54\ub529\ud55c 32\uc790\uc785\ub2c8\ub2e4.</p> <p>\uc804\uccb4 \uc54c\uace0\ub9ac\uc998\uc740 \ub0b4\ubd80 \uad6c\uc870: \uc2a4\ud1a0\uc5b4 \uacbd\ub85c\ub97c \ucc38\uace0\ud558\uc138\uc694.</p>"},{"location":"ko/api/store_path/#_1","title":"\uc0c1\uc218","text":""},{"location":"ko/api/store_path/#store_dir","title":"<code>STORE_DIR</code>","text":"<pre><code>STORE_DIR = \"/nix/store\"\n</code></pre>"},{"location":"ko/api/store_path/#hash_bytes","title":"<code>HASH_BYTES</code>","text":"<pre><code>HASH_BYTES = 20  # 160\ube44\ud2b8\n</code></pre>"},{"location":"ko/api/store_path/#_2","title":"\ud568\uc218","text":""},{"location":"ko/api/store_path/#make_store_pathtype_prefix-str-inner_hash-bytes-name-str-str","title":"<code>make_store_path(type_prefix: str, inner_hash: bytes, name: str) -&gt; str</code>","text":"<p>\uc800\uc218\uc900 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c \uacc4\uc0b0. \ub300\ubd80\ubd84\uc758 \ud638\ucd9c\uc790\ub294 \uc544\ub798\uc758 \ud0c0\uc785\ubcc4 \ud5ec\ud37c\ub97c \uc0ac\uc6a9\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <p>\ud551\uac70\ud504\ub9b0\ud2b8 <code>&lt;type&gt;:sha256:&lt;hex&gt;:/nix/store:&lt;name&gt;</code>\uc744 \uacc4\uc0b0\ud558\uace0, SHA-256\uc73c\ub85c \ud574\uc2f1\ud55c \ub4a4, 20\ubc14\uc774\ud2b8\ub85c XOR-\ud3f4\ub4dc\ud558\uace0, Nix base32\ub85c \uc778\ucf54\ub529\ud569\ub2c8\ub2e4.</p> <pre><code>from pix.store_path import make_store_path\nfrom pix.hash import sha256\n\nh = sha256(b\"some content\")\npath = make_store_path(\"text\", h, \"example.txt\")\n</code></pre>"},{"location":"ko/api/store_path/#make_text_store_pathname-str-content-bytes-references-liststr-none-none-str","title":"<code>make_text_store_path(name: str, content: bytes, references: list[str] | None = None) -&gt; str</code>","text":"<p>\ud14d\uc2a4\ud2b8 \ud30c\uc77c\uc758 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c. <code>builtins.toFile</code> \ub610\ub294 <code>pkgs.writeText</code>\uc640 \ub3d9\uc77c\ud569\ub2c8\ub2e4.</p> <p>\ub0b4\ubd80 \ud574\uc2dc\ub294 <code>sha256(content)</code>\uc785\ub2c8\ub2e4. \ud0c0\uc785 \ud504\ub9ac\ud53d\uc2a4\ub294 \ucc38\uc870\uac00 \ucd94\uac00\ub41c <code>text</code>\uc785\ub2c8\ub2e4.</p> <pre><code>from pix.store_path import make_text_store_path\n\n# \ub2e8\uc21c \ud14d\uc2a4\ud2b8 \ud30c\uc77c\npath = make_text_store_path(\"hello.txt\", b\"hello world\")\n# '/nix/store/qbfcv31xi1wjisxwl4b2nk1a8jqxbcf5-hello.txt'\n\n# \ub2e4\ub978 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c\ub97c \ucc38\uc870\ud558\ub294 \ud14d\uc2a4\ud2b8 \ud30c\uc77c\npath = make_text_store_path(\n    \"script.sh\",\n    b\"#!/bin/sh\\nexec /nix/store/...-bash/bin/bash\",\n    references=[\"/nix/store/...-bash\"]\n)\n</code></pre>"},{"location":"ko/api/store_path/#make_source_store_pathname-str-nar_hash-bytes-references-liststr-none-none-str","title":"<code>make_source_store_path(name: str, nar_hash: bytes, references: list[str] | None = None) -&gt; str</code>","text":"<p>\uc18c\uc2a4 \ub514\ub809\ud130\ub9ac \ub610\ub294 \ud30c\uc77c\uc758 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c. Nix\uc5d0\uc11c <code>builtins.path</code>, <code>filterSource</code>, \ub610\ub294 \uacbd\ub85c \uc784\ud3ec\ud2b8(<code>./foo</code>)\ub97c \uc0ac\uc6a9\ud560 \ub54c \uc77c\uc5b4\ub098\ub294 \uac83\uc785\ub2c8\ub2e4.</p> <p>\ub0b4\ubd80 \ud574\uc2dc\ub294 NAR \uc9c1\ub82c\ud654\uc758 SHA-256\uc785\ub2c8\ub2e4.</p> <pre><code>from pix.store_path import make_source_store_path\nfrom pix.nar import nar_hash\n\nh = nar_hash(\"./my-project\")\npath = make_source_store_path(\"my-project\", h)\n</code></pre>"},{"location":"ko/api/store_path/#make_fixed_output_pathname-str-hash_algo-str-content_hash-bytes-recursive-bool-false-str","title":"<code>make_fixed_output_path(name: str, hash_algo: str, content_hash: bytes, recursive: bool = False) -&gt; str</code>","text":"<p>\uace0\uc815 \ucd9c\ub825 derivation \uacb0\uacfc\uc758 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c (<code>fetchurl</code>, <code>fetchgit</code> \ub4f1).</p> <pre><code>from pix.store_path import make_fixed_output_path\n\n# \ud50c\ub7ab \ud30c\uc77c (sha256\ub97c \uc0ac\uc6a9\ud558\ub294 fetchurl)\npath = make_fixed_output_path(\"source.tar.gz\", \"sha256\", hash_bytes)\n\n# \uc7ac\uadc0\uc801 (fetchgit, fetchFromGitHub)\npath = make_fixed_output_path(\"source\", \"sha256\", nar_hash_bytes, recursive=True)\n</code></pre> <p>\ucc38\uace0</p> <p><code>recursive=True</code>\uc640 <code>sha256</code>\uc758 \uc870\ud569\uc5d0\uc11c\ub294 \uc18c\uc2a4 \uacbd\ub85c\ub85c \uc9c1\uc811 \uacc4\uc0b0\ub429\ub2c8\ub2e4 (<code>make_source_store_path</code>\uc640 \ub3d9\uc77c). \ub2e4\ub978 \uc870\ud569\uc5d0\uc11c\ub294 \uc911\uac04 \ud574\uc2dc\uac00 \uba3c\uc800 \uacc4\uc0b0\ub429\ub2c8\ub2e4.</p>"},{"location":"ko/api/store_path/#make_output_pathdrv_hash-bytes-output_name-str-name-str-str","title":"<code>make_output_path(drv_hash: bytes, output_name: str, name: str) -&gt; str</code>","text":"<p>derivation\uc758 \ubaa8\ub4c8\ub7ec \ud574\uc2dc(<code>hash_derivation_modulo</code>\uc5d0\uc11c \uc5bb\uc740)\ub97c \uae30\ubc18\uc73c\ub85c \ud55c derivation \ucd9c\ub825\uc758 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c.</p> <pre><code>from pix.store_path import make_output_path\n\npath = make_output_path(drv_hash, \"out\", \"hello-2.12.2\")\n</code></pre>"},{"location":"ko/internals/","title":"\ub0b4\ubd80 \uad6c\uc870","text":"<p>Nix\uac00 \uc2e4\uc81c\ub85c \uc5b4\ub5bb\uac8c \ub3d9\uc791\ud558\ub294\uc9c0 \u2014 \ud615\uc2dd, \ud504\ub85c\ud1a0\ucf5c, \uc54c\uace0\ub9ac\uc998\uc744 \uc774\ub97c \uc7ac\uad6c\ud604\ud55c Python \ucf54\ub4dc\ub97c \ud1b5\ud574 \uc124\uba85\ud569\ub2c8\ub2e4.</p> <p>\uac01 \ud398\uc774\uc9c0\ub294 \uac1c\ub150 \uc124\uba85\uacfc \uc774\ub97c \uad6c\ud604\ud558\ub294 pix \uc18c\uc2a4 \ucf54\ub4dc\uc5d0 \ub300\ud55c \uc548\ub0b4\ub97c \ud568\uaed8 \uc81c\uacf5\ud569\ub2c8\ub2e4. \ud398\uc774\uc9c0\ub97c \uc77d\uc740 \ub2e4\uc74c \ucf54\ub4dc\ub97c \uc77d\uc73c\uba74 \uc774\ud574\uac00 \ub420 \uac83\uc785\ub2c8\ub2e4.</p>"},{"location":"ko/internals/#_2","title":"\uc5ec\uae30\uc11c \uc2dc\uc791\ud558\uc138\uc694","text":"\ud398\uc774\uc9c0 \ub2f5\ud558\ub294 \uc9c8\ubb38 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c Nix\ub294 <code>/nix/store/&lt;hash&gt;-&lt;name&gt;</code>\uc744 \uc5b4\ub5bb\uac8c \uacc4\uc0b0\ud558\ub098? \uc65c 32\uc790\uc778\uac00? NAR \ud615\uc2dd NAR \uc544\uce74\uc774\ube0c \uc548\uc5d0\ub294 \ubb34\uc5c7\uc774 \uc788\ub098? \uc65c tar\uac00 \uc544\ub2cc\uac00? \ub370\ubaac \ud504\ub85c\ud1a0\ucf5c <code>nix build</code>\uc640 <code>nix-store</code>\ub294 \ub370\ubaac\uacfc \uc5b4\ub5bb\uac8c \ud1b5\uc2e0\ud558\ub098? Derivation <code>.drv</code> \ud30c\uc77c\uc5d0\ub294 \ubb34\uc5c7\uc774 \uc788\ub098? <code>hashDerivationModulo</code>\ub294 \uc21c\ud658 \uc758\uc874\uc131\uc744 \uc5b4\ub5bb\uac8c \ud574\uacb0\ud558\ub098? Base32 \uc778\ucf54\ub529 Nix\ub294 \uc65c \ud45c\uc900 base32\ub97c \uc0ac\uc6a9\ud558\uc9c0 \uc54a\ub098? \ubb34\uc5c7\uc774 \ub2e4\ub978\uac00?"},{"location":"ko/internals/#_3","title":"\uc804\uccb4 \uadf8\ub9bc","text":"<p><code>nix build nixpkgs#hello</code>\ub97c \uc2e4\ud589\ud558\uba74, pix\uac00 \ub2e4\ub8e8\ub294 \uc218\uc900\uc5d0\uc11c \ub2e4\uc74c\uacfc \uac19\uc740 \uc77c\uc774 \uc77c\uc5b4\ub0a9\ub2c8\ub2e4:</p> <pre><code>1. Nix\uac00 \ud45c\ud604\uc2dd\uc744 \ud3c9\uac00 \u2192 Derivation \uc0dd\uc131\n\n2. Derivation\uc740 ATerm\uc73c\ub85c \uc9c1\ub82c\ud654\ub418\uc5b4 .drv \ud30c\uc77c\ub85c \uc800\uc7a5\n   (derivation.py\ub85c \uc774\ub97c \ub2e4\uc2dc \ud30c\uc2f1\ud560 \uc218 \uc788\uc74c)\n\n3. .drv\uc758 \ucd9c\ub825 \uacbd\ub85c\ub294 hashDerivationModulo\ub97c \ud1b5\ud574 \uacc4\uc0b0:\n   - \ucd9c\ub825 \uacbd\ub85c\ub97c \ube44\uc6b4 .drv\ub97c \ud574\uc2f1\n   - \uadf8 \ud574\uc2dc\ub97c make_store_path\uc758 \ud551\uac70\ud504\ub9b0\ud2b8\ub85c \uc0ac\uc6a9\n   (derivation.py + store_path.py)\n\n4. .drv\uac00 Unix \uc18c\ucf13 \ud504\ub85c\ud1a0\ucf5c\uc744 \ud1b5\ud574 \ub370\ubaac\uc73c\ub85c \uc804\uc1a1\n   (daemon.py\uac00 \uc774 \ud504\ub85c\ud1a0\ucf5c\uc744 \uad6c\ud604)\n\n5. \ub370\ubaac\uc774 \ube4c\ub4dc \uc218\ud589:\n   - \uc785\ub825 \uc18c\uc2a4 \uc2e4\ud604 (\uac19\uc740 \ubc29\uc2dd\uc73c\ub85c NAR \ud574\uc2dc\ub97c \uc0ac\uc6a9\ud558\uc5ec\n     \uc2a4\ud1a0\uc5b4 \uacbd\ub85c \uacc4\uc0b0 \u2014 nar.py + store_path.py)\n   - \ube4c\ub354 \uc2e4\ud589\n   - \ucd9c\ub825\uc744 \uc2a4\ud1a0\uc5b4 \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \ub4f1\ub85d\n\n6. \ub370\ubaac\uc744 \ud1b5\ud574 \uacb0\uacfc\ub97c \uc870\ud68c\ud560 \uc218 \uc788\uc74c:\n   - is_valid_path, query_path_info\n   - NAR \ud574\uc2dc\uc640 \ucc38\uc870\uac00 \uae30\ub85d\ub428\n</code></pre> <p>\uac01 \ub2e8\uacc4\uc5d0 \ub300\uc751\ud558\ub294 pix \ubaa8\ub4c8\uc774 \uc788\uc2b5\ub2c8\ub2e4. \ucf54\ub4dc\uac00 \ucda9\ubd84\ud788 \uc9e7\uc544 \uc804\uccb4 \ud750\ub984\uc744 \ucd94\uc801\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p>"},{"location":"ko/internals/base32/","title":"Nix Base32 \uc778\ucf54\ub529","text":"<p>Nix\ub294 RFC 4648\uacfc \ub2e4\ub978 \uc77c\ubc18\uc801\uc778 base32 \ubcc0\ud615\uacfc\ub3c4 \ub2e4\ub978 \ucee4\uc2a4\ud140 base32 \uc778\ucf54\ub529\uc744 \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p>"},{"location":"ko/internals/base32/#_1","title":"\uc54c\ud30c\ubcb3","text":"<pre><code>\ud45c\uc900 (RFC 4648):  A B C D E F G H I J K L M N O P Q R S T U V W X Y Z 2 3 4 5 6 7\nNix:             0 1 2 3 4 5 6 7 8 9 a b c d f g h i j k l m n p q r s v w x y z\n</code></pre> <p>Nix \uc54c\ud30c\ubcb3\uc740 32\uc790\uc785\ub2c8\ub2e4: \uc22b\uc790 <code>0-9</code>\uc640 \uc18c\ubb38\uc790, \ub2e8 <code>e</code>, <code>o</code>, <code>t</code>, <code>u</code>\uac00 \uc81c\uac70\ub418\uc5c8\uc2b5\ub2c8\ub2e4.</p> <p>\uc65c \uc774 \ub124 \uae00\uc790\uc778\uac00? \ub2e4\ub978 \ubb38\uc790\uc640 \ud63c\ub3d9\ub420 \uc218 \uc788\uae30 \ub54c\ubb38\uc785\ub2c8\ub2e4 (<code>e</code>/<code>3</code>, <code>o</code>/<code>0</code>, <code>t</code>/<code>+</code>). \uc815\ud655\ud55c \uc774\uc720\ub294 \uc5ed\uc0ac\uc801\uc778 \uac83\uc785\ub2c8\ub2e4.</p>"},{"location":"ko/internals/base32/#_2","title":"\ube44\ud2b8 \ucd94\ucd9c","text":"<p>Nix base32\uac00 RFC 4648\uacfc \uac00\uc7a5 \ud06c\uac8c \ub2e4\ub978 \ubd80\ubd84\uc785\ub2c8\ub2e4. \ube44\ud2b8 \ucd94\ucd9c \uc21c\uc11c\uac00 \ubc18\ub300\uc785\ub2c8\ub2e4.</p>"},{"location":"ko/internals/base32/#rfc-4648","title":"RFC 4648 \ubc29\uc2dd","text":"<p>\ud45c\uc900 base32\ub294 \uc785\ub825\uc744 \uc67c\ucabd\uc5d0\uc11c \uc624\ub978\ucabd\uc73c\ub85c \ucc98\ub9ac\ud558\uba70, \ucd5c\uc0c1\uc704 \ube44\ud2b8\ubd80\ud130 5\ube44\ud2b8 \uadf8\ub8f9\uc744 \uac00\uc838\uac11\ub2c8\ub2e4:</p> <pre><code>\uc785\ub825 \ubc14\uc774\ud2b8:  [b0] [b1] [b2] ...\n\ube44\ud2b8:        76543210 76543210 76543210 ...\n\uadf8\ub8f9:        |4444433333|22222|11111|00000|...\n</code></pre>"},{"location":"ko/internals/base32/#nix","title":"Nix \ubc29\uc2dd","text":"<p>Nix\ub294 \ub9c8\uc9c0\ub9c9 5\ube44\ud2b8 \uc704\uce58\uc5d0\uc11c \ucc98\uc74c\uae4c\uc9c0 \uc5ed\uc21c\uc73c\ub85c \ucc98\ub9ac\ud558\uba70, \ubc14\uc774\ud2b8 \uacbd\uacc4\ub97c \ub118\uc5b4 \ube44\ud2b8\ub97c \ucd94\ucd9c\ud569\ub2c8\ub2e4:</p> <pre><code>for i in range(out_len - 1, -1, -1):   # \ub192\uc740 \uc704\uce58\ubd80\ud130\n    b = i * 5\n    j = b // 8                          # \ubc14\uc774\ud2b8 \uc778\ub371\uc2a4\n    k = b % 8                           # \ubc14\uc774\ud2b8 \ub0b4 \ube44\ud2b8 \uc624\ud504\uc14b\n    c = (data[j] &gt;&gt; k)                  # \ubc14\uc774\ud2b8 j\uc758 \ube44\ud2b8\n    if j + 1 &lt; len(data):\n        c |= data[j + 1] &lt;&lt; (8 - k)    # \ubc14\uc774\ud2b8 j+1\uc758 \ube44\ud2b8\n    output.append(CHARS[c &amp; 0x1f])\n</code></pre> <p>\uc774\uac83\uc758 \uc758\ubbf8:</p> <ul> <li>\uccab \ubc88\uc9f8 \ucd9c\ub825 \ubb38\uc790\uac00 \uac00\uc7a5 \ub192\uc740 5\ube44\ud2b8 \uadf8\ub8f9\uc744 \uc778\ucf54\ub529</li> <li>\ube44\ud2b8\ub294 \ub9ac\ud2c0\uc5d4\ub514\uc548 \ubc14\uc774\ud2b8 \uc21c\uc11c\ub85c \uc785\ub825\uc5d0\uc11c \ucd94\ucd9c</li> <li>\ubc14\uc774\ud2b8 \uac04 \ucd94\ucd9c: 5\ube44\ud2b8 \uadf8\ub8f9\uc774 \uc778\uc811\ud55c \ub450 \uc785\ub825 \ubc14\uc774\ud2b8\uc5d0 \uac78\uce60 \uc218 \uc788\uc74c</li> </ul>"},{"location":"ko/internals/base32/#_3","title":"\uacb0\uacfc","text":"<p>\uac19\uc740 \uc785\ub825 \ubc14\uc774\ud2b8\uc5d0 \ub300\ud574 \uc54c\ud30c\ubcb3\uc744 \ubc14\uafb8\ub354\ub77c\ub3c4 RFC 4648\uacfc Nix base32\ub294 \uc644\uc804\ud788 \ub2e4\ub978 \ucd9c\ub825\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4. \uc778\ucf54\ub529\uc774 \uad6c\uc870\uc801\uc73c\ub85c \ub2e4\ub974\uba70, \ub2e8\uc21c\ud55c \uc54c\ud30c\ubcb3 \uce58\ud658\uc774 \uc544\ub2d9\ub2c8\ub2e4.</p>"},{"location":"ko/internals/base32/#_4","title":"\ucd9c\ub825 \uae38\uc774","text":"<p><code>n</code> \uc785\ub825 \ubc14\uc774\ud2b8\uc5d0 \ub300\ud574 \ucd9c\ub825\uc740 <code>ceil(n * 8 / 5)</code> \ubb38\uc790\uc785\ub2c8\ub2e4:</p> \uc785\ub825 \ubc14\uc774\ud2b8 \ucd9c\ub825 \ubb38\uc790 \uc6a9\ub3c4 0 0 \u2014 16 26 MD5 (Nix\uc5d0\uc11c \ubbf8\uc0ac\uc6a9) 20 32 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c \ud574\uc2dc 32 52 SHA-256 \ud574\uc2dc 64 103 SHA-512 \ud574\uc2dc"},{"location":"ko/internals/base32/#_5","title":"\ub514\ucf54\ub529","text":"<p>\ub514\ucf54\ub529\uc740 \uacfc\uc815\uc744 \uc5ed\uc21c\uc73c\ub85c \ud569\ub2c8\ub2e4: \uc785\ub825 \ubb38\uc790\uc5f4\uc744 \uc5ed\uc21c\uc73c\ub85c \uc21c\ud68c\ud558\uba70, \ucd9c\ub825 \ubc14\uc774\ud2b8 \ubc30\uc5f4\uc758 \uc801\uc808\ud55c \uc704\uce58\uc5d0 5\ube44\ud2b8 \uadf8\ub8f9\uc744 \ubc30\uce58\ud569\ub2c8\ub2e4.</p> <pre><code>for i, ch in enumerate(reversed(s)):\n    digit = ALPHABET.index(ch)\n    b = i * 5\n    j = b // 8\n    k = b % 8\n    result[j] |= (digit &lt;&lt; k) &amp; 0xFF\n    carry = digit &gt;&gt; (8 - k)\n    if carry and j + 1 &lt; out_len:\n        result[j + 1] |= carry\n</code></pre>"},{"location":"ko/internals/base32/#_6","title":"\ube44\uad50 \ud45c","text":"\uc18d\uc131 RFC 4648 Nix \uc54c\ud30c\ubcb3 <code>A-Z2-7</code> <code>0-9a-z</code>\uc5d0\uc11c <code>eotu</code> \uc81c\uac70 \ud328\ub529 <code>=</code>\ub85c 8\uc790 \ubc30\uc218\uae4c\uc9c0 \ud328\ub529 \ud328\ub529 \uc5c6\uc74c \ube44\ud2b8 \uc21c\uc11c MSB \uc6b0\uc120, \uc67c\ucabd\uc5d0\uc11c \uc624\ub978\ucabd LSB \uc6b0\uc120, \uc624\ub978\ucabd\uc5d0\uc11c \uc67c\ucabd \ub300\uc18c\ubb38\uc790 \ub300\uc18c\ubb38\uc790 \ubb34\uad00 \uc18c\ubb38\uc790\ub9cc \ubc14\uc774\ud2b8 \uc21c\uc11c \ube45\uc5d4\ub514\uc548 \uadf8\ub8f9 \ub9ac\ud2c0\uc5d4\ub514\uc548 \uadf8\ub8f9"},{"location":"ko/internals/base32/#_7","title":"\uc608\uc81c","text":"<p><code>\"hello\"</code>\uc758 SHA-256:</p> <pre><code>Hex:        2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824\nNix base32: 094qif9n4cq4fdg459qzbhg1c6wywawwaaivx0k0x8xhbyx4vwic\n</code></pre> <p>\uac19\uc740 \ubc14\uc774\ud2b8\ub97c RFC 4648 base32\ub85c \uc778\ucf54\ub529\ud558\uba74 \uc644\uc804\ud788 \ub2e4\ub978 (\uadf8\ub9ac\uace0 \ud328\ub529\uc774 \uc788\ub294 \ub354 \uae34) \ubb38\uc790\uc5f4\uc774 \uc0dd\uc131\ub429\ub2c8\ub2e4.</p>"},{"location":"ko/internals/daemon-protocol/","title":"Nix \ub370\ubaac \ud504\ub85c\ud1a0\ucf5c","text":"<p>Nix \ub370\ubaac (<code>nix-daemon</code>)\uc740 Unix \ub3c4\uba54\uc778 \uc18c\ucf13\uc5d0\uc11c \uc218\uc2e0 \ub300\uae30\ud558\uba70 \ud074\ub77c\uc774\uc5b8\ud2b8\uc5d0 \uc2a4\ud1a0\uc5b4 \uc624\ud37c\ub808\uc774\uc158\uc744 \uc81c\uacf5\ud569\ub2c8\ub2e4. pix\ub294 \uc774 \ud504\ub85c\ud1a0\ucf5c\uc758 \ud074\ub77c\uc774\uc5b8\ud2b8\ub97c \uc21c\uc218 Python\uc73c\ub85c \uad6c\ud604\ud569\ub2c8\ub2e4.</p>"},{"location":"ko/internals/daemon-protocol/#_1","title":"\uc5f0\uacb0","text":"<p>\uc18c\ucf13 \uacbd\ub85c: <code>/nix/var/nix/daemon-socket/socket</code></p> <p><code>SOCK_STREAM</code> Unix \ub3c4\uba54\uc778 \uc18c\ucf13\uc785\ub2c8\ub2e4. \uac01 \ud074\ub77c\uc774\uc5b8\ud2b8\ub294 \uc21c\ucc28\uc801 \uc694\uccad/\uc751\ub2f5 \uad50\ud658\uc744 \uc704\ud55c \uc804\uc6a9 \uc5f0\uacb0\uc744 \ubc1b\uc2b5\ub2c8\ub2e4.</p>"},{"location":"ko/internals/daemon-protocol/#_2","title":"\uc640\uc774\uc5b4 \ud615\uc2dd","text":"<p>\uc640\uc774\uc5b4\uc758 \ubaa8\ub4e0 \uac12\uc740 \ub9ac\ud2c0\uc5d4\ub514\uc548 \uc778\ucf54\ub529\uc744 \uc0ac\uc6a9\ud558\uba70, 8\ubc14\uc774\ud2b8 \uacbd\uacc4\ub85c \ud328\ub529\ub429\ub2c8\ub2e4:</p> \ud0c0\uc785 \uc778\ucf54\ub529 <code>uint64</code> 8\ubc14\uc774\ud2b8, \ub9ac\ud2c0\uc5d4\ub514\uc548 <code>bool</code> uint64 (0 = false, 0\uc774 \uc544\ub2cc \uac12 = true) <code>string</code> uint64(\uae38\uc774) + \ubc14\uc774\ud2b8 + 8\ubc14\uc774\ud2b8\uae4c\uc9c0 \uc81c\ub85c \ud328\ub529 <code>string list</code> uint64(\uac1c\uc218) + \uac1c\uc218 \u00d7 string <p>NAR \ud615\uc2dd\uacfc \uac19\uc740 \ubb38\uc790\uc5f4 \uc778\ucf54\ub529\uc785\ub2c8\ub2e4.</p>"},{"location":"ko/internals/daemon-protocol/#_3","title":"\ud578\ub4dc\uc170\uc774\ud06c","text":"<pre><code>\ud074\ub77c\uc774\uc5b8\ud2b8                                       \ub370\ubaac\n  \u2502                                               \u2502\n  \u251c\u2500\u2500\u2500 uint64(WORKER_MAGIC_1 = 0x6e697863) \u2500\u2500\u2500\u2500\u2500&gt;\u2502\n  \u2502                                               \u2502\n  \u2502&lt;\u2500\u2500 uint64(WORKER_MAGIC_2 = 0x6478696f) \u2500\u2500\u2500\u2500\u2500\u2500\u2524\n  \u2502&lt;\u2500\u2500 uint64(daemon_protocol_version) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n  \u2502                                               \u2502\n  \u251c\u2500\u2500\u2500 uint64(client_protocol_version) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt;\u2502\n  \u251c\u2500\u2500\u2500 uint64(0)  [CPU \uce5c\ud654\uc131, \ud3d0\uae30\ub428] \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt;\u2502\n  \u251c\u2500\u2500\u2500 uint64(0)  [\uacf5\uac04 \uc608\uc57d, \ud3d0\uae30\ub428] \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt;\u2502\n  \u2502                                               \u2502\n  \u2502&lt;\u2500\u2500 string(nix_version)  [proto &gt;= 1.33] \u2500\u2500\u2500\u2500\u2500\u2524\n  \u2502&lt;\u2500\u2500 uint64(trusted)      [proto &gt;= 1.35] \u2500\u2500\u2500\u2500\u2500\u2524\n  \u2502                                               \u2502\n  \u2502&lt;\u2500\u2500 STDERR_LAST \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n  \u2502                                               \u2502\n</code></pre> <p>\ub9e4\uc9c1 \ub118\ubc84:</p> \uc0c1\uc218 \uac12 ASCII <code>WORKER_MAGIC_1</code> <code>0x6e697863</code> <code>nixc</code> <code>WORKER_MAGIC_2</code> <code>0x6478696f</code> <code>dxio</code> <p>\ud504\ub85c\ud1a0\ucf5c \ubc84\uc804\uc740 <code>(major &lt;&lt; 8) | minor</code>\ub85c \uc778\ucf54\ub529\ub429\ub2c8\ub2e4. pix\ub294 \ubc84\uc804 <code>1.37</code> = <code>0x0125</code> = <code>293</code>\uc744 \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p> <p>\uc2e0\ub8b0 \uc0c1\ud0dc (\ud504\ub85c\ud1a0\ucf5c &gt;= 1.35):</p> \uac12 \uc758\ubbf8 0 \uc54c \uc218 \uc5c6\uc74c 1 \uc2e0\ub8b0\ub428 2 \uc2e0\ub8b0\ub418\uc9c0 \uc54a\uc74c"},{"location":"ko/internals/daemon-protocol/#_4","title":"\uc694\uccad/\uc751\ub2f5 \ud328\ud134","text":"<p>\ud578\ub4dc\uc170\uc774\ud06c \ud6c4 \uac01 \uc624\ud37c\ub808\uc774\uc158\uc740 \ub2e4\uc74c \ud328\ud134\uc744 \ub530\ub985\ub2c8\ub2e4:</p> <pre><code>\ud074\ub77c\uc774\uc5b8\ud2b8                                       \ub370\ubaac\n  \u2502                                               \u2502\n  \u251c\u2500\u2500\u2500 uint64(opcode) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt;\u2502\n  \u251c\u2500\u2500\u2500 &lt;\uc624\ud37c\ub808\uc774\uc158\ubcc4 \ub370\uc774\ud130&gt; \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt;\u2502\n  \u2502                                               \u2502\n  \u2502&lt;\u2500\u2500 stderr \uba54\uc2dc\uc9c0 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n  \u2502&lt;\u2500\u2500 STDERR_LAST \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n  \u2502&lt;\u2500\u2500 &lt;\uc624\ud37c\ub808\uc774\uc158\ubcc4 \uc751\ub2f5&gt; \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n  \u2502                                               \u2502\n</code></pre>"},{"location":"ko/internals/daemon-protocol/#stderr","title":"Stderr \uba54\uc2dc\uc9c0 \uc2a4\ud2b8\ub9bc","text":"<p>\uc694\uccad\uacfc \uc751\ub2f5 \uc0ac\uc774\uc5d0 \ub370\ubaac\uc740 \ub85c\uadf8 \uba54\uc2dc\uc9c0 \uc2a4\ud2b8\ub9bc\uc744 \ubcf4\ub0c5\ub2c8\ub2e4. \uc751\ub2f5\uc744 \uc77d\uae30 \uc804\uc5d0 \ud074\ub77c\uc774\uc5b8\ud2b8\ub294 \uc774\ub97c \ubc18\ub4dc\uc2dc \uc18c\uc9c4(drain)\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <p>\uac01 \uba54\uc2dc\uc9c0\ub294 uint64 \uba54\uc2dc\uc9c0 \ud0c0\uc785\uc73c\ub85c \uc2dc\uc791\ud569\ub2c8\ub2e4:</p> \ud0c0\uc785 \uac12 \ub0b4\uc6a9 <code>STDERR_LAST</code> <code>0x616c7473</code> \uc2a4\ud2b8\ub9bc \ub05d \u2014 \ub2e4\uc74c\uc5d0 \uc751\ub2f5\uc744 \uc77d\uc74c <code>STDERR_NEXT</code> <code>0x6f6c6d67</code> \ub85c\uadf8 \uc904: <code>string(message)</code> <code>STDERR_ERROR</code> <code>0x63787470</code> \uc624\ub958: <code>string(type) uint64(level) string(name) string(msg) uint64(n_traces) {uint64(pos) string(trace)}*</code> <code>STDERR_START_ACTIVITY</code> <code>0x53545254</code> \ud65c\ub3d9 \uc2dc\uc791: <code>uint64(id) uint64(level) uint64(type) string(text) fields uint64(parent)</code> <code>STDERR_STOP_ACTIVITY</code> <code>0x53544f50</code> \ud65c\ub3d9 \uc885\ub8cc: <code>uint64(id)</code> <code>STDERR_RESULT</code> <code>0x52534c54</code> \ud65c\ub3d9 \uacb0\uacfc: <code>uint64(id) uint64(type) fields</code> <p>\ud544\ub4dc (\ud65c\ub3d9 \uba54\uc2dc\uc9c0\uc5d0\uc11c \uc0ac\uc6a9):</p> <pre><code>uint64(count)\n{\n  uint64(type)     0 = uint64 \uac12, 1 = string \uac12\n  &lt;value&gt;\n}*\n</code></pre> <p>\ubc18\ub4dc\uc2dc stderr\ub97c \uc18c\uc9c4\ud574\uc57c \ud568</p> <p>\uc624\ud37c\ub808\uc774\uc158 \uc751\ub2f5\uc744 \uc77d\uae30 \uc804\uc5d0 <code>STDERR_LAST</code>\uae4c\uc9c0 \ubaa8\ub4e0 stderr \uba54\uc2dc\uc9c0\ub97c \ubc18\ub4dc\uc2dc \uc77d\uc5b4\uc57c \ud569\ub2c8\ub2e4. \uadf8\ub807\uc9c0 \uc54a\uc73c\uba74 \ud504\ub85c\ud1a0\ucf5c\uc774 \ube44\ub3d9\uae30\ud654\ub429\ub2c8\ub2e4.</p>"},{"location":"ko/internals/daemon-protocol/#_5","title":"\uc624\ud37c\ub808\uc774\uc158","text":""},{"location":"ko/internals/daemon-protocol/#isvalidpath-opcode-1","title":"<code>IsValidPath</code> (opcode 1)","text":"<p>\uc2a4\ud1a0\uc5b4 \uacbd\ub85c\uac00 \uc720\ud6a8\ud55c\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p> <pre><code>\uc694\uccad:  string(path)\n\uc751\ub2f5: bool(valid)\n</code></pre>"},{"location":"ko/internals/daemon-protocol/#addtexttostore-opcode-8","title":"<code>AddTextToStore</code> (opcode 8)","text":"<p>\ud14d\uc2a4\ud2b8 \ud30c\uc77c\uc744 \uc2a4\ud1a0\uc5b4\uc5d0 \ucd94\uac00\ud569\ub2c8\ub2e4.</p> <pre><code>\uc694\uccad:  string(name) string(content) string_list(references)\n\uc751\ub2f5: string(store_path)\n</code></pre>"},{"location":"ko/internals/daemon-protocol/#buildpaths-opcode-9","title":"<code>BuildPaths</code> (opcode 9)","text":"<p>\ud558\ub098 \uc774\uc0c1\uc758 \uacbd\ub85c\ub97c \ube4c\ub4dc\ud569\ub2c8\ub2e4.</p> <pre><code>\uc694\uccad:  string_list(paths) uint64(build_mode)\n\uc751\ub2f5: uint64(result)\n</code></pre> <p>\ube4c\ub4dc \ubaa8\ub4dc: 0 = \uc77c\ubc18, 1 = \uc218\ub9ac, 2 = \uac80\uc0ac.</p> <p>\uacbd\ub85c\ub294 \ubd88\ud22c\uba85 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c\uc774\uac70\ub098 derivation \ucd9c\ub825\uc744 \uc704\ud55c <code>&lt;drv-path&gt;^&lt;output&gt;</code>\uc77c \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p>"},{"location":"ko/internals/daemon-protocol/#querypathinfo-opcode-26","title":"<code>QueryPathInfo</code> (opcode 26)","text":"<p>\uc2a4\ud1a0\uc5b4 \uacbd\ub85c\uc758 \uba54\ud0c0\ub370\uc774\ud130\ub97c \uc870\ud68c\ud569\ub2c8\ub2e4.</p> <pre><code>\uc694\uccad:  string(path)\n\uc751\ub2f5: bool(valid)\n          [valid\uc778 \uacbd\uc6b0:]\n          string(deriver)\n          string(nar_hash)\n          string_list(references)\n          uint64(registration_time)\n          uint64(nar_size)\n          bool(ultimate)\n          string_list(sigs)\n          string(content_address)\n</code></pre>"},{"location":"ko/internals/daemon-protocol/#queryvalidpaths-opcode-31","title":"<code>QueryValidPaths</code> (opcode 31)","text":"<p>\ubc30\uce58 \uc720\ud6a8\uc131 \ud655\uc778.</p> <pre><code>\uc694\uccad:  string_list(paths) bool(substitute)\n\uc751\ub2f5: string_list(valid_paths)\n</code></pre>"},{"location":"ko/internals/daemon-protocol/#_6","title":"\ud504\ub85c\ud1a0\ucf5c \ubc84\uc804 \ud788\uc2a4\ud1a0\ub9ac","text":"\ubc84\uc804 \ubcc0\uacbd \uc0ac\ud56d 1.11 \ud578\ub4dc\uc170\uc774\ud06c\uc5d0 \uacf5\uac04 \uc608\uc57d \ud50c\ub798\uadf8 1.14 \ud578\ub4dc\uc170\uc774\ud06c\uc5d0 CPU \uce5c\ud654\uc131 1.16 \uacbd\ub85c \uc815\ubcf4\uc5d0 <code>ultimate</code> \ud50c\ub798\uadf8 1.17 <code>QueryPathInfo</code>\uac00 \uc608\uc678 \ub300\uc2e0 \uc720\ud6a8\uc131 bool \ubc18\ud658 1.25 \uacbd\ub85c \uc815\ubcf4\uc5d0 \ucf58\ud150\uce20 \uc8fc\uc18c \ud544\ub4dc 1.30 <code>BuildPaths</code>\uc5d0 DerivedPath \uc9c1\ub82c\ud654 1.33 \ud578\ub4dc\uc170\uc774\ud06c \ud6c4 \ub370\ubaac\uc774 nix \ubc84\uc804 \ubb38\uc790\uc5f4 \uc804\uc1a1 1.35 \ud578\ub4dc\uc170\uc774\ud06c \ud6c4 \ub370\ubaac\uc774 \uc2e0\ub8b0 \uc0c1\ud0dc \uc804\uc1a1 1.37 pix\uac00 \uc0ac\uc6a9\ud558\ub294 \ud604\uc7ac \ubc84\uc804"},{"location":"ko/internals/derivations/","title":"Derivation","text":"<p>Derivation\uc740 Nix\uc758 \ube4c\ub4dc \ub2e8\uc704\uc785\ub2c8\ub2e4. \uc785\ub825, \ube4c\ub354, \ud658\uacbd \ubcc0\uc218\ub85c\ubd80\ud130 \ud558\ub098 \uc774\uc0c1\uc758 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c\ub97c \uc0dd\uc131\ud558\ub294 \ubc29\ubc95\uc744 \uc124\uba85\ud569\ub2c8\ub2e4. Derivation\uc740 Nix \uc2a4\ud1a0\uc5b4\uc5d0 ATerm \ud615\uc2dd\uc758 <code>.drv</code> \ud30c\uc77c\ub85c \uc800\uc7a5\ub429\ub2c8\ub2e4.</p>"},{"location":"ko/internals/derivations/#aterm","title":"ATerm \ud615\uc2dd","text":"<p><code>.drv</code> \ud30c\uc77c\uc740 \ub2e8\uc77c ATerm \ud45c\ud604\uc2dd\uc785\ub2c8\ub2e4:</p> <pre><code>Derive(\n  [(\"out\",\"/nix/store/...-hello\",\"\",\"\"), ...],       # \ucd9c\ub825\n  [(\"/nix/store/...-dep.drv\",[\"out\"]), ...],         # \uc785\ub825 derivation\n  [\"/nix/store/...-source\", ...],                    # \uc785\ub825 \uc18c\uc2a4\n  \"x86_64-linux\",                                    # \ud50c\ub7ab\ud3fc\n  \"/nix/store/...-bash/bin/bash\",                    # \ube4c\ub354\n  [\"--\", \"-e\", \"...\"],                               # \uc778\uc790\n  [(\"key\",\"value\"), ...]                             # \ud658\uacbd\n)\n</code></pre>"},{"location":"ko/internals/derivations/#_1","title":"\ud544\ub4dc","text":"# \ud544\ub4dc \ud0c0\uc785 \uc124\uba85 1 outputs <code>[(name, path, hashAlgo, hash)]</code> \ucd9c\ub825 \uc774\ub984-\uacbd\ub85c \ub9e4\ud551 2 inputDrvs <code>[(drvPath, [outputNames])]</code> Derivation \uc758\uc874\uc131 3 inputSrcs <code>[path]</code> \uc18c\uc2a4 \ud30c\uc77c \uc758\uc874\uc131 4 platform <code>string</code> \ube4c\ub4dc \ud50c\ub7ab\ud3fc (\uc608: <code>x86_64-linux</code>) 5 builder <code>string</code> \ube4c\ub354 \uc2e4\ud589 \ud30c\uc77c \uacbd\ub85c 6 args <code>[string]</code> \ube4c\ub354 \uba85\ub839\uc904 \uc778\uc790 7 env <code>[(key, value)]</code> \ube4c\ub354\uc758 \ud658\uacbd \ubcc0\uc218"},{"location":"ko/internals/derivations/#_2","title":"\ucd9c\ub825","text":"<p>\uac01 \ucd9c\ub825\uc740 4-\ud29c\ud50c\uc785\ub2c8\ub2e4:</p> <pre><code>(\"name\", \"path\", \"hashAlgo\", \"hash\")\n</code></pre> \ud544\ub4dc \uc77c\ubc18 \ucd9c\ub825 \uace0\uc815 \ucd9c\ub825 <code>name</code> <code>\"out\"</code>, <code>\"lib\"</code>, <code>\"dev\"</code> \ub4f1 <code>\"out\"</code> <code>path</code> <code>/nix/store/...-name</code> <code>/nix/store/...-name</code> <code>hashAlgo</code> <code>\"\"</code> <code>\"sha256\"</code>, <code>\"r:sha256\"</code> \ub4f1 <code>hash</code> <code>\"\"</code> \uae30\ub300 \ucf58\ud150\uce20\uc758 16\uc9c4\uc218 \ud574\uc2dc <p><code>hashAlgo</code>\uc758 <code>r:</code> \ud504\ub9ac\ud53d\uc2a4\ub294 \uc7ac\uadc0\uc801 (NAR \ud574\uc2dc)\uc744 \uc758\ubbf8\ud569\ub2c8\ub2e4. \uc5c6\uc73c\uba74 \ud50c\ub7ab \ud30c\uc77c \ucf58\ud150\uce20\uc758 \ud574\uc2dc\uc785\ub2c8\ub2e4.</p>"},{"location":"ko/internals/derivations/#_3","title":"\ubb38\uc790\uc5f4 \uc774\uc2a4\ucf00\uc774\ud504","text":"<p>ATerm\uc758 \ubb38\uc790\uc5f4\uc740 \ub2e4\uc74c \uc774\uc2a4\ucf00\uc774\ud504 \uc2dc\ud000\uc2a4\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4:</p> \uc774\uc2a4\ucf00\uc774\ud504 \ubb38\uc790 <code>\\\\</code> \ubc31\uc2ac\ub798\uc2dc <code>\\\"</code> \ud070\ub530\uc634\ud45c <code>\\n</code> \uc904\ubc14\uafc8 <code>\\r</code> \uce90\ub9ac\uc9c0 \ub9ac\ud134 <code>\\t</code> \ud0ed"},{"location":"ko/internals/derivations/#_4","title":"\uc815\ub82c","text":"<p>\uc815\uaddc \uc9c1\ub82c\ud654\uc5d0\uc11c:</p> <ul> <li>\ucd9c\ub825\uc740 \ucd9c\ub825 \uc774\ub984\uc21c \uc815\ub82c</li> <li>\uc785\ub825 derivation\uc740 <code>.drv</code> \uacbd\ub85c\uc21c \uc815\ub82c</li> <li>\uc785\ub825 \uc18c\uc2a4\ub294 \uc815\ub82c\ub428</li> <li>\ud658\uacbd \ubcc0\uc218\ub294 \ud0a4\uc21c \uc815\ub82c</li> <li>\uc778\uc790\ub294 \uc6d0\ub798 \uc21c\uc11c \uc720\uc9c0</li> </ul>"},{"location":"ko/internals/derivations/#hashderivationmodulo","title":"<code>hashDerivationModulo</code>","text":"<p>\uc774\uac83\uc740 Nix\uac00 \ucd9c\ub825 \uacbd\ub85c\ub97c \uacb0\uc815\ud558\ub294 \ud574\uc2dc\ub97c \uacc4\uc0b0\ud558\ub294 \ub370 \uc0ac\uc6a9\ud558\ub294 \uc54c\uace0\ub9ac\uc998\uc785\ub2c8\ub2e4. \uc21c\ud658 \uc758\uc874\uc131\uc744 \ud574\uacb0\ud558\uae30 \uc704\ud574 \uc874\uc7ac\ud569\ub2c8\ub2e4 \u2014 \ucd9c\ub825 \uacbd\ub85c\ub294 derivation \ud574\uc2dc\uc5d0 \uc758\uc874\ud558\uc9c0\ub9cc, derivation\uc740 \uc790\uc2e0\uc758 \ucd9c\ub825 \uacbd\ub85c\ub97c \ud3ec\ud568\ud569\ub2c8\ub2e4.</p>"},{"location":"ko/internals/derivations/#derivation_1","title":"\uace0\uc815 \ucd9c\ub825 derivation","text":"<p><code>hashAlgo</code>\uac00 \uc124\uc815\ub41c \ub2e8\uc77c \ucd9c\ub825 <code>\"out\"</code>\uc744 \uac00\uc9c4 derivation\uc758 \uacbd\uc6b0:</p> <pre><code>hash = sha256(\"fixed:out:&lt;hashAlgo&gt;:&lt;hashValue&gt;:\")\n</code></pre> <p>\uc774\uac83\uc740 \uace0\uc815 \ucd9c\ub825 derivation\uc774 \ube4c\ub4dc \uc758\uc874\uc131\uc774 \ubcc0\uacbd\ub418\uc5b4\ub3c4 \uc548\uc815\uc801\uc778 \ud574\uc2dc\ub97c \uac00\uc9c4\ub2e4\ub294 \uac83\uc744 \uc758\ubbf8\ud569\ub2c8\ub2e4 \u2014 \uae30\ub300 \ucd9c\ub825 \ud574\uc2dc\ub9cc \uc911\uc694\ud569\ub2c8\ub2e4.</p>"},{"location":"ko/internals/derivations/#derivation_2","title":"\uc77c\ubc18 derivation","text":"<p>\ub2e4\ub978 \ubaa8\ub4e0 derivation\uc758 \uacbd\uc6b0:</p> <ol> <li>\uc120\ud0dd\uc801\uc73c\ub85c \ucd9c\ub825 \uacbd\ub85c \ube44\uc6b0\uae30: <code>.outputs</code>\uc640 <code>.env</code>\uc5d0\uc11c \ucd9c\ub825 \uacbd\ub85c\ub97c <code>\"\"</code>\ub85c \ub300\uccb4 (\uc544\ub798 \ub450 \uac00\uc9c0 \ubaa8\ub4dc \ucc38\uace0)</li> <li>\uc785\ub825 drv \uacbd\ub85c \ub300\uccb4: \uac01 \uc785\ub825 derivation\uc5d0 \ub300\ud574 <code>.drv</code> \uacbd\ub85c\ub97c \ud574\ub2f9 \uc785\ub825\uc758 16\uc9c4\uc218 \uc778\ucf54\ub529\ub41c <code>hashDerivationModulo</code>\ub85c \ub300\uccb4</li> <li>\uc9c1\ub82c\ud654: \ub9c8\uc2a4\ud06c\ub41c derivation\uc744 ATerm\uc73c\ub85c \ubcc0\ud658</li> <li>\ud574\uc2f1: <code>sha256(serialized_masked_drv)</code></li> </ol> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 \uc6d0\ubcf8 .drv                               \u2502\n\u2502                                         \u2502\n\u2502 outputs: (\"out\", \"/nix/store/abc-x\")    \u2502\n\u2502 inputDrvs: (\"/nix/store/def.drv\",[\"out\"])\u2502\n\u2502 ...                                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                   \u2502\n            \ub9c8\uc2a4\ud06c &amp; \ub300\uccb4\n                   \u2502\n                   v\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 \ub9c8\uc2a4\ud06c\ub41c .drv                            \u2502\n\u2502                                         \u2502\n\u2502 outputs: (\"out\", \"\")        \u2190 \ube44\uc6cc\uc9d0     \u2502\n\u2502 inputDrvs: (\"a1b2c3...\",[\"out\"]) \u2190 \ud574\uc2dc  \u2502\n\u2502 ...                                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                   \u2502\n            ATerm \ubb38\uc790\uc5f4\ub85c \uc9c1\ub82c\ud654\n                   \u2502\n                   v\n            sha256(aterm_string)\n                   \u2502\n                   v\n           derivation \ud574\uc2dc (32 \ubc14\uc774\ud2b8)\n</code></pre>"},{"location":"ko/internals/derivations/#two-modes-maskoutputs","title":"\ub450 \uac00\uc9c0 \ubaa8\ub4dc: <code>maskOutputs</code>","text":"<p><code>hashDerivationModulo</code>\ub294 \ucd9c\ub825 \uacbd\ub85c\ub97c \ube44\uc6b8\uc9c0 \uc5ec\ubd80\ub97c \uc81c\uc5b4\ud558\ub294 <code>maskOutputs</code> \ub9e4\uac1c\ubcc0\uc218\ub97c \ubc1b\uc2b5\ub2c8\ub2e4. Nix\ub294 \ub450 \uac00\uc9c0 \ub2e4\ub978 \ud638\ucd9c \uc9c0\uc810\uc5d0\uc11c \uc0ac\uc6a9\ud569\ub2c8\ub2e4:</p> \ud638\ucd9c \uc9c0\uc810 <code>maskOutputs</code> \ucd9c\ub825 \uacbd\ub85c \uc6a9\ub3c4 <code>staticOutputHashes</code> <code>true</code> \ube44\uc6cc\uc9d0 (<code>\"\"</code>) derivation \uc790\uc2e0\uc758 \ucd9c\ub825 \uacbd\ub85c \uacc4\uc0b0 <code>pathDerivationModulo</code> <code>false</code> \uc720\uc9c0 \uc785\ub825 derivation\uc758 \ud574\uc2dc \uacc4\uc0b0 <p>\uc774 \uad6c\ubd84\uc774 \uc911\uc694\ud569\ub2c8\ub2e4: derivation A\uac00 derivation B\uc5d0 \uc758\uc874\ud560 \ub54c, Nix\ub294 B\uc758 \ud574\uc2dc\ub97c <code>maskOutputs=false</code>\ub85c \uacc4\uc0b0\ud569\ub2c8\ub2e4 \u2014 B\uc758 \ucc44\uc6cc\uc9c4 \ucd9c\ub825 \uacbd\ub85c\uac00 A\uc758 <code>inputDrvs</code> \ud0a4\ub85c \uc0ac\uc6a9\ub418\ub294 \ud574\uc2dc\uc758 \uc77c\ubd80\uac00 \ub429\ub2c8\ub2e4. A \uc790\uc2e0\uc758 \ucd9c\ub825\ub9cc \ube44\uc6cc\uc9d1\ub2c8\ub2e4 (A\uc758 \uc21c\ud658\uc131\uc744 \ud574\uacb0\ud558\uae30 \uc704\ud574).</p> <pre><code>consumer.drv\uc758 \ucd9c\ub825 \uacbd\ub85c \uacc4\uc0b0:\n\n  dep.drv (\uc785\ub825)                consumer.drv (\uc790\uae30 \uc790\uc2e0)\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  maskOutputs = false            maskOutputs = true\n  \ucd9c\ub825 \uacbd\ub85c \uc720\uc9c0                  \ucd9c\ub825 \uacbd\ub85c \ube44\uc6cc\uc9d0\n         \u2502                              \u2502\n         v                              v\n    dep_hash (dep\uc758                 consumer_hash\n    \ucd9c\ub825 \uacbd\ub85c \ud3ec\ud568)                       \u2502\n         \u2502                              v\n         \u2514\u2500\u2500\u2500\u2500 \ub2e4\uc74c\uc73c\ub85c \uc0ac\uc6a9 \u2500\u2500&gt; inputDrvs \ud0a4\n                               consumer\uc758 \ub9c8\uc2a4\ud06c\ub41c ATerm \ub0b4\n</code></pre> <p>\ud754\ud55c \uc2e4\uc218</p> <p>\uc785\ub825 derivation\uc5d0 <code>maskOutputs=true</code>\ub97c \uc0ac\uc6a9\ud558\uba74 \uc798\ubabb\ub41c \ud574\uc2dc\uac00 \uc0dd\uc131\ub429\ub2c8\ub2e4 \u2014 \uc785\ub825\uc758 \ucd9c\ub825 \uacbd\ub85c\uac00 \uc0ac\ub77c\uc9c0\uba74\uc11c consumer\uc758 <code>inputDrvs</code> \ud0a4\uac00 \ubc14\ub00c\uace0, \uacb0\uad6d \ucd9c\ub825 \uacbd\ub85c\uac00 \ub2ec\ub77c\uc9d1\ub2c8\ub2e4. \uc774\uac83\uc774 <code>staticOutputHashes</code> (\uc790\uae30 \uc790\uc2e0\uc6a9)\uc640 <code>pathDerivationModulo</code> (\uc785\ub825\uc6a9)\uc758 \ucc28\uc774\uc785\ub2c8\ub2e4.</p>"},{"location":"ko/internals/derivations/#_5","title":"\ucd9c\ub825 \uacbd\ub85c \uacc4\uc0b0","text":"<p><code>hashDerivationModulo</code>\uc5d0\uc11c derivation \ud574\uc2dc\ub97c \uc5bb\uc73c\uba74:</p> <pre><code>from pix.store_path import make_output_path\n\noutput_path = make_output_path(drv_hash, \"out\", \"hello-2.12.2\")\n# /nix/store/&lt;hash&gt;-hello-2.12.2\n</code></pre> <p>\ud0c0\uc785 \ud504\ub9ac\ud53d\uc2a4\ub294 <code>output:&lt;output-name&gt;</code>\uc774\ubbc0\ub85c \ud551\uac70\ud504\ub9b0\ud2b8\ub294 \ub2e4\uc74c\uacfc \uac19\uc2b5\ub2c8\ub2e4:</p> <pre><code>output:out:sha256:&lt;hex(drv_hash)&gt;:/nix/store:hello-2.12.2\n</code></pre>"},{"location":"ko/internals/derivations/#_6","title":"\uc2e4\uc81c \uc608\uc81c","text":"<p>\ucd5c\uc18c derivation (<code>builtins.derivation { name = \"hello\"; builder = \"/bin/sh\"; args = [\"-c\" \"echo hello &gt; $out\"]; system = \"x86_64-linux\"; }</code>):</p> <pre><code>Derive(\n  [(\"out\",\"/nix/store/...-hello\",\"\",\"\")],\n  [],\n  [],\n  \"x86_64-linux\",\n  \"/bin/sh\",\n  [\"-c\",\"echo hello &gt; $out\"],\n  [(\"builder\",\"/bin/sh\"),\n   (\"name\",\"hello\"),\n   (\"out\",\"/nix/store/...-hello\"),\n   (\"system\",\"x86_64-linux\")]\n)\n</code></pre> <p>\ud658\uacbd\uc5d0\ub294 \uba85\uc2dc\uc801 \ud658\uacbd \ubcc0\uc218\uc640 \uc790\ub3d9\uc73c\ub85c \ucd94\uac00\ub41c \uac83\ub4e4 (<code>builder</code>, <code>out</code>, <code>system</code>, <code>name</code>)\uc774 \ubaa8\ub450 \ud3ec\ud568\ub429\ub2c8\ub2e4.</p>"},{"location":"ko/internals/nar-format/","title":"NAR \uc640\uc774\uc5b4 \ud615\uc2dd","text":"<p>NAR (Nix Archive)\uc740 Nix\uac00 \ud30c\uc77c\uc2dc\uc2a4\ud15c \ud2b8\ub9ac\ub97c \uc9c1\ub82c\ud654\ud558\ub294 \ub370 \uc0ac\uc6a9\ud558\ub294 \uacb0\uc815\ub860\uc801 \uc544\uce74\uc774\ube0c \ud615\uc2dd\uc785\ub2c8\ub2e4. \ud575\uc2ec \uc18d\uc131\uc740 \uc7ac\ud604\uc131\uc785\ub2c8\ub2e4 \u2014 \ub3d9\uc77c\ud55c \ud30c\uc77c\uc2dc\uc2a4\ud15c \ub0b4\uc6a9\uc740 \ud0c0\uc784\uc2a4\ud0ec\ud504, \uc18c\uc720\uad8c, inode \ubc88\ud638 \ub4f1 \uae30\ud0c0 \uba54\ud0c0\ub370\uc774\ud130\uc5d0 \uad00\uacc4\uc5c6\uc774 \ud56d\uc0c1 \ub3d9\uc77c\ud55c \ubc14\uc774\ud2b8 \uc2dc\ud000\uc2a4\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4.</p>"},{"location":"ko/internals/nar-format/#_1","title":"\uc640\uc774\uc5b4 \ud504\ub9ac\ubbf8\ud2f0\ube0c","text":"<p>\ubaa8\ub4e0 \ub370\uc774\ud130\ub294 \ub2e8\uc77c \ud504\ub9ac\ubbf8\ud2f0\ube0c\ub97c \uc0ac\uc6a9\ud558\uc5ec \ud504\ub808\uc774\ubc0d\ub429\ub2c8\ub2e4:</p>"},{"location":"ko/internals/nar-format/#_2","title":"\ubb38\uc790\uc5f4/\ube14\ub86d \uc778\ucf54\ub529","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 uint64_le(len)   \u2502 raw bytes (len)    \u2502 \uc81c\ub85c \ud328\ub529    \u2502\n\u2502 (8 \ubc14\uc774\ud2b8)        \u2502                    \u2502 8\ubc14\uc774\ud2b8      \u2502\n\u2502                  \u2502                    \u2502 \uacbd\uacc4\uae4c\uc9c0     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <ul> <li>\uae38\uc774\ub294 \ud56d\uc0c1 \ub9ac\ud2c0\uc5d4\ub514\uc548 uint64 (8\ubc14\uc774\ud2b8)</li> <li>\ub0b4\uc6a9\uc740 \uae38\uc774 \ubc14\ub85c \ub4a4\uc5d0 \uc704\uce58</li> <li>\ud328\ub529: 8\ubc14\uc774\ud2b8 \uc815\ub82c\uc744 \uc704\ud55c <code>(8 - len % 8) % 8</code>\uac1c\uc758 \uc81c\ub85c \ubc14\uc774\ud2b8</li> <li>\ube48 \ubb38\uc790\uc5f4: \uae38\uc774 = 0, \ub0b4\uc6a9 \ubc14\uc774\ud2b8 \uc5c6\uc74c, \ud328\ub529 \uc5c6\uc74c</li> </ul> <p>\uc608\uc81c:</p> \ubb38\uc790\uc5f4 \uae38\uc774 (16\uc9c4\uc218 LE) \ub0b4\uc6a9 \ud328\ub529 \ud569\uacc4 <code>\"\"</code> <code>00 00 00 00 00 00 00 00</code> (\uc5c6\uc74c) (\uc5c6\uc74c) 8 \ubc14\uc774\ud2b8 <code>\"(\"</code> <code>01 00 00 00 00 00 00 00</code> <code>28</code> 7\uac1c \uc81c\ub85c 16 \ubc14\uc774\ud2b8 <code>\"type\"</code> <code>04 00 00 00 00 00 00 00</code> <code>74 79 70 65</code> 4\uac1c \uc81c\ub85c 16 \ubc14\uc774\ud2b8 <code>\"regular\"</code> <code>07 00 00 00 00 00 00 00</code> <code>72 65 67 75 6c 61 72</code> 1\uac1c \uc81c\ub85c 16 \ubc14\uc774\ud2b8 <code>\"hello\"</code> <code>05 00 00 00 00 00 00 00</code> <code>68 65 6c 6c 6f</code> 3\uac1c \uc81c\ub85c 16 \ubc14\uc774\ud2b8 <p>NAR\uc758 \ubaa8\ub4e0 \ud1a0\ud070 \u2014 \ud0a4\uc6cc\ub4dc, \uc774\ub984, \ucf58\ud150\uce20 \ube14\ub86d \u2014 \uc740 \uac19\uc740 \uc778\ucf54\ub529\uc744 \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p>"},{"location":"ko/internals/nar-format/#_3","title":"\ubb38\ubc95","text":"<pre><code>nar         = str(\"nix-archive-1\") node\n\nnode        = str(\"(\") entry str(\")\")\n\nentry       = str(\"type\") (regular | symlink | directory)\n\nregular     = str(\"regular\") [str(\"executable\") str(\"\")]\n              str(\"contents\") str(&lt;file-data&gt;)\n\nsymlink     = str(\"symlink\") str(\"target\") str(&lt;target-path&gt;)\n\ndirectory   = str(\"directory\") { dir_entry }\n\ndir_entry   = str(\"entry\") str(\"(\")\n              str(\"name\") str(&lt;entry-name&gt;)\n              str(\"node\") node\n              str(\")\")\n</code></pre> <p><code>str(x)</code>\ub294 \uc704\uc5d0\uc11c \uc124\uba85\ud55c \uc640\uc774\uc5b4 \uc778\ucf54\ub529\uc785\ub2c8\ub2e4.</p>"},{"location":"ko/internals/nar-format/#_4","title":"\ud30c\uc77c \ud0c0\uc785","text":""},{"location":"ko/internals/nar-format/#_5","title":"\uc77c\ubc18 \ud30c\uc77c","text":"<pre><code>str(\"(\")\n  str(\"type\") str(\"regular\")\n  [str(\"executable\") str(\"\")]     \u2190 \uc2e4\ud589 \ube44\ud2b8\uac00 \uc124\uc815\ub41c \uacbd\uc6b0\uc5d0\ub9cc\n  str(\"contents\") str(&lt;data&gt;)\nstr(\")\")\n</code></pre> <p>\uc2e4\ud589 \ud50c\ub798\uadf8\uac00 \ubcf4\uc874\ub418\ub294 \uc720\uc77c\ud55c \ud37c\ubbf8\uc158 \uc815\ubcf4\uc785\ub2c8\ub2e4. <code>0644</code> vs <code>0755</code> \uac19\uc740 \ubaa8\ub4dc \ube44\ud2b8\ub294 \uc2e4\ud589 \uac00\ub2a5 \uc5ec\ubd80\ub85c\ub9cc \ucd95\uc18c\ub429\ub2c8\ub2e4.</p>"},{"location":"ko/internals/nar-format/#_6","title":"\uc2ec\ub9c1\ud06c","text":"<pre><code>str(\"(\")\n  str(\"type\") str(\"symlink\")\n  str(\"target\") str(&lt;target&gt;)\nstr(\")\")\n</code></pre> <p>\ub300\uc0c1\uc740 \uadf8\ub300\ub85c \uc800\uc7a5\ub429\ub2c8\ub2e4 (\ud574\uc11d\ud558\uc9c0 \uc54a\uc74c). \uc0c1\ub300 \ubc0f \uc808\ub300 \uc2ec\ub9c1\ud06c \ubaa8\ub450 \uc9c0\uc6d0\ub429\ub2c8\ub2e4.</p>"},{"location":"ko/internals/nar-format/#_7","title":"\ub514\ub809\ud130\ub9ac","text":"<pre><code>str(\"(\")\n  str(\"type\") str(\"directory\")\n  str(\"entry\") str(\"(\")\n    str(\"name\") str(\"a.txt\")\n    str(\"node\") &lt;a.txt\uc758 \uc7ac\uadc0 \ub178\ub4dc&gt;\n  str(\")\")\n  str(\"entry\") str(\"(\")\n    str(\"name\") str(\"b.txt\")\n    str(\"node\") &lt;b.txt\uc758 \uc7ac\uadc0 \ub178\ub4dc&gt;\n  str(\")\")\nstr(\")\")\n</code></pre> <p>\uc5d4\ud2b8\ub9ac\ub294 \ubc18\ub4dc\uc2dc \uc815\ub82c\ub418\uc5b4\uc57c \ud568</p> <p>\ub514\ub809\ud130\ub9ac \uc5d4\ud2b8\ub9ac\ub294 \uc774\ub984\uc21c\uc73c\ub85c \ubc18\ub4dc\uc2dc \uc0ac\uc804\uc2dd \uc815\ub82c\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4. \uc774\uac83\uc740 \uacb0\uc815\uc131\uc744 \uc704\ud574 \uc911\uc694\ud569\ub2c8\ub2e4.</p>"},{"location":"ko/internals/nar-format/#nar_1","title":"NAR\uc774 \ubcf4\uc874\ud558\ub294 \uac83","text":"\ubcf4\uc874\ub428 \ubcf4\uc874\ub418\uc9c0 \uc54a\uc74c \ud30c\uc77c \ub0b4\uc6a9 \ud0c0\uc784\uc2a4\ud0ec\ud504 (mtime, ctime, atime) \ud30c\uc77c \ud0c0\uc785 (\uc77c\ubc18, \uc2ec\ub9c1\ud06c, \ub514\ub809\ud130\ub9ac) \uc18c\uc720\uad8c (uid, gid) \uc2e4\ud589 \ube44\ud2b8 \ud37c\ubbf8\uc158 \ubaa8\ub4dc (+x \uc774\uc0c1) \uc2ec\ub9c1\ud06c \ub300\uc0c1 inode \ubc88\ud638 \ub514\ub809\ud130\ub9ac \uad6c\uc870 \ud655\uc7a5 \uc18d\uc131 \uc5d4\ud2b8\ub9ac \uc774\ub984 \ud558\ub4dc \ub9c1\ud06c (\ubcc4\ub3c4 \ud30c\uc77c\ub85c \uc9c1\ub82c\ud654)"},{"location":"ko/internals/nar-format/#_8","title":"\ud480\uc774 \uc608\uc81c","text":"<p><code>\"hello\"</code> (5\ubc14\uc774\ud2b8, \uc2e4\ud589 \ubd88\uac00)\ub97c \ud3ec\ud568\ud55c \ud30c\uc77c\uc758 NAR \uc9c1\ub82c\ud654:</p> <pre><code>\uc624\ud504\uc14b  \ubc14\uc774\ud2b8                           \uc758\ubbf8\n------  -----                           -----\n0x00    0e 00 00 00 00 00 00 00         \"nix-archive-1\"\uc758 \uae38\uc774 = 14\n0x08    6e 69 78 2d 61 72 63 68         \"nix-arch\"\n0x10    69 76 65 2d 31 00 00 00         \"ive-1\" + 2\ubc14\uc774\ud2b8 \ud328\ub529\n0x18    01 00 00 00 00 00 00 00         \"(\"\uc758 \uae38\uc774 = 1\n0x20    28 00 00 00 00 00 00 00         \"(\" + 7\ubc14\uc774\ud2b8 \ud328\ub529\n0x28    04 00 00 00 00 00 00 00         \"type\"\uc758 \uae38\uc774 = 4\n0x30    74 79 70 65 00 00 00 00         \"type\" + 4\ubc14\uc774\ud2b8 \ud328\ub529\n0x38    07 00 00 00 00 00 00 00         \"regular\"\uc758 \uae38\uc774 = 7\n0x40    72 65 67 75 6c 61 72 00         \"regular\" + 1\ubc14\uc774\ud2b8 \ud328\ub529\n0x48    08 00 00 00 00 00 00 00         \"contents\"\uc758 \uae38\uc774 = 8\n0x50    63 6f 6e 74 65 6e 74 73         \"contents\" (\ud328\ub529 \ubd88\ud544\uc694)\n0x58    05 00 00 00 00 00 00 00         \ucf58\ud150\uce20\uc758 \uae38\uc774 = 5\n0x60    68 65 6c 6c 6f 00 00 00         \"hello\" + 3\ubc14\uc774\ud2b8 \ud328\ub529\n0x68    01 00 00 00 00 00 00 00         \")\"\uc758 \uae38\uc774 = 1\n0x70    29 00 00 00 00 00 00 00         \")\" + 7\ubc14\uc774\ud2b8 \ud328\ub529\n\n\ud569\uacc4: 120 \ubc14\uc774\ud2b8\nSHA-256: 0a430879c266f8b57f4092a0f935cf3facd48bbccde5760d4748ca4051716969\n</code></pre> <p><code>\"hello\"</code>\ub97c \ud3ec\ud568\ud55c \ud30c\uc77c\uc5d0 \ub300\ud55c <code>nix hash path</code>\uc758 \ucd9c\ub825\uacfc \uc77c\uce58\ud569\ub2c8\ub2e4.</p>"},{"location":"ko/internals/store-paths/","title":"\uc2a4\ud1a0\uc5b4 \uacbd\ub85c \uacc4\uc0b0","text":"<p>Nix \uc2a4\ud1a0\uc5b4 \uacbd\ub85c\ub294 \ub2e4\uc74c\uacfc \uac19\uc740 \ud615\ud0dc\uc758 \ubb38\uc790\uc5f4\uc785\ub2c8\ub2e4:</p> <pre><code>/nix/store/&lt;hash&gt;-&lt;name&gt;\n</code></pre> <p><code>&lt;hash&gt;</code>\ub294 160\ube44\ud2b8 (20\ubc14\uc774\ud2b8) \ud574\uc2dc\ub97c Nix base32\ub85c \uc778\ucf54\ub529\ud55c \uc815\ud655\ud788 32\uc790\uc785\ub2c8\ub2e4.</p>"},{"location":"ko/internals/store-paths/#_2","title":"\uc54c\uace0\ub9ac\uc998","text":"<pre><code>                              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n  content \u2500\u2500\u2500\u2500 sha256 \u2500\u2500\u2500\u2500\u2500\u2500&gt; \u2502  \ub0b4\ubd80    \u2502\n  (\ub610\ub294 source\uc758 NAR \ud574\uc2dc)     \u2502  \ud574\uc2dc    \u2502\n                              \u2502 (32 B)   \u2502\n                              \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n                                   \u2502\n                                   v\n  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n  \u2502 \ud551\uac70\ud504\ub9b0\ud2b8 \ubb38\uc790\uc5f4:                                    \u2502\n  \u2502 \"&lt;type&gt;:sha256:&lt;hex(inner_hash)&gt;:/nix/store:&lt;name&gt;\"\u2502\n  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          \u2502\n                      sha256\n                          \u2502\n                          v\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502 32 \ubc14\uc774\ud2b8 \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2502\n                  XOR-\ud3f4\ub4dc\ud558\uc5ec 20\ubc14\uc774\ud2b8\ub85c\n                         \u2502\n                         v\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502 20 \ubc14\uc774\ud2b8 \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2502\n                  Nix base32 \uc778\ucf54\ub529\n                         \u2502\n                         v\n      /nix/store/&lt;32\uc790&gt;-&lt;name&gt;\n</code></pre>"},{"location":"ko/internals/store-paths/#_3","title":"\ud0c0\uc785 \ud504\ub9ac\ud53d\uc2a4","text":"<p>\ud551\uac70\ud504\ub9b0\ud2b8\uc758 <code>&lt;type&gt;</code>\uc740 \uc774 \uacbd\ub85c\uac00 \uc5b4\ub5a4 \uc885\ub958\uc758 \uc2a4\ud1a0\uc5b4 \uac1d\uccb4\ub97c \uac00\ub9ac\ud0a4\ub294\uc9c0 \uacb0\uc815\ud569\ub2c8\ub2e4.</p>"},{"location":"ko/internals/store-paths/#text","title":"<code>text</code> \u2014 \ud14d\uc2a4\ud2b8 \ud30c\uc77c","text":"<p><code>builtins.toFile</code>\uacfc <code>pkgs.writeText</code>\uc5d0\uc11c \uc0ac\uc6a9. \ub0b4\ubd80 \ud574\uc2dc\ub294 <code>sha256(content)</code>.</p> <pre><code>text:sha256:&lt;hex&gt;:/nix/store:&lt;name&gt;\n</code></pre> <p>\ucc38\uc870\uac00 \uc788\ub294 \uacbd\uc6b0 (\ud14d\uc2a4\ud2b8 \ud30c\uc77c\uc774 \ub2e4\ub978 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c\uc5d0 \uc758\uc874):</p> <pre><code>text:/nix/store/...-dep1:/nix/store/...-dep2:sha256:&lt;hex&gt;:/nix/store:&lt;name&gt;\n</code></pre> <p>\ucc38\uc870\ub294 \uc815\ub82c\ub418\uc5b4 <code>:</code> \uad6c\ubd84\uc790\ub85c \ucd94\uac00\ub429\ub2c8\ub2e4. \ucc38\uc870\uac00 \uc5c6\uc73c\uba74 \ud0c0\uc785\uc740 \uadf8\ub0e5 <code>text</code>\uc785\ub2c8\ub2e4 \u2014 \ub4a4\uc5d0 \ucf5c\ub860\uc774 \ubd99\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.</p>"},{"location":"ko/internals/store-paths/#source","title":"<code>source</code> \u2014 \uc18c\uc2a4 \uacbd\ub85c","text":"<p><code>builtins.path</code>, <code>builtins.filterSource</code>, \uadf8\ub9ac\uace0 \uacbd\ub85c \uc784\ud3ec\ud2b8(<code>./foo</code>)\uc5d0\uc11c \uc0ac\uc6a9. \ub0b4\ubd80 \ud574\uc2dc\ub294 NAR \uc9c1\ub82c\ud654\uc758 SHA-256\uc785\ub2c8\ub2e4.</p> <pre><code>source:sha256:&lt;hex&gt;:/nix/store:&lt;name&gt;\n</code></pre> <p>\ucc38\uc870\uac00 \uc788\uc744 \uc218\ub3c4 \uc788\uc2b5\ub2c8\ub2e4 (\uc790\uae30 \uc790\uc2e0\uc758 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c\ub97c \ud3ec\ud568\ud558\ub294 \uacbd\ub85c\uc758 \uc790\uae30 \ucc38\uc870):</p> <pre><code>source:/nix/store/...-self:sha256:&lt;hex&gt;:/nix/store:&lt;name&gt;\n</code></pre>"},{"location":"ko/internals/store-paths/#outputname-derivation","title":"<code>output:&lt;name&gt;</code> \u2014 Derivation \ucd9c\ub825","text":"<p>\ube44\uace0\uc815 \ucd9c\ub825 derivation\uc758 \ucd9c\ub825\uc5d0 \uc0ac\uc6a9. \ub0b4\ubd80 \ud574\uc2dc\ub294 <code>hashDerivationModulo</code>\uc5d0\uc11c \uc635\ub2c8\ub2e4.</p> <pre><code>output:out:sha256:&lt;hex&gt;:/nix/store:&lt;name&gt;\n</code></pre> <p>\ub2e4\uc911 \ucd9c\ub825 derivation\uc758 \uacbd\uc6b0:</p> <pre><code>output:lib:sha256:&lt;hex&gt;:/nix/store:&lt;name&gt;\noutput:dev:sha256:&lt;hex&gt;:/nix/store:&lt;name&gt;\n</code></pre>"},{"location":"ko/internals/store-paths/#derivation","title":"\uace0\uc815 \ucd9c\ub825 derivation","text":"<p>\uace0\uc815 \ucd9c\ub825 derivation (<code>fetchurl</code> \ub4f1)\uc740 2\ub2e8\uacc4 \uacfc\uc815\uc744 \uc0ac\uc6a9\ud569\ub2c8\ub2e4:</p> <ol> <li>\uc911\uac04 \ub514\uc2a4\ud06c\ub9bd\ud130 \uacc4\uc0b0: <code>fixed:out:&lt;method&gt;&lt;algo&gt;:&lt;hex&gt;:</code></li> <li>\ub514\uc2a4\ud06c\ub9bd\ud130 \ud574\uc2f1: <code>inner_hash = sha256(descriptor)</code></li> <li><code>output:out</code>\uc744 \ud0c0\uc785\uc73c\ub85c \uc0ac\uc6a9</li> </ol> <p>\uc608\uc678: <code>recursive</code> + <code>sha256</code>\uc740 \uc18c\uc2a4 \uacbd\ub85c\ub85c \uc9c1\uc811 \ucc98\ub9ac\ub429\ub2c8\ub2e4 (<code>make_source_store_path</code>\uc640 \ub3d9\uc77c).</p>"},{"location":"ko/internals/store-paths/#_4","title":"\uc774\ub984 \uc81c\uc57d","text":"<p>\uc2a4\ud1a0\uc5b4 \uac1d\uccb4 \uc774\ub984\uc740:</p> <ul> <li>\ube44\uc5b4\uc788\uc73c\uba74 \uc548 \ub428</li> <li><code>.</code>\uc73c\ub85c \uc2dc\uc791\ud558\uba74 \uc548 \ub428</li> <li>\ub2e4\uc74c \ubb38\uc790\ub9cc \ud3ec\ud568: <code>a-z A-Z 0-9 + - . _ ? =</code></li> <li>211\uc790\ub97c \ucd08\uacfc\ud558\uba74 \uc548 \ub428</li> </ul>"},{"location":"ko/internals/store-paths/#_5","title":"\ud480\uc774 \uc608\uc81c","text":"<p><code>builtins.toFile \"hello.txt\" \"hello\"</code>\uc758 \uc2a4\ud1a0\uc5b4 \uacbd\ub85c \uacc4\uc0b0:</p> <pre><code>from pix.hash import sha256, compress_hash\nfrom pix.base32 import encode\n\ncontent = b\"hello\"\n\n# 1\ub2e8\uacc4: \ub0b4\ubd80 \ud574\uc2dc\ninner = sha256(content)\n# 2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824\n\n# 2\ub2e8\uacc4: \ud551\uac70\ud504\ub9b0\ud2b8\nfp = f\"text:sha256:{inner.hex()}:/nix/store:hello.txt\"\n# text:sha256:2cf24dba...938b9824:/nix/store:hello.txt\n\n# 3\ub2e8\uacc4: \ud551\uac70\ud504\ub9b0\ud2b8 \ud574\uc2f1\nfp_hash = sha256(fp.encode())\n\n# 4\ub2e8\uacc4: \uc555\ucd95\ncompressed = compress_hash(fp_hash, 20)\n\n# 5\ub2e8\uacc4: \uc778\ucf54\ub529\nencoded = encode(compressed)  # 32\uc790\n\n# 6\ub2e8\uacc4: \uc870\ud569\npath = f\"/nix/store/{encoded}-hello.txt\"\n</code></pre>"}]}